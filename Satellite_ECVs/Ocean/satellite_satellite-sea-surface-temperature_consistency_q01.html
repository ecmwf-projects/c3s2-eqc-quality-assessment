
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.6.5. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q01';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6.6. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends" href="satellite_satellite-sea-surface-temperature_consistency_q02.html" />
    <link rel="prev" title="1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale" href="satellite_satellite-sea-level-global_trend-assessment_q01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Atmospheric_Composition/satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.1. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Atmospheric_Composition/satellite_satellite-methane_uncertainty_q01.html">1.2.2. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Atmospheric_Composition/satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.3. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_derived-gridded-glacier-mass-change_data-completeness_q01.html">1.3.1. Glacier mass change data from satellite and in-situ observations: uncertainty analysis for glaciological and climate change monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_consistency-assessment_q02.html">1.3.2. Spatio-temporal data completeness and consistency of remote sensing-derived ice sheet surface elevation changes over Antarctica</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.3. Uncertainty of ice sheet surface elevation change data over Greenland for volume and mass change trend assessments</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Ocean.html">1.6. Ocean</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.2. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.3. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.6.5. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.6. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.3. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2°C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2°C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-climate-variability-using-satellite-derived-sst">🌍 Use case: Monitoring climate variability using satellite-derived SST</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">❓ Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages-and-define-parameters-for-the-requests-to-the-cds">1. Import packages and define parameters for the requests to the CDS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-cache">2. Define functions to cache</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-step">3. Download and transform step</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-annual-maps-bias-seasonal-maps-and-timeseries-with-discussions">4. Plot Annual Maps, Bias, Seasonal Maps and Timeseries, with discussions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-annual-maps">4.1 Plot Annual Maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-bias-maps">4.2 Plot Bias Maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-seasonal-maps">4.3 Plot seasonal maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-global-monthly-mean-time-series-eastern-tropical-pacific-sst-el-nino-3-and-east-central-tropical-pacific-sst-el-nino-3-4">4.4 Plot of global monthly mean time series, Eastern Tropical Pacific SST (El Niño 3), and East Central Tropical Pacific SST (El Niño 3.4)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="consistency-assessment-of-satellite-sea-surface-temperature-for-climate-monitoring">
<h1><span class="section-number">1.6.5. </span>Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring<a class="headerlink" href="#consistency-assessment-of-satellite-sea-surface-temperature-for-climate-monitoring" title="Link to this heading">#</a></h1>
<p>Production date: 16-05-2025</p>
<p>Produced by: CNR-ISMAR</p>
<section id="use-case-monitoring-climate-variability-using-satellite-derived-sst">
<h2>🌍 Use case: Monitoring climate variability using satellite-derived SST<a class="headerlink" href="#use-case-monitoring-climate-variability-using-satellite-derived-sst" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question-s">
<h2>❓ Quality assessment question(s)<a class="headerlink" href="#quality-assessment-question-s" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Do the ESA CCI SST L4 v2.1 and GHRSST Multi-Product Ensemble (GMPE) SST datasets provide consistent representations of SST climatology and its variability?</strong></p></li>
</ul>
<p>We aim here to evaluate the consistency and representativeness of sea surface temperature (SST) climatology and its variability in satellite-based long-term climate data records (CDRs).
To this end, two different SST CDRs have been intercompared on a 30-year long (1982-2011) period.
The full period of common coverage (1982-2016) was used when extracting time series, to have more information on each dataset’s capability to properly represent large scale climatic oscillations, such as the El-Nino Southern Oscillation (ENSO).</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Both datasets provide consistent results, well reproducing SST mean values and the main patterns of SST variability on a variety of scales, ranging from seasonal to (multi-)annual time scales;</p></li>
<li><p>Both datasets can be exploited for climate studies. As an example, El-Niño/La-Niña events are well characterized by both GMPE and ESA CCI SST L4 v2.1 products
;</p></li>
<li><p>ESA CCI SST L4 v2.1 dataset should be used with caution in the first decade of the CDR. Significant discrepancies with respect to the ensemble mean GMPE dataset were indeed observed in the 1982-1992 period;</p></li>
</ul>
</div>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../../_images/bb2e502f-9d8a-4404-8c19-418886e6e483.png"><img alt="../../_images/bb2e502f-9d8a-4404-8c19-418886e6e483.png" src="../../_images/bb2e502f-9d8a-4404-8c19-418886e6e483.png" style="width: 550px; height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.6.5.1 </span><span class="caption-text"><em>Nino 3.4 Time series calculated according to <a class="reference external" href="https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni" rel="noreferrer" target="_blank">[6]</a></em></span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>We intercompare the performances of the European Space Agency Climate Change Initiative (ESA CCI) SST dataset v2.1 and the GHRSST multi product ensemble (GMPE) SST.</p>
<p>Respectively, catalogue entries available from the CDS are the following:</p>
<ul class="simple">
<li><p>Sea surface temperature daily gridded data from 1981 to 2016 derived from a multi-product satellite-based ensemble - from the Group for High Resolution Sea Surface Temperature (GHRSST) multi-product ensemble (GMPE) produced by the European Space Agency SST Climate Change Initiative (ESA CCI SST) (GMPE in the following). The GMPE SST is obtained as the ensemble median of 16 global contributing Level-4 (L4) analyses (including the ESA CCI v2.0 and v1.1) <a class="reference external" href="https://doi.org/10.1016/j.rse.2018.12.015" rel="noreferrer" target="_blank">[1]</a>;</p></li>
<li><p>Sea Surface Temperature daily data from 1981 to present derived from satellite observations, ESA CCI SST L4 dataset v2.1 (ESA CCI SST in the following). This L4 datasets provides daily global SST fields from the merging  of space born Infrared SSTs through a variational assimilation algorithm <a class="reference external" href="https://doi.org/10.1038/s41597-019-0236-x" rel="noreferrer" target="_blank">[2]</a>;</p></li>
</ul>
<p>The methodology employed is suitable for investigating the representation of SST variability over climatological time scales.</p>
<p>-The climatology has been defined over a common, standard 30-year long period 1982-2011.</p>
<p>-Annual and seasonal mean, as well as standard deviation, have been computed over the time axis.</p>
<p>-Time series of globally averaged SST anomalies were derived by subtracting the annual cycle from the product’s monthly mean time series, representing the mean of each month over the entire period (1982-2016).</p>
<p>This processing aims to minimize the impact of the seasonal component, thereby enhancing the contribution of higher and lower frequency components.</p>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:’</p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-surface-temperature-consistency-q01-section-1"><span class="std std-ref">1. Import packages and define parameters for the requests to the CDS</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-surface-temperature-consistency-q01-section-2"><span class="std std-ref">2. Define functions to cache</span></a></strong></p>
<p>Functions for rechunking to optimize caching of intermediate results, get nan values on land and convert to degree celsius in the ocean are defined in this section. Note that chunking is employed to handle more efficiently the large data volume.
Notice that while in GMPE SST sea-ice covered points have nan values, this is not the case in ESA CCI SST, which has an additional variable called “mask”. We use this ancillary information to mask out sea-ice covered regions (the variable mask is valued-1 for ocean only points).</p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-surface-temperature-consistency-q01-section-3"><span class="std std-ref">3. Download and transform step</span></a></strong></p>
<p>Tuples and dictionaries containing infomations such as reduction operations (mean and standard deviation) are defined in this section, and the request is set up, transforming the data while downloading them, according to the proposed diagnostics.</p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-surface-temperature-consistency-q01-section-4"><span class="std std-ref">4. Plot Annual Maps, Bias, Seasonal Maps and Timeseries, with discussions</span></a></strong></p>
<ul class="simple">
<li><p>4.1 Plot Annual Maps</p></li>
<li><p>4.2 Plot Bias maps</p></li>
<li><p>4.3 Plot Seasonal Maps</p></li>
<li><p>4.4 Plot of global monthly mean time series, Eastern Tropical Pacific SST (El Niño 3), and East Central Tropical Pacific SST (El Niño 3.4)</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="import-packages-and-define-parameters-for-the-requests-to-the-cds">
<span id="satellite-satellite-sea-surface-temperature-consistency-q01-section-1"></span><h3>1. Import packages and define parameters for the requests to the CDS<a class="headerlink" href="#import-packages-and-define-parameters-for-the-requests-to-the-cds" title="Link to this heading">#</a></h3>
<p>In the following cell the necessary packages are imported, defining the request to the CDS to download ESA CCI and GMPE SST from 1982 to 2011. Regions to calculate nino3 and nino3.4, and global timeseries are defined.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>

<span class="c1"># Time</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">1982</span>
<span class="n">year_stop_map</span> <span class="o">=</span> <span class="mi">2011</span>
<span class="n">year_stop_timeseries</span> <span class="o">=</span> <span class="mi">2016</span> 

<span class="c1"># Regions</span>
<span class="n">regions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;nino3.4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">170</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)},</span>
    <span class="s2">&quot;nino3&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)},</span>
    <span class="s2">&quot;global&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)},</span>
<span class="p">}</span>

<span class="c1"># Requests</span>
<span class="n">request_dicts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ESACCI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="s2">&quot;satellite-sea-surface-temperature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;request&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;processinglevel&quot;</span><span class="p">:</span> <span class="s2">&quot;level_4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensor_on_satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;combined_product&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2_1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;GMPE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="s2">&quot;satellite-sea-surface-temperature-ensemble-product&quot;</span><span class="p">,</span>
        <span class="s2">&quot;request&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>  <span class="c1"># CDS limit is 12</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="c1"># Parameters to speed up I/O. For more information, see https://docs.xarray.dev/en/stable/generated/xarray.open_mfdataset.html</span>
<span class="n">open_mfdataset_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;concat_dim&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="c1">#Concatenation of multiple files along the temporal dimension</span>
    <span class="s2">&quot;combine&quot;</span><span class="p">:</span> <span class="s2">&quot;nested&quot;</span><span class="p">,</span> <span class="c1">#the argument &quot;nested&quot; assures to have no conflicts when one variable exist only in one dataset</span>
    <span class="s2">&quot;data_vars&quot;</span><span class="p">:</span> <span class="s2">&quot;minimal&quot;</span><span class="p">,</span> <span class="c1">#if multiple files of the same dataset contain a different number of variables, keep only the ones common to all files.</span>
    <span class="s2">&quot;coords&quot;</span><span class="p">:</span> <span class="s2">&quot;minimal&quot;</span><span class="p">,</span> <span class="c1">#same as above for coordinates</span>
    <span class="s2">&quot;compat&quot;</span><span class="p">:</span> <span class="s2">&quot;override&quot;</span><span class="p">,</span> <span class="c1">#String indicating how to compare variables of the same name for potential conflicts when merging. “override”: skip comparing and pick variable from first dataset</span>
    <span class="s2">&quot;parallel&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="c1">#Parallel opening and processing of the multiple-file dataset, to speed up.</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-functions-to-cache">
<span id="satellite-satellite-sea-surface-temperature-consistency-q01-section-2"></span><h3>2. Define functions to cache<a class="headerlink" href="#define-functions-to-cache" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_masked_sst</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;analysed_sst&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;mask&quot;</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;mask&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">-=</span> <span class="mf">273.15</span>
    <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;°C&quot;</span>
    <span class="k">return</span> <span class="n">da</span>


<span class="k">def</span><span class="w"> </span><span class="nf">add_chunksizes</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="n">da</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;chunksizes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">max</span><span class="p">,</span> <span class="n">da</span><span class="o">.</span><span class="n">chunks</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">da</span>


<span class="k">def</span><span class="w"> </span><span class="nf">rechunk</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Use NetCDF chunks.&quot;&quot;&quot;</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="mi">1_200</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="mi">2_400</span><span class="p">}</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span><span class="n">dim</span><span class="p">:</span> <span class="n">chunksize</span> <span class="k">for</span> <span class="n">dim</span><span class="p">,</span> <span class="n">chunksize</span> <span class="ow">in</span> <span class="n">chunks</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">dims</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">add_chunksizes</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">add_chunksizes</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_time_reductions</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">get_masked_sst</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">da_reduced</span> <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">if</span> <span class="s2">&quot;season&quot;</span> <span class="ow">in</span> <span class="n">da_reduced</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="n">da_reduced</span> <span class="o">=</span> <span class="n">da_reduced</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">da_reduced</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_spatial_weighted_reductions</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">get_masked_sst</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">grouped</span><span class="p">,</span> <span class="n">reduction</span><span class="p">)</span>
    <span class="n">da_reduced_doy</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">da_reduced</span> <span class="o">=</span> <span class="p">(</span><span class="n">grouped</span> <span class="o">-</span> <span class="n">da_reduced_doy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">da_reduced</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform-step">
<span id="satellite-satellite-sea-surface-temperature-consistency-q01-section-3"></span><h3>3. Download and transform step<a class="headerlink" href="#download-and-transform-step" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings</span>
<span class="n">reductions</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">)</span>
<span class="n">season_month_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;DJF&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">},</span>
    <span class="s2">&quot;MAM&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;03&quot;</span><span class="p">,</span> <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">},</span>
    <span class="s2">&quot;JJA&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;06&quot;</span><span class="p">,</span> <span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">},</span>
    <span class="s2">&quot;SON&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;09&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">start</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_start</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">-12&quot;</span>
<span class="n">stop</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_stop_map</span><span class="si">}</span><span class="s2">-11&quot;</span>

<span class="c1"># Initialize variables</span>
<span class="n">datasets_annual</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">datasets_seasonal</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">timeseries_ds_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">request_dict</span> <span class="ow">in</span> <span class="n">request_dicts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="n">request_dict</span><span class="p">[</span><span class="s2">&quot;collection_id&quot;</span><span class="p">],</span>
        <span class="s2">&quot;transform_chunks&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="n">request_dict</span><span class="p">[</span><span class="s2">&quot;chunks&quot;</span><span class="p">],</span>
        <span class="o">**</span><span class="n">open_mfdataset_kwargs</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Annual</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">annual_ds_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop_map</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;annual&quot;</span><span class="p">):</span>
        <span class="c1"># Note: year from December year-1 to November year</span>
        <span class="n">annual_requests</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
            <span class="n">request_dict</span><span class="p">[</span><span class="s2">&quot;request&quot;</span><span class="p">],</span>
            <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
            <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-11&quot;</span><span class="p">,</span>
            <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">tmp_ds_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">reduction</span> <span class="ow">in</span> <span class="n">reductions</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">diagnostics</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;time_weighted_</span><span class="si">{</span><span class="n">reduction</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="n">requests</span><span class="o">=</span><span class="n">annual_requests</span><span class="p">,</span>
                <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_time_reductions</span><span class="p">,</span>
                <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">func</span><span class="p">,</span> <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;skipna&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
            <span class="p">)</span>
            <span class="n">tmp_ds_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rechunk</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="p">[</span><span class="n">reduction</span><span class="p">]))</span>
        <span class="n">annual_ds_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">tmp_ds_list</span><span class="p">,</span> <span class="s2">&quot;reduction&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="p">[</span><span class="n">year</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="n">datasets_annual</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">annual_ds_list</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">)</span>

    <span class="c1"># Seasonal and spatial</span>
    <span class="n">requests</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="n">request_dict</span><span class="p">[</span><span class="s2">&quot;request&quot;</span><span class="p">],</span>
        <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_stop_map</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
        <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="n">requests_ts</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="n">request_dict</span><span class="p">[</span><span class="s2">&quot;request&quot;</span><span class="p">],</span>
        <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_stop_timeseries</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
        <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span> 
    <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">slices</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">regions</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;spatial reduction&quot;</span><span class="p">):</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="n">requests</span><span class="o">=</span><span class="n">requests_ts</span><span class="p">,</span>
                <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_spatial_weighted_reductions</span><span class="p">,</span>
                <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;reduction&quot;</span><span class="p">:</span> <span class="n">reduction</span><span class="p">}</span> <span class="o">|</span> <span class="n">slices</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timeseries_ds_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
                    <span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="n">product</span><span class="p">],</span> <span class="n">reduction</span><span class="o">=</span><span class="p">[</span><span class="n">reduction</span><span class="p">],</span> <span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>
        
    <span class="n">seasonal_ds_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reduction</span> <span class="ow">in</span> <span class="n">reductions</span><span class="p">:</span>
        <span class="c1"># Seasonal</span>
        <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">diagnostics</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;seasonal_weighted_</span><span class="si">{</span><span class="n">reduction</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">tmp_ds_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">season</span><span class="p">,</span> <span class="n">months</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">season_month_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">):</span>
            <span class="n">season_requests</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;month&quot;</span>
                    <span class="k">else</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">({</span><span class="n">v</span><span class="p">}</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">months</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">requests</span>
            <span class="p">]</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="n">requests</span><span class="o">=</span><span class="n">season_requests</span><span class="p">,</span>
                <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_time_reductions</span><span class="p">,</span>
                <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="n">func</span><span class="p">,</span> <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;skipna&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
            <span class="p">)</span>
            <span class="n">tmp_ds_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rechunk</span><span class="p">(</span><span class="n">ds</span><span class="p">))</span>
        <span class="n">seasonal_ds_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">tmp_ds_list</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="p">[</span><span class="n">reduction</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="n">datasets_seasonal</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">seasonal_ds_list</span><span class="p">,</span> <span class="s2">&quot;reduction&quot;</span><span class="p">)</span>

<span class="n">ds_timeseries</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">timeseries_ds_list</span><span class="p">)</span>
<span class="k">del</span> <span class="n">tmp_ds_list</span><span class="p">,</span> <span class="n">annual_ds_list</span><span class="p">,</span> <span class="n">seasonal_ds_list</span><span class="p">,</span> <span class="n">timeseries_ds_list</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>product=&#39;ESACCI&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>annual: 100%|██████████| 30/30 [00:13&lt;00:00,  2.17it/s]
spatial reduction: 100%|██████████| 3/3 [00:00&lt;00:00,  5.23it/s]
season: 100%|██████████| 4/4 [00:00&lt;00:00, 27.77it/s]
season: 100%|██████████| 4/4 [00:00&lt;00:00, 12.79it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>product=&#39;GMPE&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>annual: 100%|██████████| 30/30 [00:14&lt;00:00,  2.07it/s]
spatial reduction: 100%|██████████| 3/3 [00:00&lt;00:00,  4.14it/s]
season: 100%|██████████| 4/4 [00:00&lt;00:00,  6.46it/s]
season: 100%|██████████| 4/4 [00:01&lt;00:00,  3.41it/s]
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-annual-maps-bias-seasonal-maps-and-timeseries-with-discussions">
<span id="satellite-satellite-sea-surface-temperature-consistency-q01-section-4"></span><h3>4. Plot Annual Maps, Bias, Seasonal Maps and Timeseries, with discussions<a class="headerlink" href="#plot-annual-maps-bias-seasonal-maps-and-timeseries-with-discussions" title="Link to this heading">#</a></h3>
<p>In the following cells results of the diagnostics are shown and discussed.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets_annual</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;ESACCI&quot;</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="n">product</span><span class="p">]))</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">)</span>



<span class="n">ds_annual_low_res</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">reduction</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ds_annual_low_res</span><span class="p">,</span> <span class="n">reduction</span><span class="p">)(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="p">[</span><span class="n">reduction</span><span class="p">]))</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;reduction&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="plot-annual-maps">
<h4>4.1 Plot Annual Maps<a class="headerlink" href="#plot-annual-maps" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;analysed_sst&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;reduction&quot;</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SST </span><span class="si">{</span><span class="n">reduction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop_map</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(),</span> <span class="s2">&quot;cbar_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&quot;SST </span><span class="si">{</span><span class="n">reduction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">}}</span>

    <span class="c1"># Reduction</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">da</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Spectral_r&quot;</span> <span class="k">if</span> <span class="n">reduction</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span> <span class="k">else</span> <span class="s2">&quot;RdBu_r&quot;</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">levels</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span> <span class="k">if</span> <span class="n">reduction</span><span class="o">==</span><span class="s2">&quot;std&quot;</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mf">1.5</span> <span class="k">if</span> <span class="n">reduction</span><span class="o">==</span><span class="s2">&quot;std&quot;</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span>
        <span class="c1">#row=&#39;year&#39;,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/fef43ad7827a83312b0ac638a5c805d55af16decc20bc67d610a8fd23f33e674.png" src="../../_images/fef43ad7827a83312b0ac638a5c805d55af16decc20bc67d610a8fd23f33e674.png" />
<img alt="../../_images/221886c84be7c1df32b683ea21ed66cc62f5be89338fee6f94bd7b71be423585.png" src="../../_images/221886c84be7c1df32b683ea21ed66cc62f5be89338fee6f94bd7b71be423585.png" />
</div>
</div>
<p>The global distribution of the mean SST during the complete 30 years from 1982 to 2011 is shown in the top panel. The climatology correctly reveals the dominant latitudinal spatial SST pattern: higher at the tropics, milder at middle latitudes and lower in the polar regions (see, e.g., <a class="reference external" href="https://doi.org/10.1146/annurev-marine-120408-151453" rel="noreferrer" target="_blank">[3]</a>). The globally averaged SST value is estimated in 20.11 <span class="math notranslate nohighlight">\(\pm\)</span> 0.39 °C in ESA CCI and  20.23 <span class="math notranslate nohighlight">\(\pm\)</span> 0.37 °C in GMPE.
The standard deviation map of annual mean SST is shown in the bottom panel. The annual average removes the seasonal variability and better quantifies the magnitude and spatial distribution of the nonseasonal SST variability. The standard deviation map evidences some patterns of the main current systems such as the Gulf Current and the Kuroshio Current, as well as regions such El-Nino in the tropical pacific, where the SST anomaly standard deviation exceeds 1.5°C. The main upwelling systems as, e.g., Perù-Chili, Benguela, NW-African coast and along the southern Saudi Arabia coast are also evident, as well as regions of strong mixing, like the Antarctic Circumpolar Current and the Agulhas Leakage.</p>
</section>
<section id="plot-bias-maps">
<h4>4.2 Plot Bias Maps<a class="headerlink" href="#plot-bias-maps" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;analysed_sst&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;reduction&quot;</span><span class="p">):</span>
    <span class="c1"># Bias</span>
    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">bias</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;product&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">latitude</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">longitude</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(),</span> <span class="s2">&quot;cbar_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">reduction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> SST difference [</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">}}</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">bias</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;PRGn&quot;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">.3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">.3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">reduction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> SST difference (</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop_map</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/b5c4cee2826cc1e891573a4e98be0d980a6b436c68bfef5d189bec4cfc7d9a00.png" src="../../_images/b5c4cee2826cc1e891573a4e98be0d980a6b436c68bfef5d189bec4cfc7d9a00.png" />
<img alt="../../_images/0caa03f9efeaaf74415f6cd26acab8730c8cd27bcabbd01691cbc56f280cdc50.png" src="../../_images/0caa03f9efeaaf74415f6cd26acab8730c8cd27bcabbd01691cbc56f280cdc50.png" />
</div>
</div>
<p>Top panel depicts the difference between climatologies in GMPE and ESA CCI SSTs. In general, positive (negative) values stand for GMPE (ESA CCI) being warmer than ESA CCI (GMPE) SSTs. The maximum mean difference is about +1.7°C, especially over the Tropical Eastern Atlantic, Northern Indian Ocean, Western South American and South African coasts. The Gulf Stream presents positive and negative mean SST differences, while the Kuroshio current is mainly characterized by higher GMPE SSTs. On average, GMPE is about 0.02°C warmer than ESA CCI SST. Regarding the standard deviation (bottom panel), SST annual variability is slightly higher in ESA CCI than in GMPE over the tropical Pacific, the North Atlantic, the southern Saudi Arabia coast, and in the Agulhas system. The converse holds true in the Gulf Stream, Antarctic Circumpolar Current, and Indonesian Throughflow, resulting in GMPE having a variance close to 0.2°C greater than the one in ESA CCI. Overall, these results are consistent with the literature (see e.g. <a class="reference external" href="https://doi.org/10.1175/JCLI-D-20-0793.1" rel="noreferrer" target="_blank">[4]</a>, <a class="reference external" href="https://doi.org/10.1080/1755876X.2016.1273446" rel="noreferrer" target="_blank">[5]</a>).</p>
<p>It is important to notice that some of the major discrepancies in the mean difference map (e.g. around the African continent and in the Northern Indian Ocean), are likely due to known issues of the ESA CCI dataset, as reported in <a class="reference external" href="https://doi.org/10.1038/s41597-019-0236-x" rel="noreferrer" target="_blank">[2]</a>, being attributed to unscreened dust events in the Advanced Very High Resolution Radiometer (AVHRR) SSTs. This bias is strongly mitigated by GMPE SST, which is the median of an ensemble of satellite SST products.</p>
</section>
<section id="plot-seasonal-maps">
<h4>4.3 Plot seasonal maps<a class="headerlink" href="#plot-seasonal-maps" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets_seasonal</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;ESACCI&quot;</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="n">product</span><span class="p">]))</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;analysed_sst&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;reduction&quot;</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SST Seasonal </span><span class="si">{</span><span class="n">reduction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop_map</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(),</span> <span class="s2">&quot;cbar_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;orientation&#39;</span><span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&quot;SST seasonal </span><span class="si">{</span><span class="n">reduction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">}}</span>

    <span class="c1"># Reduction</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">da</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Spectral_r&quot;</span> <span class="k">if</span> <span class="n">reduction</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span> <span class="k">else</span> <span class="s2">&quot;RdBu_r&quot;</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">levels</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">reduction</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span> <span class="k">else</span> <span class="mf">0.</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">reduction</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span> <span class="k">else</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span>
        <span class="n">row</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/3c8b72faef4aa1957a384131b11668dc2b3bb9d54bfe836d48f8857e5e5bffaa.png" src="../../_images/3c8b72faef4aa1957a384131b11668dc2b3bb9d54bfe836d48f8857e5e5bffaa.png" />
<img alt="../../_images/84e8a1ce437fdeb888ed0c3b8c6102dff8e7f2126b728ea232af655a3cfa67bb.png" src="../../_images/84e8a1ce437fdeb888ed0c3b8c6102dff8e7f2126b728ea232af655a3cfa67bb.png" />
</div>
</div>
<p>Seasonal SST climatologies show similar patterns among the two datasets, with a warmer (cooler) Northern Hemisphere during boreal summer (winter), as expected; the converse holds true for the Southern Hemisphere. It can be noticed the strong influence of major western boundary currents, such as the Gulf Stream and the Kuroshio in determining seasonal oscillations. Overall, from this pictures the two dataset are found in good agreement.</p>
<p>Right after, seasonal standard deviation maps for each product are shown. For example, the DJF map is expressed by the following formula
<span class="math notranslate nohighlight">\(\sqrt{\frac{1}{N}\sum_{i=1}^{N}\left(SST^i_{DJF} - \langle SST_{DJF}\rangle\right)^2},\)</span> where <span class="math notranslate nohighlight">\(N\)</span> is the number of observations (i.e. 30 winter seasons in the present case) and <span class="math notranslate nohighlight">\(\langle SST_{DJF} \rangle\)</span> is the average wintertime map.<br />
Seasonal standard deviation maps are very similar between the two products, revealing that on average the Northern Hemisphere have a much higher variability than the Southern one, with the Gulf Stream and Kuroshio dominating the patterns year round. Also, signs of high variability are noticeable in both dataset in El-Niño Region and around the Agulhas. While the first region is a reflection of a dominant climate mode, the second one arises as a result of strong mixing and turbulence.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;analysed_sst&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;reduction&quot;</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">reduction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> SST Seasonal difference (</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop_map</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(),</span> <span class="s2">&quot;cbar_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&quot;SST seasonal </span><span class="si">{</span><span class="n">reduction</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">}}</span>

    <span class="c1"># Reduction</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">da</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;product&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">latitude</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">longitude</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;PRGn&quot;</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">levels</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=-</span><span class="mf">.5</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">,</span>
        <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/6f4078deb432050616f287dcc5f68a2b3ddcc71dd614a6a8040e65f86e58e4fa.png" src="../../_images/6f4078deb432050616f287dcc5f68a2b3ddcc71dd614a6a8040e65f86e58e4fa.png" />
<img alt="../../_images/036002f622732a5feda0f0ca8ad0859b7442013438169fa4c0b4e4aa6e975cb2.png" src="../../_images/036002f622732a5feda0f0ca8ad0859b7442013438169fa4c0b4e4aa6e975cb2.png" />
</div>
</div>
<p>We also plot difference maps to highlight discrepancies in the two datasets. We can clearly notice that major differences are located within the tropical belt, mainly near Africa and in the Northern Indian Ocean. As stated above, these discrepancies can be partly attributed to unresolved dust events in ESA CCI SST.</p>
</section>
<section id="plot-of-global-monthly-mean-time-series-eastern-tropical-pacific-sst-el-nino-3-and-east-central-tropical-pacific-sst-el-nino-3-4">
<h4>4.4 Plot of global monthly mean time series, Eastern Tropical Pacific SST (El Niño 3), and East Central Tropical Pacific SST (El Niño 3.4)<a class="headerlink" href="#plot-of-global-monthly-mean-time-series-eastern-tropical-pacific-sst-el-nino-3-and-east-central-tropical-pacific-sst-el-nino-3-4" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">reg1_latmax</span><span class="p">,</span> <span class="n">reg1_latmin</span><span class="p">,</span> <span class="n">reg1_lonmax</span><span class="p">,</span> <span class="n">reg1_lonmin</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span>
<span class="n">reg2_latmax</span><span class="p">,</span> <span class="n">reg2_latmin</span><span class="p">,</span> <span class="n">reg2_lonmax</span><span class="p">,</span> <span class="n">reg2_lonmin</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span>
<span class="n">reg3_latmax</span><span class="p">,</span> <span class="n">reg3_latmin</span><span class="p">,</span> <span class="n">reg3_lonmax</span><span class="p">,</span> <span class="n">reg3_lonmin</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">170</span>
<span class="n">left1</span><span class="p">,</span> <span class="n">bottom1</span><span class="p">,</span> <span class="n">width1</span><span class="p">,</span> <span class="n">height1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span>
<span class="n">left2</span><span class="p">,</span> <span class="n">bottom2</span><span class="p">,</span> <span class="n">width2</span><span class="p">,</span> <span class="n">height2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span>
<span class="n">left3</span><span class="p">,</span> <span class="n">bottom3</span><span class="p">,</span> <span class="n">width3</span><span class="p">,</span> <span class="n">height3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
<span class="n">reg_extremes</span> <span class="o">=</span> <span class="p">[[</span><span class="n">reg1_latmax</span><span class="p">,</span> <span class="n">reg1_latmin</span><span class="p">,</span> <span class="n">reg1_lonmax</span><span class="p">,</span> <span class="n">reg1_lonmin</span><span class="p">],</span> <span class="p">[</span><span class="n">reg2_latmax</span><span class="p">,</span> <span class="n">reg2_latmin</span><span class="p">,</span> <span class="n">reg2_lonmax</span><span class="p">,</span> <span class="n">reg2_lonmin</span><span class="p">],</span> <span class="p">[</span><span class="n">reg3_latmax</span><span class="p">,</span> <span class="n">reg3_latmin</span><span class="p">,</span> <span class="n">reg3_lonmax</span><span class="p">,</span> <span class="n">reg3_lonmin</span><span class="p">]]</span>
<span class="n">locations</span> <span class="o">=</span> <span class="p">[[</span><span class="n">left1</span><span class="p">,</span> <span class="n">bottom1</span><span class="p">,</span> <span class="n">width1</span><span class="p">,</span> <span class="n">height1</span><span class="p">],[</span><span class="n">left2</span><span class="p">,</span> <span class="n">bottom2</span><span class="p">,</span> <span class="n">width2</span><span class="p">,</span> <span class="n">height2</span><span class="p">],</span> <span class="p">[</span><span class="n">left3</span><span class="p">,</span> <span class="n">bottom3</span><span class="p">,</span> <span class="n">width3</span><span class="p">,</span> <span class="n">height3</span><span class="p">]]</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">da_region</span> <span class="ow">in</span> <span class="n">ds_timeseries</span><span class="p">[</span><span class="s2">&quot;analysed_sst&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">):</span>
    <span class="n">reg_latmax</span><span class="p">,</span> <span class="n">reg_latmin</span><span class="p">,</span> <span class="n">reg_lonmax</span><span class="p">,</span> <span class="n">reg_lonmin</span> <span class="o">=</span> <span class="n">reg_extremes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">mute_map</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;analysed_sst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">reg_latmin</span><span class="p">,</span> <span class="n">reg_latmax</span><span class="p">),</span> <span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">reg_lonmin</span><span class="p">,</span> <span class="n">reg_lonmax</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>
    <span class="n">reg_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mute_map</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">locations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time [months]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;SST Anomaly [°C]&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">da_product</span> <span class="ow">in</span> <span class="n">da_region</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;product&quot;</span><span class="p">):</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">da_product</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">mean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">product</span><span class="o">+</span><span class="s1">&#39;-3m_runn&#39;</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Mollweide</span><span class="p">())</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">reg_mask</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop_timeseries</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/817641e01a32c68fcc725266d34aef5934613d4977a6cbed8ed505a3edee3ed3.png" src="../../_images/817641e01a32c68fcc725266d34aef5934613d4977a6cbed8ed505a3edee3ed3.png" />
<img alt="../../_images/b0add9a8ac2c9b83ca5eb06f4dc93e1f8aed6030cd7e150defb5de380622704b.png" src="../../_images/b0add9a8ac2c9b83ca5eb06f4dc93e1f8aed6030cd7e150defb5de380622704b.png" />
<img alt="../../_images/75492cdac9416ba4b60e0300be51b07e42371c24dea06eb023900d6c10d7c1a3.png" src="../../_images/75492cdac9416ba4b60e0300be51b07e42371c24dea06eb023900d6c10d7c1a3.png" />
</div>
</div>
<p>The time series illustrating the globally averaged monthly mean SST anomalies from 1982 to 2016 is presented. These anomalies were derived by subtracting the annual cycle from the product’s monthly mean time series, representing the mean of each month over the entire period (1982-2016). This processing aims to minimize the impact of the seasonal component, thereby enhancing the contribution of higher and lower frequency components. Notably, variations at an interannual time scale are prominently displayed. These changes are mostly related to strong signatures of El Niño Southern Oscillation (ENSO) variability, with a particular strong and sharp increase (warming) in SST during e.g. the 1982/3, 1987/88, 1991/92, 1994/95, 1997/8 and 2009/10 El Niño events, and negative (cooling) peaks during the 1983/5, 1988/9, 1995/6 and 2006/7 La Niña events. Differences between the two time series which exceed 0.5 degrees characterize the first decade of the period, before 1990. The large and sharp peak in 1982/3 reveals apparently erroneous SSTs, as also evidenced in the SST CCI Climate Assessment Report (CAR, available at <a class="reference external" href="https://climate.esa.int/media/documents/SST_CCI_D5.1_CAR_v1.1-signed.pdf" rel="noreferrer" target="_blank">https://climate.esa.int/media/documents/SST_CCI_D5.1_CAR_v1.1-signed.pdf</a>).
The time series of SST anomalies within the El Niño 3.4 and El Niño 3 regions are also shown (see also <a class="reference external" href="https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni" rel="noreferrer" target="_blank">[6]</a> for a definition of El Niño Southern Oscillation indices). These time series are used as indexes to monitor the occurrence and variability of El Niño and la Niña events. The El Niño 3.4 index is defined as the average equatorial SST anomalies across the Pacific in the region 5°S-5°N, 170W°-120W°, while El Niño 3 between 150°W-90°W. Peaks corresponding to El-Niño/La-Niña events are well represented by both GMPE and ESA CCI SST products. See <a class="reference external" href="https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni" rel="noreferrer" target="_blank">[6]</a> for reference.
For both the global mean timeseries and El Niño indexes, there are discrepancies in ESA CCI compared to GMPE SST (GMPE is here used as intercomparison benchmark due to its high accuracy, following <a class="reference external" href="https://doi.org/10.1016/j.rse.2018.12.015" rel="noreferrer" target="_blank">[1]</a>, <a class="reference external" href="https://doi.org/10.1016/j.dsr2.2012.04.013" rel="noreferrer" target="_blank">[7]</a>),  in the period 1982 to 1992. Such discrepancies are highly attenuated from 1992 onwards, suggesting that ESA CCI data should be used with caution in the first decade of the CDR.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>SST CCI Climate Assessment Report (CAR): <a class="reference external" href="https://climate.esa.int/media/documents/SST_CCI_D5.1_CAR_v1.1-signed.pdf" rel="noreferrer" target="_blank">https://climate.esa.int/media/documents/SST_CCI_D5.1_CAR_v1.1-signed.pdf</a></p>
<p>GHRSST Website: <a class="reference external" href="https://www.ghrsst.org/" rel="noreferrer" target="_blank">https://www.ghrsst.org/</a></p>
<p>Additional sources for SST ensemble intercomparison statistics: <a class="reference external" href="https://ghrsst-pp.metoffice.gov.uk/ostia-website/gmpe-monitoring.html" rel="noreferrer" target="_blank">https://ghrsst-pp.metoffice.gov.uk/ostia-website/gmpe-monitoring.html</a></p>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
<li><p>python packages: matplotlib, xarray, cartopy, numpy, tqdm</p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1016/j.rse.2018.12.015" rel="noreferrer" target="_blank">[1]</a> Fiedler, E. K., McLaren, A., Banzon, V., Brasnett, B., Ishizaki, S., Kennedy, J., … &amp; Donlon, C. (2019). Intercomparison of long-term sea surface temperature analyses using the GHRSST Multi-Product Ensemble (GMPE) system. Remote sensing of environment, 222, 18-33</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41597-019-0236-x" rel="noreferrer" target="_blank">[2]</a> Merchant, C. J., Embury, O., Bulgin, C. E., Block, T., Corlett, G. K., Fiedler, E., … &amp; Donlon, C. (2019). Satellite-based time-series of sea-surface temperature since 1981 for climate applications. Scientific data, 6(1), 223. <a class="reference external" href="https://doi.org/10.1038/s41597-019-0236-x" rel="noreferrer" target="_blank">https://doi.org/10.1038/s41597-019-0236-x</a></p>
<p><a class="reference external" href="https://doi.org/10.1146/annurev-marine-120408-151453" rel="noreferrer" target="_blank">[3]</a> Deser, C., Alexander, M. A., Xie, S. P., &amp; Phillips, A. S. (2010). Sea surface temperature variability: Patterns and mechanisms. Annual review of marine science, 2, 115-143.</p>
<p><a class="reference external" href="https://doi.org/10.1175/JCLI-D-20-0793.1" rel="noreferrer" target="_blank">[4]</a> Yang, C., Leonelli, F. E., Marullo, S., Artale, V., Beggs, H., Nardelli, B. B., … &amp; Pisano, A. (2021). Sea surface temperature intercomparison in the framework of the Copernicus Climate Change Service (C3S). Journal of Climate, 34(13), 5257-5283</p>
<p><a class="reference external" href="https://doi.org/10.1080/1755876X.2016.1273446" rel="noreferrer" target="_blank">[5]</a> Von Schuckmann et al. (2016). The Copernicus Marine Environment Monitoring Service Ocean State Report. Jour. Operational Ocean., vol. 9, 2016, suppl. 2. doi: <a class="reference external" href="https://doi.org/10.1080/1755876X.2016.1273446" rel="noreferrer" target="_blank">https://doi.org/10.1080/1755876X.2016.1273446</a></p>
<p><a class="reference external" href="https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni" rel="noreferrer" target="_blank">[6]</a> Trenberth, Kevin &amp; National Center for Atmospheric Research Staff (Eds). Last modified 21 Jan 2020. “The Climate Data Guide: Nino SST Indices (Nino 1+2, 3, 3.4, 4; ONI and TNI).” Retrieved from <a class="reference external" href="https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni" rel="noreferrer" target="_blank">https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni</a></p>
<p><a class="reference external" href="https://doi.org/10.1016/j.dsr2.2012.04.013" rel="noreferrer" target="_blank">[7]</a> Martin, M., Dash, P., Ignatov, A., Banzon, V., Beggs, H., Brasnett, B., … &amp; Roberts-Jones, J. (2012). Group for High Resolution Sea Surface temperature (GHRSST) analysis fields inter-comparisons. Part 1: A GHRSST multi-product ensemble (GMPE). Deep Sea Research Part II: Topical Studies in Oceanography, 77, 21-30</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Ocean"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="satellite_satellite-sea-level-global_trend-assessment_q01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.6.4. </span>Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</p>
      </div>
    </a>
    <a class="right-next"
       href="satellite_satellite-sea-surface-temperature_consistency_q02.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.6.6. </span>Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-climate-variability-using-satellite-derived-sst">🌍 Use case: Monitoring climate variability using satellite-derived SST</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">❓ Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages-and-define-parameters-for-the-requests-to-the-cds">1. Import packages and define parameters for the requests to the CDS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-cache">2. Define functions to cache</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-step">3. Download and transform step</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-annual-maps-bias-seasonal-maps-and-timeseries-with-discussions">4. Plot Annual Maps, Bias, Seasonal Maps and Timeseries, with discussions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-annual-maps">4.1 Plot Annual Maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-bias-maps">4.2 Plot Bias Maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-seasonal-maps">4.3 Plot seasonal maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-global-monthly-mean-time-series-eastern-tropical-pacific-sst-el-nino-3-and-east-central-tropical-pacific-sst-el-nino-3-4">4.4 Plot of global monthly mean time series, Eastern Tropical Pacific SST (El Niño 3), and East Central Tropical Pacific SST (El Niño 3.4)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>