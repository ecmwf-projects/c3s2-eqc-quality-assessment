
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.6.2. Intercomparison of satellite multi-year sea ice extent estimates &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6.3. Suitability of satellite sea ice thickness data for studying climate change" href="satellite_satellite-sea-ice-thickness_trend-assessment_q01.html" />
    <link rel="prev" title="1.6.1. Impact of using successive satellites on Ocean Colour time series" href="satellite_satellite-ocean-colour_consistency-assessment_q01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Atmospheric_Composition/satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.1. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Atmospheric_Composition/satellite_satellite-methane_uncertainty_q01.html">1.2.2. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Atmospheric_Composition/satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.3. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.1. Uncertainty of ice sheet surface elevation change data over Greenland for volume and mass change trend assessments</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Ocean.html">1.6. Ocean</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.6.2. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.3. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.5. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.6. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.3. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2°C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2°C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Intercomparison of satellite multi-year sea ice extent estimates</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-long-term-evolution-of-sea-ice-type">🌍 Use case: Monitoring long-term evolution of sea ice type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">1. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set Parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests">1.3 Define requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-load-and-classify-nersc-data">1.4 Functions to load and classify NERSC data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-produce-time-series">1.5 Functions to produce time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-post-process-and-plot-time-series">1.6 Functions to post-process and plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-produce-climatologies">1.7 Functions to produce climatologies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-plot-climatologies">1.8 Functions to plot climatologies</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-data">2. Download and transform data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-evolution-of-the-total-area-covered-by-multi-year-sea-ice-in-the-arctic-basin">3.1 Temporal evolution of the total area covered by multi-year sea ice in the Arctic Basin</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-and-temporal-evolution-of-the-region-covered-by-multi-year-sea-ice-in-the-arctic">3.2 Spatial and temporal evolution of the region covered by multi-year sea ice in the Arctic</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maps-of-multi-year-sea-ice-from-nersc-dataset">Maps of multi-year sea ice from NERSC dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maps-of-multi-year-sea-ice-from-cds-and-cds-nersc">Maps of multi-year sea ice from CDS and “CDS - NERSC”</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="intercomparison-of-satellite-multi-year-sea-ice-extent-estimates">
<h1><span class="section-number">1.6.2. </span>Intercomparison of satellite multi-year sea ice extent estimates<a class="headerlink" href="#intercomparison-of-satellite-multi-year-sea-ice-extent-estimates" title="Link to this heading">#</a></h1>
<p>Production date: 19-05-2025</p>
<p>Produced by: Nansen Environmental and Remote Sensing Center (NERSC)</p>
<section id="use-case-monitoring-long-term-evolution-of-sea-ice-type">
<h2>🌍 Use case: Monitoring long-term evolution of sea ice type<a class="headerlink" href="#use-case-monitoring-long-term-evolution-of-sea-ice-type" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>How consistent is the evolution of multi-year sea-ice extent in the Arctic across different satellite sea-ice products?</strong></p></li>
</ul>
<p>This study examines the geographical distribution of multi-year sea ice (MYI) in the Arctic, providing an analysis of its evolution since the early 1990s. The assessment focuses on multi-year sea ice, which is sea ice that has survived at least one melting season, because its extent in the Arctic has significantly declined over the last few decades (e.g., <a class="reference external" href="https://doi.org/full/10.1029/2011GL047735" rel="noreferrer" target="_blank">[1]</a>). Changes in MYI extent are of interest because of the repercussions they have on the Earth’s climate which, in turn, can impact the Arctic ecosystem and affect human activities in the region (e.g., <a class="reference external" href="https://doi.org/10.1017/9781009157964.005" rel="noreferrer" target="_blank">[2]</a>).</p>
<p>The assessment uses two different sea-ice products. This choice helps determine the robustness of the results and highlight the properties of the two datasets. The first dataset, referred to as “CDS dataset”, provides information on sea-ice types in the region, while the second, the “NERSC dataset”, classifies sea ice into age categories.</p>
<p>Both datasets indicate a general decrease in Arctic multi-year sea ice extent over the last three decades, especially in the Beaufort Sea, the Chukchi Sea, and the Eurasian Basin. However, they show several differences on a regional scale. For example, compared to the CDS dataset, the NERSC dataset reports a consistent higher presence of multi-year sea ice in the Greenland Sea away from the coast.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Both the CDS and the NERSC datasets reveal an overall decrease in multi-year sea ice extent over the Arctic since 1991, with the most significant reductions occurring in the Beaufort Sea, the Chukchi Sea, and the Eurasian Basin.</p></li>
<li><p>Despite their consistent conclusions, notable differences exist between the two datasets. Specifically, the CDS dataset tends to overestimate multi-year sea ice presence in the Beaufort Sea and underestimate it in the Greenland Sea when compared to the NERSC dataset. It is shown that these discrepancies tend to be minimum in October and to become more pronounced as each winter progresses.</p></li>
<li><p>The inclusion of “ambiguous” data points in the CDS dataset has two main implications on the estimates of multi-year sea ice extent in the Arctic. At first, it affects the total amount of multi-year sea ice in the region, even though it only little alters its geographic distribution. Secondly, it increases its day-to-day variability.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The evolution of multi-year sea ice extent in the Arctic is based on two different datasets. This choice helps show the properties of the two products as well as assessing the robustness of the results. The first dataset is freely available on the Copernicus Climate Data Store (CDS) website under the name <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-ice-edge-type?tab=overview" rel="noreferrer" target="_blank">“Sea ice edge and type daily gridded data from 1978 to present derived from satellite observations”</a>. The data provides information on sea-ice types in the Arctic Ocean by classifying sea ice into four categories: “open water”, “first-year ice”, “multi-year ice”, and “ambiguous”. The classification primarily relies on brightness temperature observed by passive microwave radiometers. For the purposes of this Notebook, only the subset of the dataset labelled as Climate Data Records (CDRs) is considered, thereby excluding the Interim Climate Data Records (ICDRs). The ICDRs have been excluded from this work because their consistency has not been as thoroughly verified as that of the CDRs.</p>
<p>The second dataset is described by <a class="reference external" href="https://doi.org/10.5194/tc-12-2073-2018" rel="noreferrer" target="_blank">[3]</a> and is provided by Dr. Anton Korosov (<a class="reference external" href="mailto:anton&#46;korosov&#37;&#52;&#48;nersc&#46;no" rel="noreferrer" target="_blank">anton<span>&#46;</span>korosov<span>&#64;</span>nersc<span>&#46;</span>no</a>) on request. This dataset differs from the previous one as it uses an Eulerian advection scheme, together with passive-microwave-derived concentration and drift estimations, to classify sea ice into age categories, instead of ice types. Specifically, the dataset provides an estimate of sea-ice age over the Arctic, and an estimate of individual ice-age fractions at each grid point. For convenience, the former dataset will be referred to as “CDS dataset” whereas the latter as “NERSC dataset”.</p>
<p>The assessment uses two distinct approaches to identify the grid points characterized by multi-year sea ice in the CDS and in the NERSC datasets. In the CDS dataset, the presence of multi-year sea ice is determined using two different criteria: first, by selecting the pixels classified as “multi-year ice”, and second, by considering the pixels classified as both “multi-year ice” and “ambiguous”. The results obtained with these two criteria are then compared to highlight the role of the pixels classified as ambiguous. Instead, in the NERSC dataset, multi-year sea ice is identified by selecting the pixels where the concentration of first-year sea ice (FYI) does not exceed that of sea ice that is older than one year, and where the sum of the two exceeds 30% (where there is some ice present). Note that this threshold, which is usually 15%, is chosen to be consistent with the CDS product.</p>
<p>The analysis is performed on the overlapping interval of the two datasets during the boreal winters between October 1991 and April 2020, where with boreal winter we refer to the period ranging from the 1st of October of one year to the 30th of April of the following year. The upper limit is set by the CDS dataset, which provides information on sea-ice types for the boreal winter months between October 1978 and December 2020, whereas the lower limit is set by the NERSC dataset, which covers the period from September 1991 to May 2023.</p>
<p>The “Analysis and results” section is structured as follows:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-1"><span class="std std-ref">1. Parameters, requests and functions definition</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-2"><span class="std std-ref">2. Download and transform data</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-3"><span class="std std-ref">3. Results</span></a></strong></p>
<p>     <strong><a class="reference internal" href="#satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-3-1"><span class="std std-ref">3.1 Temporal evolution of the total area covered by multi-year sea ice in the Arctic Basin</span></a></strong></p>
<p>     We present and compare the temporal evolution of the area covered by multi-year sea ice over the Arctic Basin as provided by the CDS and the NERSC datasets. This section also quantifies the mismatch between the two datasets by analysing the bias and the integrated ice type error (IITE) of the NERSC dataset relative to CDS dataset. The bias is the difference between the area where the CDS dataset reports multi-year sea ice while the NERSC dataset does not, and the area where the CDS dataset does not report multi-year sea ice while the NERSC dataset does. Instead, the integrated ice type error is the sum of these two areas.</p>
<p>     <strong><a class="reference internal" href="#satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-3-2"><span class="std std-ref">3.2 Spatial and temporal evolution of the region covered by multi-year sea ice in the Arctic</span></a></strong></p>
<p>     We investigate further the temporal evolution of multi-year sea ice in the Arctic with the help of maps. Specifically, we present and compare, for each dataset, month and pixel, the percentage of days associated with multi-year sea ice over three decades.</p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="parameters-requests-and-functions-definition">
<span id="satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-1"></span><h3>1. Parameters, requests and functions definition<a class="headerlink" href="#parameters-requests-and-functions-definition" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Define the parameters and formulate the requests for downloading with the EQC toolbox.</p></li>
<li><p>Define the functions to process and reduce the size of the downloaded data.</p></li>
<li><p>Define the functions to post-process and visualize the data.</p></li>
</ul>
<section id="import-libraries">
<h4>1.1 Import libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h4>
<p>Define the code to import the required libraries.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cmocean</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-parameters">
<h4>1.2 Set Parameters<a class="headerlink" href="#set-parameters" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>set the years to use for the climatologies with <code class="docutils literal notranslate"><span class="pre">periods</span></code>. These years are also used to define the length of the time series.</p></li>
<li><p>set <code class="docutils literal notranslate"><span class="pre">conc_threshold</span></code>, the concentration threshold to determine the presence of sea ice in the NERSC product.</p></li>
<li><p>set the path to the NERSC ice age product with <code class="docutils literal notranslate"><span class="pre">NERSC_path</span></code>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define time periods</span>
<span class="n">periods</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">slice</span><span class="p">(</span><span class="mi">1991</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
    <span class="nb">slice</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">2010</span><span class="p">),</span>
    <span class="nb">slice</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">2019</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Concentration threshold to determine the presence of sea ice in the NERSC product</span>
<span class="n">conc_threshold</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1"># %</span>

<span class="c1"># Define path to NERSC data</span>
<span class="n">NERSC_PATH</span> <span class="o">=</span> <span class="s2">&quot;/data/wp5/mangini_fabio/nersc_ice_age_v2p1&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-requests">
<h4>1.3 Define requests<a class="headerlink" href="#define-requests" title="Link to this heading">#</a></h4>
<p>Define the requests to be submitted to the CDS.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-sea-ice-edge-type&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_requests</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
    <span class="n">common_request</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="s2">&quot;northern_hemisphere&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;3_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">common_request</span>
        <span class="o">|</span> <span class="p">{</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)],</span>
            <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
        <span class="p">},</span>
        <span class="n">common_request</span>
        <span class="o">|</span> <span class="p">{</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)],</span>
            <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)],</span>
        <span class="p">},</span>
    <span class="p">]</span>

<span class="n">request_timeseries</span> <span class="o">=</span> <span class="n">get_requests</span><span class="p">(</span>
    <span class="n">year_start</span><span class="o">=</span><span class="nb">min</span><span class="p">([</span><span class="n">period</span><span class="o">.</span><span class="n">start</span> <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">periods</span><span class="p">]),</span>
    <span class="n">year_stop</span><span class="o">=</span><span class="nb">max</span><span class="p">([</span><span class="n">period</span><span class="o">.</span><span class="n">stop</span> <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">periods</span><span class="p">]),</span>
<span class="p">)</span>

<span class="n">requests_periods</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">periods</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Oct </span><span class="si">{</span><span class="n">period</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2"> - Apr </span><span class="si">{</span><span class="n">period</span><span class="o">.</span><span class="n">stop</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">requests_periods</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_requests</span><span class="p">(</span><span class="n">period</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">period</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-load-and-classify-nersc-data">
<h4>1.4 Functions to load and classify NERSC data<a class="headerlink" href="#functions-to-load-and-classify-nersc-data" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_nersc_data</span></code> loads the NERSC data for a period corresponding to a set CDS data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_nersc_multiyear_ice</span></code> processes the NERSC data to produce a mask of multi-year sea ice.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_nersc_data</span><span class="p">(</span><span class="n">ds_cds</span><span class="p">,</span> <span class="n">nersc_path</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">nersc_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nersc_path</span> <span class="o">=</span> <span class="n">NERSC_PATH</span>

    <span class="n">paths</span> <span class="o">=</span> <span class="n">ds_cds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nersc_path</span><span class="si">}</span><span class="s2">/%Y/arctic25km_sea_ice_age_v2p1_%Y%m%d.nc&quot;</span>
    <span class="p">)</span>
    <span class="n">ds_nersc</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="n">concat_dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>
        <span class="n">combine</span><span class="o">=</span><span class="s2">&quot;nested&quot;</span><span class="p">,</span>
        <span class="n">data_vars</span><span class="o">=</span><span class="s2">&quot;minimal&quot;</span><span class="p">,</span>
        <span class="n">coords</span><span class="o">=</span><span class="s2">&quot;minimal&quot;</span><span class="p">,</span>
        <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;override&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ds_nersc</span> <span class="o">=</span> <span class="n">ds_nersc</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;yc&quot;</span><span class="p">)</span>
    <span class="n">ds_nersc</span> <span class="o">=</span> <span class="n">ds_nersc</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
        <span class="p">{</span><span class="n">coord</span><span class="p">:</span> <span class="n">ds_cds</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">)}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">ds_nersc</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_nersc_multiyear_ice</span><span class="p">(</span>
    <span class="n">ds_cds</span><span class="p">,</span>
    <span class="n">use_fyi</span><span class="p">,</span>
    <span class="n">age_threshold</span><span class="p">,</span>
    <span class="n">conc_threshold</span><span class="p">,</span>
    <span class="n">nersc_ice_age_path</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">ds_nersc</span> <span class="o">=</span> <span class="n">get_nersc_data</span><span class="p">(</span><span class="n">ds_cds</span><span class="p">,</span> <span class="n">nersc_ice_age_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">age_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">use_fyi</span>
        <span class="k">assert</span> <span class="n">conc_threshold</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">ds_nersc</span><span class="p">[</span><span class="s2">&quot;sia&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">age_threshold</span>

    <span class="k">assert</span> <span class="n">conc_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="n">conc_myi</span> <span class="o">=</span> <span class="n">ds_nersc</span><span class="p">[</span><span class="s2">&quot;conc_2yi&quot;</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">varname</span> <span class="o">:=</span> <span class="sa">f</span><span class="s2">&quot;conc_</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">yi&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ds_nersc</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
        <span class="n">conc_myi</span> <span class="o">+=</span> <span class="n">ds_nersc</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">use_fyi</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">conc_myi</span> <span class="o">&gt;</span> <span class="n">conc_threshold</span>

    <span class="n">conc_fyi</span> <span class="o">=</span> <span class="n">ds_nersc</span><span class="p">[</span><span class="s2">&quot;conc_1yi&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">conc_myi</span> <span class="o">+</span> <span class="n">conc_fyi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">conc_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">conc_myi</span> <span class="o">&gt;</span> <span class="n">conc_fyi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-produce-time-series">
<h4>1.5 Functions to produce time series<a class="headerlink" href="#functions-to-produce-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_classification_mask</span></code> processes the CDS data to produce a mask of multi-year sea ice.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask_outside_central_arctic</span></code> defines a mask based on a manually defined set of maximum latitudes. This mask is <code class="docutils literal notranslate"><span class="pre">False</span></code> if a pixel should be included in the calculation of MYI extent and error statistics and <code class="docutils literal notranslate"><span class="pre">True</span></code> if it shouldn’t.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_spatial_sum</span></code> computes the area corresponding to a given boolean array on an equal-area grid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_sea_ice_evaluation_diagnostics</span></code> computes the multi-year sea ice extent for the NERSC and the CDS products, the bias and the integrated ice type error between them.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_classification_mask</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">use_ambiguous</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;ice_type&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">da</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">if</span> <span class="n">use_ambiguous</span> <span class="k">else</span> <span class="p">(</span><span class="n">da</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">mask_outside_central_arctic</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="n">lon_pts</span><span class="p">,</span> <span class="n">lat_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">128.9355</span><span class="p">,</span> <span class="mf">70.9883</span><span class="p">],</span> <span class="c1"># end of Canadian Archipelago</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">121.5527</span><span class="p">,</span> <span class="mf">77.7489</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">103.5352</span><span class="p">,</span> <span class="mf">79.7967</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">94.4824</span><span class="p">,</span> <span class="mf">81.8861</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">74.7949</span><span class="p">,</span> <span class="mf">83.5301</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">60.3809</span><span class="p">,</span> <span class="mf">82.6538</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">32.3438</span><span class="p">,</span> <span class="mf">84.0526</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">10.3711</span><span class="p">,</span> <span class="mf">81.6724</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">10.1074</span><span class="p">,</span> <span class="mf">80.0277</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">25.1367</span><span class="p">,</span> <span class="mf">71.131</span><span class="p">],</span> <span class="c1"># near Gjesvaer Norway</span>
    <span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="n">interp_func</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">lon_pts</span><span class="p">,</span> <span class="n">lat_pts</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span>
    <span class="n">lat_threshold</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span>
        <span class="n">interp_func</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span>
        <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[]],</span>
        <span class="n">vectorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;parallelized&quot;</span><span class="p">,</span>
        <span class="n">output_dtypes</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">lat</span> <span class="o">&lt;</span> <span class="n">lat_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">lat_threshold</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_spatial_sum</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">)):</span>
    <span class="k">return</span> <span class="n">grid_cell_area</span> <span class="o">*</span> <span class="n">da</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_sea_ice_evaluation_diagnostics</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">,</span>
    <span class="n">use_ambiguous</span><span class="p">,</span>
    <span class="n">use_fyi</span><span class="p">,</span>
    <span class="n">age_threshold</span><span class="p">,</span>
    <span class="n">conc_threshold</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># grid cell area of sea ice edge grid</span>
    <span class="p">(</span><span class="n">dx</span><span class="p">,)</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xc&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;xc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">grid_cell_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0e-6</span>  <span class="c1"># 10^6 km2</span>

    <span class="c1"># Mask for inside central Arctic</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">mask_outside_central_arctic</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

    <span class="c1"># Masks for MYI</span>
    <span class="n">da_cds</span> <span class="o">=</span> <span class="n">get_classification_mask</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">use_ambiguous</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">mask</span>
    <span class="n">da_nersc</span> <span class="o">=</span> <span class="n">get_nersc_multiyear_ice</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span>
        <span class="n">use_fyi</span><span class="o">=</span><span class="n">use_fyi</span><span class="p">,</span>
        <span class="n">age_threshold</span><span class="o">=</span><span class="n">age_threshold</span><span class="p">,</span>
        <span class="n">conc_threshold</span><span class="o">=</span><span class="n">conc_threshold</span><span class="p">,</span>
        <span class="n">nersc_ice_age_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">&amp;</span> <span class="n">mask</span>

    <span class="c1"># Fill variables</span>
    <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;$10^6$km$^2$&quot;</span>
    <span class="n">dataarrays</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;mysi_extent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_spatial_sum</span><span class="p">(</span><span class="n">da_cds</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="p">)</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;mysi_extent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;multi_year_sea_ice_extent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">units</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Multi-year sea ice extent from CDS dataset&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;mysi_extent_age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_spatial_sum</span><span class="p">(</span><span class="n">da_nersc</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="p">)</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;mysi_extent_age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;multi_year_sea_ice_extent_age&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">units</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Multi-year sea ice extent from NERSC sea ice age product&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">over</span> <span class="o">=</span> <span class="n">compute_spatial_sum</span><span class="p">(</span><span class="n">da_cds</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">da_nersc</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="p">)</span>
    <span class="n">under</span> <span class="o">=</span> <span class="n">compute_spatial_sum</span><span class="p">(</span><span class="o">~</span><span class="n">da_cds</span> <span class="o">&amp;</span> <span class="n">da_nersc</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="p">)</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;mysi_extent_bias&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">over</span> <span class="o">-</span> <span class="n">under</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;mysi_extent_bias&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;multi_year_sea_ice_extent_bias&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">units</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Multi-year sea ice extent bias&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;iite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">over</span> <span class="o">+</span> <span class="n">under</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;iite&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;integrated_ice_type_error&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">units</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Integrated ice type error&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-post-process-and-plot-time-series">
<h4>1.6 Functions to post-process and plot time series<a class="headerlink" href="#functions-to-post-process-and-plot-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rearrange_year_vs_monthday</span></code> groups a long time series by year and day of year.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">split_dataset_ambiguous</span></code> splits a dataset into one dataset that depends on whether the ambiguous pixels in the CDS dataset are used, and another dataset that does not depend on this.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_against_monthday</span></code> plots the timeseries against the day-of-year by year, with a different colour for each year.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">rearrange_year_vs_monthday</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s2">&quot;noleap&quot;</span><span class="p">)</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">year</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">year</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="s2">&quot;monthday&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">coords</span><span class="p">))</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    
    
<span class="k">def</span><span class="w"> </span><span class="nf">split_dataset_ambiguous</span><span class="p">(</span><span class="n">ds_timeseries</span><span class="p">):</span>
    <span class="n">ds_timeseries_doy</span> <span class="o">=</span> <span class="n">rearrange_year_vs_monthday</span><span class="p">(</span><span class="n">ds_timeseries</span><span class="p">)</span>
    <span class="n">ds_no_ambig</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_timeseries_doy</span><span class="p">[</span><span class="s2">&quot;mysi_extent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">use_ambiguous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                  <span class="o">-</span> <span class="n">ds_timeseries_doy</span><span class="p">[</span><span class="s2">&quot;mysi_extent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">use_ambiguous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                  <span class="p">)</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span><span class="o">.</span><span class="n">rename_vars</span><span class="p">({</span><span class="s2">&quot;mysi_extent&quot;</span><span class="p">:</span> <span class="s2">&quot;ambiguous_extent&quot;</span><span class="p">})</span>
    <span class="n">ds_no_ambig</span><span class="p">[</span><span class="s2">&quot;ambiguous_extent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ambiguous_extent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Ambiguous Extent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;$10^6$km$^2$&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">ds_no_ambig</span><span class="p">[</span><span class="s2">&quot;mysi_extent_age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_timeseries_doy</span><span class="p">[</span><span class="s2">&quot;mysi_extent_age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;use_ambiguous&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds_timeseries_doy</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;mysi_extent_age&quot;</span><span class="p">]),</span> <span class="n">ds_no_ambig</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_against_monthday</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">single_row</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;row&quot;</span><span class="p">:</span> <span class="s2">&quot;variable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;use_ambiguous&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hue&quot;</span><span class="p">:</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span>
        <span class="s2">&quot;add_legend&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
        <span class="s2">&quot;sharey&quot;</span><span class="p">:</span> <span class="s1">&#39;row&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">cbar_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Year&quot;</span><span class="p">,</span>
        <span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">.7</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">single_row</span><span class="p">:</span>
        <span class="n">defaults</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="s2">&quot;row&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;variable&quot;</span><span class="p">,</span>
            <span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="s2">&quot;sharey&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">cbar_kwargs</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mf">0.025</span><span class="p">,</span>
            <span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">}</span>
    
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;200</span><span class="si">{</span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">monthday</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">monthday</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">monthday</span> <span class="ow">in</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;monthday&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;monthday&quot;</span><span class="p">,</span> <span class="n">time</span><span class="p">))</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">da</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">colors</span>
    <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">({</span><span class="s2">&quot;axes.prop_cycle&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cycler</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)}):</span>
        <span class="n">facet</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="p">(</span><span class="n">defaults</span> <span class="o">|</span> <span class="n">kwargs</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">sel_dict</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">facet</span><span class="o">.</span><span class="n">name_dicts</span><span class="o">.</span><span class="n">flatten</span><span class="p">())):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> %b&quot;</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">single_row</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">title</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">sel_dict</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; NERSC&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">NERSC&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span><span class="k">ds</span>[sel_dict[&quot;variable&quot;]].attrs[&quot;units&quot;]
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

    <span class="n">scalar_mappable</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
    <span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scalar_mappable</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">,</span> <span class="o">**</span><span class="n">cbar_kwargs</span><span class="p">)</span> 
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">single_row</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span><span class="k">ds</span>[sel_dict[&quot;variable&quot;]].attrs[&quot;units&quot;]
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">row_labels</span><span class="p">:</span>
        <span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">long_name</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;from&quot;</span><span class="p">,</span> <span class="s2">&quot;from</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>            
        <span class="n">label</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">long_name</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">col_labels</span><span class="p">:</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;U&quot;</span> <span class="k">if</span> <span class="s2">&quot;true&quot;</span> <span class="ow">in</span> <span class="n">label</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;Not u&quot;</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="s2">&quot;sing ambiguous pixels&quot;</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-produce-climatologies">
<h4>1.7 Functions to produce climatologies<a class="headerlink" href="#functions-to-produce-climatologies" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">compute_multiyear_ice_percentage</span></code> groups daily MYI masks by month and calculates the proportion of each month that a pixel contains MYI.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_cds_multiyear_ice_percentage</span></code> is a wrapper to call <code class="docutils literal notranslate"><span class="pre">compute_multiyear_ice_percentage</span></code> for CDS data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_nersc_multiyear_ice_percentage</span></code> is a wrapper to call <code class="docutils literal notranslate"><span class="pre">compute_multiyear_ice_percentage</span></code> for NERSC data.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_multiyear_ice_percentage</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">da</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">da</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">da</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Multi-year sea ice percentage&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;percentage&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_cds_multiyear_ice_percentage</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">use_ambiguous</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">get_classification_mask</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">use_ambiguous</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">compute_multiyear_ice_percentage</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_nersc_multiyear_ice_percentage</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">use_fyi</span><span class="p">,</span> <span class="n">age_threshold</span><span class="p">,</span> <span class="n">conc_threshold</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">get_nersc_multiyear_ice</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span>
        <span class="n">use_fyi</span><span class="o">=</span><span class="n">use_fyi</span><span class="p">,</span>
        <span class="n">age_threshold</span><span class="o">=</span><span class="n">age_threshold</span><span class="p">,</span>
        <span class="n">conc_threshold</span><span class="o">=</span><span class="n">conc_threshold</span><span class="p">,</span>
        <span class="n">nersc_ice_age_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">compute_multiyear_ice_percentage</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-plot-climatologies">
<h4>1.8 Functions to plot climatologies<a class="headerlink" href="#functions-to-plot-climatologies" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plot_maps</span></code> plots multiple maps of either MYI percentage or the difference between the CDS and NERSC products.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_cds_maps</span></code> is a wrapper that calls <code class="docutils literal notranslate"><span class="pre">plot_maps</span></code> for CDS data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_masked_data_cds</span></code> plots an example map to show the masked region used to calculate the time series.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_bias_maps</span></code> plots multiple maps of the difference between the CDS and NERSC products.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_maps</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">coastline_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;period&quot;</span><span class="p">,</span>
        <span class="s2">&quot;row&quot;</span><span class="p">:</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span>
        <span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mf">90.0</span><span class="p">),</span>
        <span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ice</span><span class="p">,</span>
        <span class="s2">&quot;cbar_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;shrink&quot;</span> <span class="p">:</span> <span class="mf">.4</span><span class="p">,</span>
            <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mf">.1</span><span class="p">,</span>
            <span class="s2">&quot;anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">.5</span><span class="p">),</span> <span class="c1"># .5 to center vertically</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
        <span class="n">xc</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5e3</span><span class="p">,</span> <span class="mf">2.5e3</span><span class="p">),</span>
        <span class="n">yc</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">2.5e3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5e3</span><span class="p">),</span>
        <span class="n">month</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">da</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="n">defaults</span> <span class="o">|</span> <span class="n">kwargs</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">coastline_color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gainsboro&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  
        <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> 
   
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">col_labels</span><span class="p">):</span>
        <span class="n">long_name</span> <span class="o">=</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">long_name</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">row_labels</span><span class="p">):</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

    <span class="n">facet</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">facet</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_cds_maps</span><span class="p">(</span><span class="n">ds_cds</span><span class="p">,</span> <span class="n">ambiguous</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_sup</span><span class="p">):</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">plot_maps</span><span class="p">(</span><span class="n">ds_cds</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">use_ambiguous</span><span class="o">=</span><span class="n">ambiguous</span><span class="p">))</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CDS MYI percentage;</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">ambiguous</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39; not&#39;</span><span class="si">}</span><span class="s2"> using ambiguous pixels&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_sup</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_masked_data_cds</span><span class="p">(</span><span class="n">ds_cds</span><span class="p">):</span>
    <span class="c1"># select a map to plot to illustrate the masked area</span>
    <span class="n">sel_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">use_ambiguous</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">period</span> <span class="o">=</span> <span class="n">ds_cds</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">xc</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5e3</span><span class="p">,</span> <span class="mf">2.5e3</span><span class="p">),</span>
        <span class="n">yc</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">2.5e3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5e3</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds_cds</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask_outside_central_arctic</span><span class="p">(</span><span class="n">da</span><span class="p">))</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mf">90.0</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ice</span><span class="p">,</span> <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gainsboro&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">title</span> <span class="o">=</span> <span class="n">sel_dict</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">title</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;Oct&quot;</span><span class="p">)</span>
    <span class="n">title</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;Apr&quot;</span><span class="p">)</span>
    <span class="n">title</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">[</span><span class="n">sel_dict</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]])</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sel_dict</span><span class="p">[</span><span class="s1">&#39;use_ambiguous&#39;</span><span class="p">]:</span>
        <span class="n">title</span> <span class="o">+=</span> <span class="s2">&quot; not&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s2">&quot; using ambiguous data&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_bias_maps</span><span class="p">(</span><span class="n">da_bias</span><span class="p">,</span> <span class="n">ambiguous</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_sup</span><span class="p">):</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">plot_maps</span><span class="p">(</span>
        <span class="n">da_bias</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">use_ambiguous</span><span class="o">=</span><span class="n">ambiguous</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bias (CDS - NERSC);</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">ambiguous</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39; not&#39;</span><span class="si">}</span><span class="s2"> using ambiguous pixels&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_sup</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-and-transform-data">
<span id="satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-2"></span><h3>2. Download and transform data<a class="headerlink" href="#download-and-transform-data" title="Link to this heading">#</a></h3>
<p>Here we download the sea ice type data and transform it to create the time series and climatology maps. The NERSC data should already be available locally.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nersc_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;use_fyi&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;age_threshold&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;conc_threshold&quot;</span><span class="p">:</span> <span class="n">conc_threshold</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">download_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="s2">&quot;concat_dim&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
    <span class="s2">&quot;combine&quot;</span><span class="p">:</span> <span class="s2">&quot;nested&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_vars&quot;</span><span class="p">:</span> <span class="s2">&quot;minimal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coords&quot;</span><span class="p">:</span> <span class="s2">&quot;minimal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;compat&quot;</span><span class="p">:</span> <span class="s2">&quot;override&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Timeseries</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">use_ambiguous</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Timeseries: </span><span class="si">{</span><span class="n">use_ambiguous</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request_timeseries</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_sea_ice_evaluation_diagnostics</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">nersc_kwargs</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;use_ambiguous&quot;</span><span class="p">:</span> <span class="n">use_ambiguous</span><span class="p">},</span>
        <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">use_ambiguous</span><span class="o">=</span><span class="p">[</span><span class="n">use_ambiguous</span><span class="p">])</span><span class="o">.</span><span class="n">compute</span><span class="p">())</span>
<span class="n">ds_timeseries_ambig</span><span class="p">,</span> <span class="n">ds_timeseries_no_ambig</span>  <span class="o">=</span> <span class="n">split_dataset_ambiguous</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;use_ambiguous&quot;</span><span class="p">))</span>
<span class="k">del</span> <span class="n">datasets</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NERSC Maps</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">requests</span> <span class="ow">in</span> <span class="n">requests_periods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NERSC Maps: </span><span class="si">{</span><span class="n">period</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">requests</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_nersc_multiyear_ice_percentage</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">nersc_kwargs</span><span class="p">,</span>
        <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="p">[</span><span class="n">period</span><span class="p">]))</span>
<span class="n">ds_nersc</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;period&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CDS Maps</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">requests</span> <span class="ow">in</span> <span class="n">requests_periods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">use_ambiguous</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CDS Maps: </span><span class="si">{</span><span class="n">period</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">use_ambiguous</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="n">collection_id</span><span class="p">,</span>
            <span class="n">requests</span><span class="p">,</span>
            <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_cds_multiyear_ice_percentage</span><span class="p">,</span>
            <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;use_ambiguous&quot;</span><span class="p">:</span> <span class="n">use_ambiguous</span><span class="p">},</span>
            <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">use_ambiguous</span><span class="o">=</span><span class="p">[</span><span class="n">use_ambiguous</span><span class="p">],</span> <span class="n">period</span><span class="o">=</span><span class="p">[</span><span class="n">period</span><span class="p">]))</span>
<span class="n">ds_cds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>

<span class="c1"># Bias compared to NERSC product</span>
<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">da_bias</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_cds</span> <span class="o">-</span> <span class="n">ds_nersc</span><span class="p">)[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span>
<span class="n">da_bias</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bias of &quot;</span> <span class="o">+</span> <span class="n">da_bias</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="results">
<span id="satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-3"></span><h3>3. Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<p>The temporal evolution of multi-year sea ice extent over the Arctic is analysed using a combination of plots and maps. The plots help quantify and compare the temporal evolution of the Arctic multi-year sea ice extent provided by the two datasets, while the maps help explain the differences between the two datasets by identifying the regions where the two products differ the most.</p>
<section id="temporal-evolution-of-the-total-area-covered-by-multi-year-sea-ice-in-the-arctic-basin">
<span id="satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-3-1"></span><h4>3.1 Temporal evolution of the total area covered by multi-year sea ice in the Arctic Basin<a class="headerlink" href="#temporal-evolution-of-the-total-area-covered-by-multi-year-sea-ice-in-the-arctic-basin" title="Link to this heading">#</a></h4>
<p>The map below shows the area over which the Arctic MYI extent is calculated to produce the plots. We should note that the MYI extent is computed over the Arctic Basin, therefore excluding the narrow straits and the Greenland Sea. This choice was made to ensure that the NERSC dataset was able to permit MYI in the selected region. For example, it may not be capable of advecting multi-year sea ice through narrow straits, such as the Nares Strait west of Greenland and the northern Canadian Archipelago.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_masked_data_cds</span><span class="p">(</span><span class="n">ds_cds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/e32ddc6bb29efb5d2338f937d7b2a196f3aeb0f1d487f95f7bacf666a66c3133.png" src="../../_images/e32ddc6bb29efb5d2338f937d7b2a196f3aeb0f1d487f95f7bacf666a66c3133.png" />
</div>
</div>
<p>The figure below consists of two plots. The plot on the left displays, for each boreal winter between October 1991 and April 2020, the daily area where the sea-ice type from the CDS dataset is set to ambiguous. The plot on the right follows the same structure, but shows the daily MYI extent as provided by the NERSC dataset.</p>
<p>The ambiguous MYI extent increases as each boreal winter progresses, with the rise accelerating in spring. This results from the CDS product performing better during the cold and stable mid-winter months than in the warmer spring months, when melting and other factors disrupt the distinction between classes. In addition, the CDS product uses drift tracking from the summer minimum to confirm the presence of MYI, and the error in this drift would also accumulate over the winter.</p>
<p>Interestingly, the ambiguous MYI extent does not experience a long-term change, despite the MYI extent decreasing over the period considered, as shown by the figure to the right and the ones below (introduced and discussed later).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_against_monthday</span><span class="p">(</span><span class="n">ds_timeseries_no_ambig</span><span class="p">,</span> <span class="n">single_row</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/e4f196689dae2cd9bbed45b28d90b11e9760cf3561edda9b4619c7e25ea054f8.png" src="../../_images/e4f196689dae2cd9bbed45b28d90b11e9760cf3561edda9b4619c7e25ea054f8.png" />
</div>
</div>
<p>The figure below consists of six plots, arranged in a grid of three rows and two columns. The first row displays the daily MYI extent for each boreal winter between October 1991 and April 2020, estimated from the CDS dataset. The second row shows the difference (“bias”) between the CDS and the NERSC datasets, while the third row shows the corresponding integrated ice type error. The columns distinguish between the two definitions of multi-year sea ice for the CDS dataset. The right column shows the results based solely on the grid points labelled as “multi-year ice”, whereas the left column shows results based on the grid points labelled as either “multi-year ice” or “ambiguous”.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_against_monthday</span><span class="p">(</span><span class="n">ds_timeseries_ambig</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f89b0a97d3e92afeb419f377ab09e89dcc7d3736fa4884356fe9f57086151f42.png" src="../../_images/f89b0a97d3e92afeb419f377ab09e89dcc7d3736fa4884356fe9f57086151f42.png" />
</div>
</div>
<p>The comparison between the MYI extent from the CDS and the NERSC datasets yields comparable results, and the inclusion of the grid points labelled as “ambiguous” does not significantly alter the main conclusions. The results indicate that the spatial extent of multi-year sea ice in the Arctic has decreased since October 1991. Specifically, the October MYI extent dropped by approximately 1-2 million km<span class="math notranslate nohighlight">\(^2\)</span> between the 5-year periods 1991-1995 and 2015-2019. A comparable result is found for the MYI extent in April. Selecting the ambiguous points does not significantly alter the results.</p>
<p>Both datasets also suggest that the MYI extent tends to decrease throughout each boreal winter. This is expected because MYI tends to be both exported and compressed through ridging as winter progresses (the reader is referred to <a class="reference external" href="https://doi.org/10.5194/tc-17-1873-2023" rel="noreferrer" target="_blank">[4]</a> for a comprehensive explanation of sources and sinks of multi-year sea ice).</p>
<p>Despite their similarities, the datasets present some significant differences. Notably, the CDS dataset exhibits a slightly greater day-to-day variability compared to the NERSC dataset when the pixels labelled as “ambiguous” are included into the analysis. A thorough understanding of this discrepancy goes beyond the scope of this study. However, we hypothesize it to be partially attributed to atmospheric variability, which can affect the brightness temperature of sea ice and, therefore, the classification into first-year sea ice and multi-year sea ice. For example, warmer weather events pose a challenge to the classification of sea ice into ice types as they modify the surface of multi-year sea ice, making it appear similar to first-year sea ice (Product User Guide and Specification of the CDS dataset). This interpretation is corroborated by the day-to-day variability in the CDS dataset decreasing when the grid points labelled as “ambiguous” are not considered. The NERSC dataset on the other hand is based on relatively smooth, low-resolution sea ice concentration and drift products derived from lower-frequency (SSMIS) passive microwave measurements which are not as affected by atmospheric variability.</p>
<p>The differences between the two datasets also appear in the four plots at the bottom, which show the temporal evolution of the bias and the integrated ice type error. Both diagnostics tend to progressively diverge from zero as each boreal winter evolves. This is not entirely surprising as at the end of summer, the Arctic by definition contains only multi-year ice, but the potential for mis-classification (by both the CDS and NERSC products) grows later in the winter as more FYI forms. With the NERSC product, the drift tracking algorithm will accumulate errors further into the winter; with the CDS product, the distinction between classes is disrupted in the spring months as warmer temperatures, melting, and dynamics (eg. increased deformation of FYI) disturb the emissivity of the sea ice.</p>
<p>The figure above indicates that the exclusion from the analysis of the pixels labelled as “ambiguous” leads to stronger decrease of multi-year sea ice extent throughout each boreal winter. This result better agrees with that provided by the NERSC dataset, with the exception of the month of April. In April, the penultimate subplot on the right shows a drop in the bias, especially during the first decade of the analysis, as indicated by the blue lines. Unfortunately, it is difficult to understand the causes behind this issue. On the one hand, the discrepancy might indicate that, in the month of April, some of the grid points labelled as “ambiguous” contain multi-year sea ice. On the other hand, it might indicate that the NERSC dataset interprets part of first-year sea ice as multi-year sea ice. This might occur because, as noticed in <a class="reference external" href="https://doi.org/10.5194/tc-12-2073-2018" rel="noreferrer" target="_blank">[3]</a>, the algorithm might prioritize small concentration of multi-year sea ice, therefore overstimating the age of sea ice at each pixel.</p>
</section>
</section>
<section id="spatial-and-temporal-evolution-of-the-region-covered-by-multi-year-sea-ice-in-the-arctic">
<span id="satellite-satellite-sea-ice-edge-type-intercomparison-q01-section-3-2"></span><h3>3.2 Spatial and temporal evolution of the region covered by multi-year sea ice in the Arctic<a class="headerlink" href="#spatial-and-temporal-evolution-of-the-region-covered-by-multi-year-sea-ice-in-the-arctic" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>from Oct 1991 to Apr 2001 (10 boreal winters)</p></li>
<li><p>from Oct 2001 to Apr 2011 (10 boreal winters)</p></li>
<li><p>from Oct 2011 to Apr 2020 (9 boreal winters)</p></li>
</ul>
<section id="maps-of-multi-year-sea-ice-from-nersc-dataset">
<h4>Maps of multi-year sea ice from NERSC dataset<a class="headerlink" href="#maps-of-multi-year-sea-ice-from-nersc-dataset" title="Link to this heading">#</a></h4>
<p>The maps below visually complement the previous plots, illustrating the geographical distribution of multi-year sea ice in the Arctic, its evolution since the early 1990s, and the regions where the CDS and NERSC datasets diverge the most.</p>
<p>The initial set of maps refers to the NERSC dataset and displays, for each month and grid point, the percentage of days associated with multi-year sea ice across three distinct periods: from October 1991 to April 2001, from October 2001 to April 2011, and from October 2011 to April 2020. The figure comprises 21 maps, with each column corresponding to one of the three periods and each row to a different month.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kw_sup</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">.37</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mf">1.0125</span><span class="p">}</span>
<span class="n">facet</span> <span class="o">=</span> <span class="n">plot_maps</span><span class="p">(</span><span class="n">ds_nersc</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">])</span>
<span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;NERSC MYI percentage&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_sup</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/af0f9587bfe5481d3fa3ad2fd8a9c93f82dfdf7fff2e483ea31ca788d7bb46a5.png" src="../../_images/af0f9587bfe5481d3fa3ad2fd8a9c93f82dfdf7fff2e483ea31ca788d7bb46a5.png" />
</div>
</div>
<p>Consistent with the plots above, the maps show a significant decline in the multi-year sea ice extent since 1991, as well as throughout the boreal winters. The decline in multi-year sea ice appears to have mostly occurred in the Beaufort Sea, the Chukchi Sea, and the Eurasian Basin. On the contrary, multi-year sea ice has consistently been present in the Canadian sector and in the Greenland Sea throughout the entire period. The presence of multi-year sea ice off the coast of Greenland is noticeable and presumably due to the advection of multi-year sea ice through the Fram Strait.</p>
</section>
<section id="maps-of-multi-year-sea-ice-from-cds-and-cds-nersc">
<h4>Maps of multi-year sea ice from CDS and “CDS - NERSC”<a class="headerlink" href="#maps-of-multi-year-sea-ice-from-cds-and-cds-nersc" title="Link to this heading">#</a></h4>
<p>The Jupyter Notebook further presents four sets of maps. These are meant to help visualize the differences between the CDS and the NERSC datasets. Each set follows the same structure as the figure above. However, the first and the second sets of maps respectively show the percentage of multi-year sea ice provided by the CDS dataset for the case when the presence of multi-year sea ice is only detected using the pixels labelled as ‘multi-year ice’ and when the ‘ambiguous’ grid points are considered. The remaining sets of maps show the differences between the percentage of multi-year sea ice provided by the CDS and the NERSC datasets. The third set is produced only using the grid points of the CDS dataset that are classified as ‘multi-year ice’, whereas the one underneath uses the grid points classified as ‘multi-year ice’ and ‘ambiguous’.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_cds_maps</span><span class="p">(</span><span class="n">ds_cds</span><span class="p">,</span> <span class="n">ambiguous</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_sup</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/875b841b8d346dab17f8debdca2e3769678baee7d7906e92ba21bda657964ae6.png" src="../../_images/875b841b8d346dab17f8debdca2e3769678baee7d7906e92ba21bda657964ae6.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_cds_maps</span><span class="p">(</span><span class="n">ds_cds</span><span class="p">,</span> <span class="n">ambiguous</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_sup</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/d768385e1479b6f4d1383601e3ab52445e066daa831caad1ba6321f93b62693c.png" src="../../_images/d768385e1479b6f4d1383601e3ab52445e066daa831caad1ba6321f93b62693c.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_bias_maps</span><span class="p">(</span><span class="n">da_bias</span><span class="p">,</span> <span class="n">ambiguous</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_sup</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/792dfe4185fd46a41cc471b12c3d990a68d7a03f8c58d0e926574cab8aba37d6.png" src="../../_images/792dfe4185fd46a41cc471b12c3d990a68d7a03f8c58d0e926574cab8aba37d6.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_bias_maps</span><span class="p">(</span><span class="n">da_bias</span><span class="p">,</span> <span class="n">ambiguous</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_sup</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/21eb557c7fbc7365481040cad2195610625deb377cd8d7ce9d4b94016336f355.png" src="../../_images/21eb557c7fbc7365481040cad2195610625deb377cd8d7ce9d4b94016336f355.png" />
</div>
</div>
<p>The inclusion of “ambiguous” data points primarily affects the magnitude of the difference, rather than the patterns. More precisely, when “ambiguous” values are included into the analysis, the grid points of the CDS dataset are more likely associated with multi-year sea ice and, therefore, the difference between the CDS and the NERSC datasets becomes more positive.</p>
<p>Compared to the NERSC dataset, the CDS product has less multi-year sea ice in the Greenland Sea, away from the coast of Greenland. Such a discrepancy might result from the difficulty of the NERSC dataset to well capture the impact of local dynamics on multi-year sea ice. Indeed, the drifts that were used to create the NERSC dataset have a daily temporal resolution. Thus, they might not fully represent the effects of the ocean since it is highly dynamic in the region. However, the discrepancy might also highlight issues with the CDS dataset as <a class="reference external" href="https://doi.org/10.5194/tc-12-2073-2018" rel="noreferrer" target="_blank">[3]</a> showed the ability of the NERSC dataset to capture multi-year sea ice in the Greenland Sea through a comparison with Sentinel-1 SAR images, used as an independent dataset, on the 1st January 2016. Therefore, further analysis is necessary to determine what causes such a discrepancy and, therefore, which dataset most reliably provides information on multi-year sea ice in the region.</p>
<p>More difficult is to determine the quality of the two datasets in other sectors of the Arctic. For example, compared to the NERSC dataset, the CDS dataset shows higher percentages of multi-year sea ice in the Beaufort Sea, the Chukchi Sea, and the Eurasian Basin. We might speculate that, in the Eurasian Basin, the discrepancy might occur because the CDS dataset might overestimate the amount of MYI due to its binary classification, which labels a grid point as MYI even if contains substantial amount of FYI. In contrast, when analysing the NERSC dataset we have classified a pixel as MYI if the concentration of MYI is greater than the concentration of FYI, which may lead to there being less MYI in this product than in the one by CDS. However, further analysis, for example focusing on individual years, is needed to assess the causes behind these disagreements.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>CDS dataset used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-ice-edge-type?tab=overview" rel="noreferrer" target="_blank">Sea ice edge and type daily gridded data from 1978 to present derived from satellite observations</a></p></li>
</ul>
<p>Additional resources:</p>
<ul class="simple">
<li><p>Section “SEA-ICE” in the <a class="reference external" href="https://library.wmo.int/idurl/4/68835" rel="noreferrer" target="_blank">State of the Global Climate 2023</a></p></li>
<li><p><a class="reference external" href="https://nsidc.org/learn/parts-cryosphere/sea-ice" rel="noreferrer" target="_blank">Learning material on sea ice provided by the National Snow and Ice Data Center</a></p></li>
<li><p><a class="reference external" href="https://svs.gsfc.nasa.gov/4251" rel="noreferrer" target="_blank">Arctic multi-year sea ice visualization</a> provided by NASA</p></li>
<li><p><a class="reference external" href="https://www.epa.gov/climate-indicators/climate-change-indicators-arctic-sea-ice" rel="noreferrer" target="_blank">Sea ice as a climate indicator</a></p></li>
<li><p><a class="reference external" href="https://www.metoffice.gov.uk/research/climate/cryosphere-oceans/sea-ice/measure" rel="noreferrer" target="_blank">How sea ice is observed</a></p></li>
<li><p><a class="reference external" href="https://narval.nersc.no" rel="noreferrer" target="_blank">NARVAL, a visualization portal for Earth observation and model data in the high-latitude oceans</a>, offers visualizations of various sea-ice variables</p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/" rel="noreferrer" target="_blank">pandas</a></p></li>
<li><p><a class="reference external" href="https://docs.xarray.dev/en/stable/" rel="noreferrer" target="_blank">xarray</a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/" rel="noreferrer" target="_blank">matplotlib</a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/cmocean/" rel="noreferrer" target="_blank">cmocean</a></p></li>
<li><p><a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/" rel="noreferrer" target="_blank">cartopy</a></p></li>
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Maslanik, J., Stroeve, J., Fowler, C., and Emery, W.: Distribution and trends in Arctic sea ice age through spring 2011, Geophys. Res. Lett., 38, L13502, <a class="reference external" href="https://doi.org/10.1029/2011GL047735" rel="noreferrer" target="_blank">https://doi.org/10.1029/2011GL047735</a>, 2011.</p></li>
<li><p>Meredith, M., Sommerkorn, M., Cassotta, S., Derksen, C., Ekaykin, A., Hollowed, A., Kofinas, G., Mackintosh, A., Melbourne-Thomas, J., Muelbert, M. M. C., Ottersen, G., Pritchard, H., and Schuur, E.: Polar Regions, in: IPCC Special Report on the Ocean and Cryosphere in a Changing Climate, edited by: Pörtner, H.-O., Roberts, D. C., Masson-Delmotte, V., Zhai, P., Tignor, M., Poloczanska, E., Mintenbeck, K., Alegría, A., Nicolai, M., Okem, A., Petzold, J., Rama, B., and Weyer, N. M., chap. 3, 203–320, Cambridge University Press, Cambridge, UK and New York, NY, USA, <a class="reference external" href="https://doi.org/10.1017/9781009157964.005" rel="noreferrer" target="_blank">https://doi.org/10.1017/9781009157964.005</a>, 2019.</p></li>
<li><p>Korosov, A. A., Rampal, P., Pedersen, L. T., Saldo, R., Ye, Y., Heygster, G., Lavergne, T., Aaboe, S., and Girard-Ardhuin, F.: A new tracking algorithm for sea ice age distribution estimation, The Cryosphere, 12, 2073–2085, <a class="reference external" href="https://doi.org/10.5194/tc-12-2073-2018" rel="noreferrer" target="_blank">https://doi.org/10.5194/tc-12-2073-2018</a>, 2018.</p></li>
<li><p>Regan, H., Rampal, P., Ólason, E., Boutin, G., Korosov, A.: Modelling the evolution of Arctic multiyear sea ice over 2000-2018, The Cryosphere, 17, 1873-1893, <a class="reference external" href="https://doi.org/10.5194/tc-17-1873-2023" rel="noreferrer" target="_blank">https://doi.org/10.5194/tc-17-1873-2023</a>, 2023.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Ocean"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="satellite_satellite-ocean-colour_consistency-assessment_q01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.6.1. </span>Impact of using successive satellites on Ocean Colour time series</p>
      </div>
    </a>
    <a class="right-next"
       href="satellite_satellite-sea-ice-thickness_trend-assessment_q01.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.6.3. </span>Suitability of satellite sea ice thickness data for studying climate change</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-long-term-evolution-of-sea-ice-type">🌍 Use case: Monitoring long-term evolution of sea ice type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">1. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set Parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests">1.3 Define requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-load-and-classify-nersc-data">1.4 Functions to load and classify NERSC data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-produce-time-series">1.5 Functions to produce time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-post-process-and-plot-time-series">1.6 Functions to post-process and plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-produce-climatologies">1.7 Functions to produce climatologies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-plot-climatologies">1.8 Functions to plot climatologies</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-data">2. Download and transform data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-evolution-of-the-total-area-covered-by-multi-year-sea-ice-in-the-arctic-basin">3.1 Temporal evolution of the total area covered by multi-year sea ice in the Arctic Basin</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-and-temporal-evolution-of-the-region-covered-by-multi-year-sea-ice-in-the-arctic">3.2 Spatial and temporal evolution of the region covered by multi-year sea ice in the Arctic</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maps-of-multi-year-sea-ice-from-nersc-dataset">Maps of multi-year sea ice from NERSC dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maps-of-multi-year-sea-ice-from-cds-and-cds-nersc">Maps of multi-year sea ice from CDS and “CDS - NERSC”</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>