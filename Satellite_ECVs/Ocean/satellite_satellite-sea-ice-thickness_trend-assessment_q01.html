
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.6.3. Suitability of satellite sea ice thickness data for studying climate change &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale" href="satellite_satellite-sea-level-global_trend-assessment_q01.html" />
    <link rel="prev" title="1.6.2. Intercomparison of satellite multi-year sea ice extent estimates" href="satellite_satellite-sea-ice-edge-type_intercomparison_q01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Atmospheric_Composition/satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.1. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Atmospheric_Composition/satellite_satellite-methane_uncertainty_q01.html">1.2.2. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Atmospheric_Composition/satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.3. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.1. Uncertainty of ice sheet surface elevation change data over Greenland for volume and mass change trend assessments</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Ocean.html">1.6. Ocean</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.2. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.6.3. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.5. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.6. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.3. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2°C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2°C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Suitability of satellite sea ice thickness data for studying climate change</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-assessing-the-suitability-of-satellite-sea-ice-thickness-data-for-studying-climate-change">🌍 Use case: Assessing the suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">1. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests">1.3 Define requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-functions">1.4 Post-processing functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-functions">1.5 Plotting functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-the-data">2. Download and transform the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-mean-and-variability-and-difference-between-satellite-periods">3.1 Temporal mean and variability, and difference between satellite periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#assessment-of-linear-model-for-temporal-variability">3.2 Assessment of linear model for temporal variability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="suitability-of-satellite-sea-ice-thickness-data-for-studying-climate-change">
<h1><span class="section-number">1.6.3. </span>Suitability of satellite sea ice thickness data for studying climate change<a class="headerlink" href="#suitability-of-satellite-sea-ice-thickness-data-for-studying-climate-change" title="Link to this heading">#</a></h1>
<p>Production date: 28-03-2025</p>
<p>Produced by: Timothy Williams, Nansen Environment and Remote Sensing Center</p>
<section id="use-case-assessing-the-suitability-of-satellite-sea-ice-thickness-data-for-studying-climate-change">
<h2>🌍 Use case: Assessing the suitability of satellite sea ice thickness data for studying climate change<a class="headerlink" href="#use-case-assessing-the-suitability-of-satellite-sea-ice-thickness-data-for-studying-climate-change" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>How well do linear trends represent satellite-derived sea ice thickness data?</strong></p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>We find that the usefullness of satellite sea ice thickness data for the purpose of studying climate change is limited, since the time series are relatively short and the sea ice thickness variable has quite a lot of interannual variability. Note that this conclusion does not apply to other applications of this data like validation of models (bearing in mind biases and uncertainties in the data).</p></li>
<li><p>In limited regions, linear trends can explain a significant amount (greater than 0.5) of the variability in the satellite data, but even in those small regions the fits are not overly representative of the satellite estimates. That is, with the small number of years with data, how good the fits are is difficult to assess visually.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>We consider the Level-3 <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-ice-thickness?tab=overview" rel="noreferrer" target="_blank"><span style="color:blue">sea ice thickness dataset</span></a>, which has two CDR (Climate Data Record) products:</p>
<ul class="simple">
<li><p>ENVISAT CDR (2002-2010)</p></li>
<li><p>CryoSat-2 CDR (2010-2020)
CryoSat-2 also has an interim CDR (ICDR, covering 2020-2024) but we did not use this product in this notebook.</p></li>
</ul>
<p>We fit linear trends to these two satellite products, and assess the goodness-of-fit using the <span class="math notranslate nohighlight">\(r^2\)</span> and <span class="math notranslate nohighlight">\(p\)</span>-value statistics.
We do separate fits for each winter month (October-April), to all pixels with at least five years of data.
Maps of the mean, standard deviation and RMS (root mean sqare) uncertainty of the thickness, the fitted linear trend and the goodness-of-fit statistics are shown.
Note that the product uncertainty does not include biases and other errors. In the evaluations done ENVISAT was found to have a significant low bias while CryoSat-2 had a small positive bias (see the <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-sea-ice-thickness/v3.0/WP2-FDDP-2022-09_C3S2-Lot3_PUGS-of-v3.0-SeaIceThickness-products_v3.1_Final.pdf" rel="noreferrer" target="_blank"><span style="color:blue">Product User Guide, p5)</span></a> for more details).</p>
<p>The “Analysis and results” section is structured as follows:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-1"><span class="std std-ref">1. Parameters, requests and functions definition</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-2"><span class="std std-ref">2. Download and transform the data</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-3"><span class="std std-ref">3. Results</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="parameters-requests-and-functions-definition">
<span id="satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-1"></span><h3>1. Parameters, requests and functions definition<a class="headerlink" href="#parameters-requests-and-functions-definition" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Define parameters and formulate requests for downloading with the EQC toolbox.</p></li>
<li><p>Define functions to be applied to process and reduce the size of the downloaded data.</p></li>
<li><p>Define functions to post-process and visualize the data.</p></li>
</ul>
<section id="import-libraries">
<h4>1.1 Import libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h4>
<p>Define code to import the required libraries</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">BoundaryNorm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cmocean</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-parameters">
<h4>1.2 Set parameters<a class="headerlink" href="#set-parameters" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Set the time range for ENVISAT data with <code class="docutils literal notranslate"><span class="pre">year_start_envisat</span></code> and <code class="docutils literal notranslate"><span class="pre">year_stop_envisat</span></code></p></li>
<li><p>Set the time range for CRYOSAT data with <code class="docutils literal notranslate"><span class="pre">year_start_cryosat</span></code> and <code class="docutils literal notranslate"><span class="pre">year_stop_cryosat</span></code></p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_start_envisat</span> <span class="o">=</span> <span class="mi">2002</span>
<span class="n">year_stop_envisat</span> <span class="o">=</span> <span class="mi">2010</span>

<span class="n">year_start_cryosat</span> <span class="o">=</span> <span class="mi">2010</span>
<span class="n">year_stop_cryosat</span> <span class="o">=</span> <span class="mi">2020</span>

<span class="n">globe</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Globe</span><span class="p">(</span><span class="n">semimajor_axis</span><span class="o">=</span><span class="mi">6378137</span><span class="p">,</span> <span class="n">inverse_flattening</span><span class="o">=</span><span class="mf">298.257223563</span><span class="p">)</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mf">90.</span><span class="p">,</span> <span class="n">globe</span><span class="o">=</span><span class="n">globe</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-requests">
<h4>1.3 Define requests<a class="headerlink" href="#define-requests" title="Link to this heading">#</a></h4>
<p>Define requests for downloading with the EQC toolbox.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-sea-ice-thickness&quot;</span>

<span class="n">year_ranges</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;envisat&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start_envisat</span><span class="p">,</span> <span class="n">year_stop_envisat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s2">&quot;cryosat_2&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start_cryosat</span><span class="p">,</span> <span class="n">year_stop_cryosat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">requests</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">satellite</span><span class="p">,</span> <span class="n">year_range</span> <span class="ow">in</span> <span class="n">year_ranges</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">requests</span><span class="p">[</span><span class="n">satellite</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="n">satellite</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;3_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">year_range</span><span class="p">)),</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]],</span>
    <span class="p">}</span>

<span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="post-processing-functions">
<h4>1.4 Post-processing functions<a class="headerlink" href="#post-processing-functions" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sort_time</span></code> sorts the dataset by month and year.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linregress_1d</span></code> fits a straight line to some training data (output and input).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_stats</span></code> calculates some statistics over the year dimension (mean, standard deviation, RMS uncertainty) and also the coefficients of a linear fit (input is year) and goodness of fit statistics (<span class="math notranslate nohighlight">\(r^2\)</span> value and <span class="math notranslate nohighlight">\(p\)</span>-value). It outputs a reduced dataset with no year dimension.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">add_differences</span></code> adds the differences between the CryoSat-2 and ENVISAT statistics to the reduced dataset, and also reduces the spatial extent for better plotting.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sort_time</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;time.year&#39;</span><span class="p">],</span> <span class="n">month</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">])</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">new_months</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">new_months</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;month_num&quot;</span><span class="p">})</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;month_num&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;month_num&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]))</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;month_num&#39;</span><span class="p">:</span> <span class="s1">&#39;month&#39;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;month_num&quot;</span><span class="p">])</span>


<span class="k">def</span><span class="w"> </span><span class="nf">linregress_1d</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">min_num_points</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_num_points</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="n">x_train</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x_train</span> <span class="o">+</span> <span class="n">intercept</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_train</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">var_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
    <span class="n">r_squared</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">mse</span> <span class="o">/</span> <span class="n">var_y</span> <span class="k">if</span> <span class="n">var_y</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_squared</span><span class="p">,</span> <span class="n">p_value</span>

    
<span class="k">def</span><span class="w"> </span><span class="nf">get_stats</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>

    <span class="c1"># init    </span>
    <span class="n">sit</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;sea_ice_thickness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">load</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># copy since apply_ufunc removes info from ds</span>
    <span class="n">proj_name</span> <span class="o">=</span> <span class="n">sit</span><span class="o">.</span><span class="n">grid_mapping</span>
    <span class="n">proj</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="n">proj_name</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># get SIT statistics and create dataset</span>
    <span class="n">sit</span> <span class="o">=</span> <span class="n">sit</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sit</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;mean_thickness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sit</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;std_thickness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sit</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
    <span class="n">unc2</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;uncertainty&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;rms_uncertainty&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">unc2</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;num_valid_years&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">sit</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
    <span class="n">ds_reduced</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">data</span>

    <span class="c1"># get linear fit of SIT vs year</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span>
        <span class="n">linregress_1d</span><span class="p">,</span>
        <span class="n">sit</span><span class="p">,</span>
        <span class="n">sit</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
        <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]],</span>
        <span class="n">output_core_dims</span><span class="o">=</span><span class="p">[[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]],</span>
        <span class="n">vectorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">dask</span><span class="o">=</span><span class="s1">&#39;parallelized&#39;</span><span class="p">,</span>
        <span class="n">dask_gufunc_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">allow_rechunk</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">output_dtypes</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;linear_trend&quot;</span><span class="p">,</span> <span class="s2">&quot;intercept_linear_fit&quot;</span><span class="p">,</span> <span class="s2">&quot;r2&quot;</span><span class="p">,</span> <span class="s2">&quot;p_value&quot;</span><span class="p">],</span> <span class="n">fit</span><span class="p">):</span>
        <span class="n">ds_reduced</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span>
    <span class="k">del</span> <span class="n">fit</span>
    <span class="n">ds_reduced</span><span class="p">[</span><span class="n">proj_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">proj</span>

    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;mean_thickness&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;mean_sea_ice_thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mean of sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;std_thickness&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;standard_deviation_of_sea_ice_thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Standard deviation of sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;rms_uncertainty&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;rms_sea_ice_thickness_uncertainty&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;RMS of sea ice thickness uncertainty&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;num_valid_years&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;number_of_valid_years&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Number of valid years&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;linear_trend&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;slope_linear_fit_to_sea_ice_thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Slope from linear fit to sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m year$^{-1}$&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;intercept_linear_fit&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;intercept_linear_fit_to_sea_ice_thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Intercept from linear fit to sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;p_value&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;p-value for linear fit to sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;p-value for linear fit to sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;r2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;r$^2$ value for linear fit to sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;r$^2$ value for linear fit to sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">vname</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
        <span class="n">ds_reduced</span><span class="p">[</span><span class="n">vname</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="n">vname</span><span class="p">]</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;grid_mapping&quot;</span><span class="p">:</span> <span class="n">proj_name</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">ds_reduced</span>


<span class="k">def</span><span class="w"> </span><span class="nf">add_differences</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>

    <span class="c1"># remove areas with no data ever</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;mean_thickness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">(),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># ensure grid is contiguous after reducing area</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;xc&#39;</span><span class="p">,</span> <span class="s1">&#39;yc&#39;</span><span class="p">]:</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">d</span><span class="p">]))</span>
        <span class="n">bpi</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">&gt;</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">bpi</span><span class="p">):</span>
            <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bpi</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="n">bpi</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="n">d</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">)})</span>

    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;diff_mean_thickness&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;difference_in_mean_sea_ice_thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Difference in mean of sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;diff_std_thickness&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;difference_in_std_sea_ice_thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Difference in standard deviation of sea ice thickness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;diff_rms_uncertainty&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;difference_in_rms_sea_ice_thickness_uncertainty&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Difference in RMS of sea ice thickness uncertainty&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">dname</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
        <span class="n">vname</span> <span class="o">=</span> <span class="n">dname</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">vname</span><span class="p">]</span>
        <span class="n">proj_name</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">grid_mapping</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">dname</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="s2">&quot;CryoSat-2&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="s2">&quot;ENVISAT&quot;</span><span class="p">)</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">dname</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="n">dname</span><span class="p">]</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;grid_mapping&quot;</span><span class="p">:</span> <span class="n">proj_name</span><span class="p">}</span>
    <span class="n">ds</span><span class="p">[</span><span class="n">proj_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="n">proj_name</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="plotting-functions">
<h4>1.5 Plotting functions<a class="headerlink" href="#plotting-functions" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plot_maps</span></code> plots monthly maps for a given variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_maps_trends</span></code> plots maps of the trend with the goodness-of-fit statistices, the <span class="math notranslate nohighlight">\(r^2\)</span> and <span class="math notranslate nohighlight">\(p\)</span> values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_maps_valid_years</span></code> plots monthly maps of the number of valid years for each satellite.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_fit</span></code> plots time series of the satellite thickness and error bars to compare to the linear fits for selected points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_fit_envisat</span></code> selects the example points to check the fits to the ENVISAT data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_fit_cryosat2</span></code> selects the example points to check the fits to the CryoSat-2 data.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_maps</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
        <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">cbar_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cbar_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cbar_kwargs</span><span class="p">[</span><span class="s2">&quot;pad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbar_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pad&quot;</span><span class="p">,</span> <span class="mf">.05</span><span class="p">)</span>
    <span class="n">cbar_kwargs</span><span class="p">[</span><span class="s2">&quot;shrink&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbar_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;shrink&quot;</span><span class="p">,</span> <span class="mf">.75</span><span class="p">)</span>
    <span class="n">cbar_kwargs</span><span class="p">[</span><span class="s2">&quot;extend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbar_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extend&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="s2">&quot;satellite&quot;</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
        <span class="n">kw</span><span class="p">[</span><span class="s2">&quot;row&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;satellite&quot;</span>
    <span class="n">facet_grid</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="n">cbar_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">facet_grid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_maps_trends</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">satellite</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">projection</span><span class="p">):</span>

    <span class="n">ds_trend</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span> <span class="n">satellite</span><span class="o">=</span><span class="n">satellite</span><span class="p">)</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;mean_thickness&quot;</span><span class="p">,</span> <span class="s2">&quot;std_thickness&quot;</span><span class="p">,</span> <span class="s2">&quot;rms_uncertainty&quot;</span><span class="p">,</span> <span class="s2">&quot;satellite&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">])</span>
    <span class="n">kw_plot</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">linear_trend</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">.2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">),</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">),</span>
        <span class="n">p_value</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
    
    <span class="c1"># Create plots</span>
    <span class="n">n_vars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kw_plot</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">n_vars</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">n_vars</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_vars</span><span class="p">)]</span>
    
    <span class="c1"># Loop over variables</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">vname</span><span class="p">,</span> <span class="n">kw</span><span class="p">),</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">kw_plot</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">axs</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">ds_trend</span><span class="p">[</span><span class="n">vname</span><span class="p">]</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
            <span class="n">da</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">cbar_kwargs</span><span class="o">=</span><span class="n">cbar_kwargs</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="n">kw</span><span class="p">[</span><span class="s2">&quot;extend&quot;</span><span class="p">]),</span>
            <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">kw</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;extend&quot;</span><span class="p">},</span>
            <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Linear fit to </span><span class="si">{</span><span class="n">satellite</span><span class="si">}</span><span class="s2"> SIT (</span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_maps_valid_years</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">month_sets</span><span class="p">,</span> <span class="n">projection</span><span class="p">):</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;tab20&#39;</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># +2 to include the top edge</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">boundaries</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
    <span class="n">cbar_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="mf">.5</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;extend&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">months</span> <span class="ow">in</span> <span class="n">month_sets</span><span class="p">:</span>
        <span class="n">plot_maps</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;num_valid_years&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">months</span><span class="p">),</span> <span class="n">projection</span><span class="p">,</span>
                  <span class="n">cbar_kwargs</span><span class="o">=</span><span class="n">cbar_kwargs</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_fit</span><span class="p">(</span><span class="n">ds_full</span><span class="p">,</span> <span class="n">ds_reduced</span><span class="p">,</span> <span class="n">points_ij</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">projection</span><span class="p">):</span>

    <span class="c1"># plot a map showing the point locations</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">ds_reduced</span><span class="p">[</span><span class="s2">&quot;r2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="mi">235</span><span class="p">),</span> <span class="n">yc</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">)),</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
        <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">},</span>
        <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">axes</span>
    
    <span class="n">eps</span> <span class="o">=</span> <span class="mf">50e3</span> <span class="c1"># distance between point and number [m]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points_ij</span><span class="p">):</span>
        <span class="n">ds_ij</span> <span class="o">=</span> <span class="n">ds_reduced</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">ds_ij</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;xc&#39;</span><span class="p">,</span> <span class="s1">&#39;yc&#39;</span><span class="p">)]</span> <span class="c1"># m</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">np</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points_ij</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">ds_full</span><span class="o">.</span><span class="n">year</span>
    <span class="n">vnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;linear_trend&quot;</span><span class="p">,</span> <span class="s2">&quot;intercept_linear_fit&quot;</span><span class="p">,</span> <span class="s2">&quot;r2&quot;</span><span class="p">,</span> <span class="s2">&quot;p_value&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">points_ij</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">())):</span>

        <span class="c1"># get the trend line</span>
        <span class="n">ds_ij</span> <span class="o">=</span> <span class="n">ds_reduced</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds_ij</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;xc&#39;</span><span class="p">,</span> <span class="s1">&#39;yc&#39;</span><span class="p">)]</span>
        <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds_ij</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vnames</span><span class="p">]</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">year</span>

        <span class="c1"># plot SIT time series and linear fit</span>
        <span class="n">ds_ij</span> <span class="o">=</span> <span class="n">ds_full</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">ds_ij</span><span class="p">[</span><span class="s2">&quot;sea_ice_thickness&quot;</span><span class="p">],</span> <span class="n">ds_ij</span><span class="p">[</span><span class="s2">&quot;uncertainty&quot;</span><span class="p">],</span>
                    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">capthick</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Satellite data&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">fit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Linear fit&quot;</span><span class="p">)</span>

        <span class="c1"># labels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Point </span><span class="si">{</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">: $r^2=</span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">$, $p=</span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Sea ice thickness [m]&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="n">np</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Fits at selected points&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.94</span><span class="p">)</span><span class="c1">#, x=.37, y=1.001)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_fit_envisat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">ds_reduced</span><span class="p">,</span> <span class="n">projection</span><span class="p">):</span>
    <span class="n">sat</span> <span class="o">=</span> <span class="s2">&quot;ENVISAT&quot;</span>
    <span class="n">month</span> <span class="o">=</span> <span class="s2">&quot;February&quot;</span>
    <span class="n">points_ij</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">122</span><span class="p">,</span><span class="mi">155</span><span class="p">),</span> <span class="c1"># high r^2 (.79)</span>
        <span class="p">(</span><span class="mi">119</span><span class="p">,</span><span class="mi">151</span><span class="p">),</span> <span class="c1"># medium r^2 (.46)</span>
        <span class="p">(</span><span class="mi">120</span><span class="p">,</span><span class="mi">188</span><span class="p">),</span> <span class="c1"># very low r^2 (.04)</span>
    <span class="p">]</span>
    <span class="n">check_fit</span><span class="p">(</span>
        <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;envisat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">),</span>
        <span class="n">ds_reduced</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span> <span class="n">satellite</span><span class="o">=</span><span class="n">sat</span><span class="p">),</span>
        <span class="n">points_ij</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sat</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="n">projection</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_fit_cryosat2</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">ds_reduced</span><span class="p">,</span> <span class="n">projection</span><span class="p">):</span>
    <span class="n">sat</span> <span class="o">=</span> <span class="s2">&quot;CryoSat-2&quot;</span>
    <span class="n">month</span> <span class="o">=</span> <span class="s2">&quot;February&quot;</span>
    <span class="n">points_ij</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="mi">158</span><span class="p">),</span> <span class="c1"># higher r^2 (.58)</span>
        <span class="p">(</span><span class="mi">155</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="c1"># moderate r^2 (.37)</span>
        <span class="p">(</span><span class="mi">120</span><span class="p">,</span><span class="mi">190</span><span class="p">),</span> <span class="c1"># low r^2 (.04)</span>
    <span class="p">]</span>
    <span class="n">check_fit</span><span class="p">(</span>
        <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;cryosat_2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">),</span>
        <span class="n">ds_reduced</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span> <span class="n">satellite</span><span class="o">=</span><span class="n">sat</span><span class="p">),</span>
        <span class="n">points_ij</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sat</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">projection</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-and-transform-the-data">
<span id="satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-2"></span><h3>2. Download and transform the data<a class="headerlink" href="#download-and-transform-the-data" title="Link to this heading">#</a></h3>
<p>This is where the data is downloaded, transformed using <code class="docutils literal notranslate"><span class="pre">monthly_weighted_linear_trend</span></code> and saved to disk by the EQC toolbox. If the code is rerun the transformed data is loaded from the disk.
The transformed data is then post-processed by <code class="docutils literal notranslate"><span class="pre">postprocess_dataset</span></code> after downloading or loading.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">datasets_reduced</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sat_names</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;envisat&quot;</span><span class="p">:</span> <span class="s2">&quot;ENVISAT&quot;</span><span class="p">,</span> <span class="s2">&quot;cryosat_2&quot;</span><span class="p">:</span> <span class="s2">&quot;CryoSat-2&quot;</span><span class="p">}</span>
<span class="k">for</span> <span class="n">satellite</span><span class="p">,</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">satellite</span><span class="p">)</span>
    <span class="n">datasets</span><span class="p">[</span><span class="n">satellite</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_time</span><span class="p">(</span><span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">))</span>
    <span class="n">datasets_reduced</span> <span class="o">+=</span> <span class="p">[</span><span class="n">get_stats</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="n">satellite</span><span class="p">])</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="p">[</span><span class="n">sat_names</span><span class="p">[</span><span class="n">satellite</span><span class="p">]])]</span>
<span class="n">ds_reduced</span> <span class="o">=</span> <span class="n">add_differences</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets_reduced</span><span class="p">,</span> <span class="s1">&#39;satellite&#39;</span><span class="p">))</span>
<span class="k">del</span> <span class="n">datasets_reduced</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="results">
<span id="satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-3"></span><h3>3. Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<p>In section <a class="reference internal" href="#satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-3-1"><span class="std std-ref">3.1 Temporal mean and variability, and difference between satellite periods</span></a> we plot monthly maps showing the mean, variability and RMS uncertainty of sea ice thickness for the two satellites, and also plot the difference between the means for the two satellites to get an idea of the change in thickness going from the earlier to the later period.</p>
<p>In section <a class="reference internal" href="#satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-3-2"><span class="std std-ref">3.2 Assessment of linear model for temporal variability</span></a>, we compute linear trends for the two satellites and test the goodness-of-fit of the linear fit.</p>
<section id="temporal-mean-and-variability-and-difference-between-satellite-periods">
<span id="satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-3-1"></span><h4>3.1 Temporal mean and variability, and difference between satellite periods<a class="headerlink" href="#temporal-mean-and-variability-and-difference-between-satellite-periods" title="Link to this heading">#</a></h4>
<p>Below we show the mean sea ice thickness for the two satellites ENVISAT (2002-2010) and CryoSat-2 (2010-2020), along with the difference between them.
The thickness in the CryoSat-2 product is higher at the coast north of Greenland and Canada and this extends to around the North Pole in earlier winter and a bit further later in the winter.
This pattern is consistent with the pattern in the ENVISAT thickness, but much of the area of interest is obscured by the large polar hole in that product.
However, looking at the difference in the means, there is a slight drop in thickness in the overlapping areas of thicker ice.
In general the mean thickness has dropped, with the exception of the area north of the Canadian archipelago (adjacent to the overlapping area of thicker ice) and in the Greenland Sea in the later winter months.</p>
<p>The two satellites have different biases (CryoSat-2 has a slight positive bias, while ENVISAT has a more significant negative bias) and accuracies so we should be be a little careful when comparing and trying to deduce temporal changes between them.
Given the satellite biases we can trust the reductions in thickness more than the increases in thickness. Moreover the increases in thickness also occur in regions of higher variability (plotted after the means and the difference in the means). Having said this we have used an 8-10 year averaging period so some of the variability will have been smoothed out.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kw_mean</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">})</span>
<span class="n">kw_diff</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">.75</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">.75</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mf">.04</span><span class="p">,</span> <span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">},</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">)</span>
<span class="n">month_sets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;November&quot;</span><span class="p">,</span> <span class="s2">&quot;December&quot;</span><span class="p">,</span> <span class="s2">&quot;January&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;February&quot;</span><span class="p">,</span> <span class="s2">&quot;March&quot;</span><span class="p">,</span> <span class="s2">&quot;April&quot;</span><span class="p">],</span>
<span class="p">]</span>
<span class="k">for</span> <span class="n">months</span> <span class="ow">in</span> <span class="n">month_sets</span><span class="p">:</span>
    <span class="n">plot_maps</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">[</span><span class="s2">&quot;mean_thickness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">months</span><span class="p">),</span> <span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_mean</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">plot_maps</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">[</span><span class="s2">&quot;diff_mean_thickness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">months</span><span class="p">),</span> <span class="n">projection</span><span class="p">,</span><span class="o">**</span><span class="n">kw_diff</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/2a57bacc34ba6c2d6a04949c1f652189a237b27de70baa0e55fba24d05972986.png" src="../../_images/2a57bacc34ba6c2d6a04949c1f652189a237b27de70baa0e55fba24d05972986.png" />
<img alt="../../_images/aa24eafc808e1c0d3102a7238f668e8dfa6d094de59b31ced14d219cf6c87961.png" src="../../_images/aa24eafc808e1c0d3102a7238f668e8dfa6d094de59b31ced14d219cf6c87961.png" />
<img alt="../../_images/6984199bb95116d07958f5edcd4b68a1c5f7b462b4d37a5d7239177986b5b750.png" src="../../_images/6984199bb95116d07958f5edcd4b68a1c5f7b462b4d37a5d7239177986b5b750.png" />
<img alt="../../_images/370bfa82f82ed182442eda0838cac7b130beb575dedf93879f340012600e7ff2.png" src="../../_images/370bfa82f82ed182442eda0838cac7b130beb575dedf93879f340012600e7ff2.png" />
</div>
</div>
<p>Below we plot the standard deviations of the two satellite periods, and also the differences between them. For both the ENVISAT and the CryoSat-2 satellites, the variability is greatest in the areas with thicker and old ice, possibly since these areas are usually quite deformed due to ridging.
There is also high variability in the Greenland Sea, which is probably due in part to the highly dynamic nature of that area - the ice flows quite fast once it is exported through the Fram Strait. This exported ice can also be quite old and deformed with ridges which would also add to the variability. Looking at the differences, the variability has generally increased, with the exception of the area between the Beaufort Sea and the ENVISAT polar hole. This could be due to the higher resolution of the CryoSat-2 satellite, picking up smaller scale changes that ENVISAT cannot resolve, especially in regions of multi-year ice. CryoSat-2 also has less variability in the Labrador Sea Hudson bay from January to April, possibly since the ice there is generally more level, first-year ice.
Increased drift and deformation of the ice in latter years (<a class="reference external" href="https://doi.org/10.1029/2008JC005066" rel="noreferrer" target="_blank"><span style="color:blue">Rampal et al, 2009</span></a>) may also be a factor.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kw_std</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="mf">.75</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">})</span>
<span class="n">kw_diff</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">.25</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">.25</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mf">.04</span><span class="p">,</span> <span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">},</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">)</span>
<span class="k">for</span> <span class="n">months</span> <span class="ow">in</span> <span class="n">month_sets</span><span class="p">:</span>
    <span class="n">plot_maps</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">[</span><span class="s2">&quot;std_thickness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">months</span><span class="p">),</span> <span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_std</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">plot_maps</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">[</span><span class="s2">&quot;diff_std_thickness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">months</span><span class="p">),</span> <span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_diff</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a3725c73a018904a74a0ecc874a9abebaed222f8fda1d7b6d7b364a1a6f7ba94.png" src="../../_images/a3725c73a018904a74a0ecc874a9abebaed222f8fda1d7b6d7b364a1a6f7ba94.png" />
<img alt="../../_images/907d433e78d31472caff5ec49257367662922586f998552c9a88dbb0e3b9b1e7.png" src="../../_images/907d433e78d31472caff5ec49257367662922586f998552c9a88dbb0e3b9b1e7.png" />
<img alt="../../_images/679100d6df4d67bc039727e86506f84890a13ed561daec174e3a01922e75381f.png" src="../../_images/679100d6df4d67bc039727e86506f84890a13ed561daec174e3a01922e75381f.png" />
<img alt="../../_images/fe5ee91350638710e0d73a7a20d8f20ef9202717c34d991ca87d994e38eff1b1.png" src="../../_images/fe5ee91350638710e0d73a7a20d8f20ef9202717c34d991ca87d994e38eff1b1.png" />
</div>
</div>
<p>Below we plot the RMS uncertainties of the two satellite periods, and also the differences between them. As with the variability, for both the ENVISAT and the CryoSat-2 satellites, the variability is greatest in the areas with thicker and old ice. It is also higher in coastal areas, possibly from a combination of more deformed ice, more uncertain snowfall and reference sea surface height, and radar signal contamination from land. Again like the variability, there is quite high uncertainty in the Greenland Sea. The uncertainty increases markedly as the winter progresses, possibly due to the ice becoming more deformed, and maybe higher errors in snow depth as more snow accumulates. In addition, once there starts to be surface melt melt ponds also start to interfere with the radar signal, which could also be increasing the April uncertainty.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kw_unc</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="mf">.7</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">})</span>
<span class="n">kw_diff</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">.15</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">.15</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mf">.04</span><span class="p">,</span> <span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">},</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">)</span>
<span class="k">for</span> <span class="n">months</span> <span class="ow">in</span> <span class="n">month_sets</span><span class="p">:</span>
    <span class="n">plot_maps</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">[</span><span class="s2">&quot;rms_uncertainty&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">months</span><span class="p">),</span> <span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_unc</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">plot_maps</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">[</span><span class="s2">&quot;diff_rms_uncertainty&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">months</span><span class="p">),</span> <span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_diff</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/5a0298050e8900452d199c3c4cb52fe93e34e57d9196ae020ea10948a15f52b2.png" src="../../_images/5a0298050e8900452d199c3c4cb52fe93e34e57d9196ae020ea10948a15f52b2.png" />
<img alt="../../_images/7c05482a1e34826f019e9047e45bad1c86e18ce1cfd388bb9d56287b85601b8e.png" src="../../_images/7c05482a1e34826f019e9047e45bad1c86e18ce1cfd388bb9d56287b85601b8e.png" />
<img alt="../../_images/ac64f838731e71e32ef5c0c26f13a994ca3f5b7218755d08a2bee02d3b33c4f7.png" src="../../_images/ac64f838731e71e32ef5c0c26f13a994ca3f5b7218755d08a2bee02d3b33c4f7.png" />
<img alt="../../_images/6349c6911de77e1b9b5a588a246cd3867acbe5dfccbaa9ce5fa36c735c5f5570.png" src="../../_images/6349c6911de77e1b9b5a588a246cd3867acbe5dfccbaa9ce5fa36c735c5f5570.png" />
</div>
</div>
<p>Note that the uncertainties above do not include biases and other errors. In the evaluations done ENVISAT was found to have a significant low bias while CryoSat-2 had a small positive bias (see the <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-sea-ice-thickness/v3.0/WP2-FDDP-2022-09_C3S2-Lot3_PUGS-of-v3.0-SeaIceThickness-products_v3.1_Final.pdf" rel="noreferrer" target="_blank"><span style="color:blue">Product User Guide, p5)</span></a> for more details).</p>
</section>
<section id="assessment-of-linear-model-for-temporal-variability">
<span id="satellite-satellite-sea-ice-thickness-trend-assessment-q01-section-3-2"></span><h4>3.2 Assessment of linear model for temporal variability<a class="headerlink" href="#assessment-of-linear-model-for-temporal-variability" title="Link to this heading">#</a></h4>
<p>Before we show the trends and their goodness-of-fit statistics, we first plot maps showing the number of valid years for each pixel. The ENVISAT satellite generally has 8 valid years of data, with the exception of the marginal seas. CryoSat-2 has much less, possibly due to the smaller satellite footprint making it easier for the tracks to miss a given pixel. November/February/April mostly have 5/7/6 valid years, while other months have less than our minimum number of years (5). Hence we do not try to fit linear trends to October, December, January or March for the CryoSat-2 data.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_maps_valid_years</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">,</span> <span class="n">month_sets</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a79fb634ddb77f5ffedb4b2eb3fe6426f5858d386c1d1969fef992a95c1cb522.png" src="../../_images/a79fb634ddb77f5ffedb4b2eb3fe6426f5858d386c1d1969fef992a95c1cb522.png" />
<img alt="../../_images/6f0d8a531221a0af87df8f3251be463e1a132b483dc183519085767f958a935f.png" src="../../_images/6f0d8a531221a0af87df8f3251be463e1a132b483dc183519085767f958a935f.png" />
</div>
</div>
<p>For both satellite periods, we calcuated linear trends in sea ice thickness along with the goodness-of-fit statistices, the <span class="math notranslate nohighlight">\(r^2\)</span> and <span class="math notranslate nohighlight">\(p\)</span> values. The <span class="math notranslate nohighlight">\(r^2\)</span> statistic measures the fraction of the variability explained by the linear trends and it is generally quite low, with the exception of a region between the Beaufort Sea and the polar hole in the ENVISAT data. This region also had the most significant reduction in sea ice variability. The <span class="math notranslate nohighlight">\(p\)</span>-value gives the probability of the data being explained by random variability around a zero trend. It tells a similar story to the <span class="math notranslate nohighlight">\(r^2\)</span>-value, in that it is generally quite high, with the exception of the same region in the ENVISAT data that had the higher r<span class="math notranslate nohighlight">\(^2\)</span> value.</p>
<p>Below we plot the trend in the ENVISAT data for the month of February, along with the <span class="math notranslate nohighlight">\(r^2\)</span> and <span class="math notranslate nohighlight">\(p\)</span> values. The trend is about -10 cm/year in the region where the fit is acceptable. Other months are similar, in both the values and the region where the fit is acceptable. However, in general the linear fit to this data is explaining very little of the temporal variability.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_maps_trends</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">,</span> <span class="s2">&quot;ENVISAT&quot;</span><span class="p">,</span> <span class="s2">&quot;February&quot;</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/abb01262de836b266699e8708e23c115e3287404edd0572e0696aebb3f12d19b.png" src="../../_images/abb01262de836b266699e8708e23c115e3287404edd0572e0696aebb3f12d19b.png" />
</div>
</div>
<p>Below we show three examples of the linear fits, at the positions shown on the map.</p>
<p>The first point has a high value of <span class="math notranslate nohighlight">\(r^2\)</span> (0.79), and the fit is passing through all the error bars. It has a low <span class="math notranslate nohighlight">\(p\)</span>-value, so it is not well explained by random variations, but at the same time the behaviour is more of a step function than a linear decrease.</p>
<p>The second point has a borderline value of <span class="math notranslate nohighlight">\(r^2\)</span> (0.46) and <span class="math notranslate nohighlight">\(p\)</span>-value (6.6%), so it is starting to be more explained by random variations (a common threshold is 5%). Visually the fit is not very representative of the data, and maybe a step function would be a better fit.</p>
<p>The third point has a very low value of <span class="math notranslate nohighlight">\(r^2\)</span> and a high <span class="math notranslate nohighlight">\(p\)</span>-value or a high probability of being explained by random variability. With the exception of the first and last points, this series looks more like an increase followed by a decrease.
This example also shows the limitation of having such a short time series, in that removing possible outliers would leave very little data to work with.</p>
<p>In summary, for the ENVISAT data the region where linear fits are explaining a large fraction of the variability (as measured by <span class="math notranslate nohighlight">\(r^2\)</span>) is quite small, and even in those places a linear fit is still not overly convincing visually. The low number of data points also makes it hard to judge the fits visually.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">check_fit_envisat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">ds_reduced</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/7d0f8d1f58f16d4c1a056dbef1b1c9c86f5ea2514f23b49233e813d7609bcced.png" src="../../_images/7d0f8d1f58f16d4c1a056dbef1b1c9c86f5ea2514f23b49233e813d7609bcced.png" />
<img alt="../../_images/8d635459c71daf5c70d4c419f7e95d37f6ae2605a8d808b8d6014014f018de48.png" src="../../_images/8d635459c71daf5c70d4c419f7e95d37f6ae2605a8d808b8d6014014f018de48.png" />
</div>
</div>
<p>Below we plot the trend in the CryoSat-2 data for the months with enough data, along with the <span class="math notranslate nohighlight">\(r^2\)</span> and <span class="math notranslate nohighlight">\(p\)</span> values. The regions where <span class="math notranslate nohighlight">\(r^2\)</span> is reaching 0.5 and the <span class="math notranslate nohighlight">\(p\)</span> value is below 0.1 are quite small and less coherent than for the ENVISAT data.
In general we can again say that the linear fits to the thickness data are explaining very little of the temporal variability.
November has the largest area of higher <span class="math notranslate nohighlight">\(r^2\)</span> but the thickness in that month is more uncertain for physical reasons (the ice is still quite dynamic; leads and melt ponds may still be refreezing; new ice has lower freeboard so it is harder to measure) so we do not concentrate on that one.
Since melting is starting in April its thickness is also very uncertain, so we will now focus on the month of February, which also has the highest number of valid years (7).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">ds_reduced</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">[</span><span class="s2">&quot;linear_trend&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="s2">&quot;CryoSat-2&quot;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)))</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">plot_maps_trends</span><span class="p">(</span><span class="n">ds_reduced</span><span class="p">,</span> <span class="s2">&quot;CryoSat-2&quot;</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c8cb045c03e70540035c56cda2abb4fc6791c3dfc60edd289b0f1fa693c2e172.png" src="../../_images/c8cb045c03e70540035c56cda2abb4fc6791c3dfc60edd289b0f1fa693c2e172.png" />
<img alt="../../_images/be379a22f4c160ca0845f352ed89ea8700dce5180cdb0bec8a41e03ee34b8fc4.png" src="../../_images/be379a22f4c160ca0845f352ed89ea8700dce5180cdb0bec8a41e03ee34b8fc4.png" />
<img alt="../../_images/6539c48dd6b63e5247ba9b2cd6c2a6ba471210461dc1fc0fb7e5f47fa54bcee5.png" src="../../_images/6539c48dd6b63e5247ba9b2cd6c2a6ba471210461dc1fc0fb7e5f47fa54bcee5.png" />
</div>
</div>
<p>Below we show three examples of the linear fits to the CryoSat-2 data for the month of February, at the positions shown on the map.
The first point has a higher value of <span class="math notranslate nohighlight">\(r^2\)</span> (0.58), and a borderline <span class="math notranslate nohighlight">\(p\)</span>-value of 4.6%, so it is starting to have a significant chance of being explained by random variations.
The second point has a lower value of <span class="math notranslate nohighlight">\(r^2\)</span> (0.37), so it is explaining less than half of the variability, and the <span class="math notranslate nohighlight">\(p\)</span>-value has increased to 15%.
The third point has a very low value of <span class="math notranslate nohighlight">\(r^2\)</span> and a high <span class="math notranslate nohighlight">\(p\)</span>-value of 65%. While all of the fits are passing through all the error bars, it is difficult to decide visually if the fits are good ones due to the low number of points.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">check_fit_cryosat2</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">ds_reduced</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/d01abb83b57b4d6747347ac8ddaadc06570a78844dc8dda6fa7fa39f7cd78c95.png" src="../../_images/d01abb83b57b4d6747347ac8ddaadc06570a78844dc8dda6fa7fa39f7cd78c95.png" />
<img alt="../../_images/5fb38f82dd4d4ea031871e16d3ed2a94ce7d5b925cb912ef7feeaf032cec790a.png" src="../../_images/5fb38f82dd4d4ea031871e16d3ed2a94ce7d5b925cb912ef7feeaf032cec790a.png" />
</div>
</div>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Introductory sea ice materials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.epa.gov/climate-indicators/climate-change-indicators-arctic-sea-ice" rel="noreferrer" target="_blank"><span style="color:blue">Role of sea ice in the climate</span></a></p></li>
<li><p><a class="reference external" href="https://www.metoffice.gov.uk/research/climate/cryosphere-oceans/sea-ice/measure" rel="noreferrer" target="_blank"><span style="color:blue">Observing sea ice with satellites</span></a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank"><span style="color:blue">C3S EQC custom functions</span></a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank"><span style="color:blue">B-Open</span></a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Tilling, R. L., Ridout, A., &amp; Shepherd, A. (2018). Estimating Arctic sea ice thickness and volume using CryoSat-2 radar altimeter data. Advances in Space Research, 62(6), 1203-1225, <a class="reference external" href="https://doi.org/10.1016/j.asr.2017.10.051" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1016/j.asr.2017.10.051 </span></a>.</p></li>
<li><p>Müller, F. L., Paul, S., Hendricks, S., and Dettmering, D. (2023). Monitoring Arctic thin ice: a comparison between CryoSat-2 SAR altimetry data and MODIS thermal-infrared imagery. The Cryosphere, 17, 809–825, <a class="reference external" href="https://doi.org/10.5194/tc-17-809-2023" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.5194/tc-17-809-2023 </span></a>.</p></li>
<li><p>Rampal, P., J. Weiss, and D. Marsan (2009). Positive trend in the mean speed and deformation rate of Arctic sea ice, 1979–2007, J. Geophys. Res., 114, C05013, <a class="reference external" href="https://doi.org/10.1029/2008JC005066" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1029/2008JC005066 </span></a>.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Ocean"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="satellite_satellite-sea-ice-edge-type_intercomparison_q01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.6.2. </span>Intercomparison of satellite multi-year sea ice extent estimates</p>
      </div>
    </a>
    <a class="right-next"
       href="satellite_satellite-sea-level-global_trend-assessment_q01.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.6.4. </span>Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-assessing-the-suitability-of-satellite-sea-ice-thickness-data-for-studying-climate-change">🌍 Use case: Assessing the suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">1. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests">1.3 Define requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-functions">1.4 Post-processing functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-functions">1.5 Plotting functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-the-data">2. Download and transform the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-mean-and-variability-and-difference-between-satellite-periods">3.1 Temporal mean and variability, and difference between satellite periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#assessment-of-linear-model-for-temporal-variability">3.2 Assessment of linear model for temporal variability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>