
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.2. Consistency of carbon dioxide satellite observations for the evaluation of Earth system models. &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_consistency_q04';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.2.3. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring" href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html" />
    <link rel="prev" title="1.2.1. Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)" href="satellite_satellite-aerosol-properties_consistency_q01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Atmosphere_Physics/satellite_satellite-total-column-water-vapour-ocean_validation_q01.html">1.1.1. Water vapor amplification of Earth‚Äôs Greenhouse Effect</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-aerosol-properties_consistency_q01.html">1.2.1. Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.2. Consistency of carbon dioxide satellite observations for the evaluation of Earth system models.</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.3. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-carbon-dioxide_uncertainty-quality-flags_q02.html">1.2.4. Spatial and temporal completeness and uncertainties of carbon dioxide satellite observations for quantifying atmospheric greenhouse gas variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-methane_completeness_q03.html">1.2.5. Methane satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-methane_extremes-detection_q02.html">1.2.6. Spatial and temporal completeness of methane satellite observations for the analysis of extreme events related to large episodic releases</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-methane_uncertainty_q01.html">1.2.7. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.8. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_derived-gridded-glacier-mass-change_data-completeness_q01.html">1.3.1. Glacier mass change data from satellite and in-situ observations: uncertainty analysis for glaciological and climate change monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_derived-gridded-glacier-mass-change_trend-assessment_q02.html">1.3.2. Glacier mass change data from satellite and in-situ observations: resolution and coverage for trend analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_insitu-glaciers-extent_uncertainty_q01.html">1.3.3. Utility of the Randolph Glacier Inventory (RGI) for regional and global glacier volume estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-greenland-ice-sheet-velocity_trend-assessment_q01.html">1.3.4. Ice sheet velocity data from satellite observations: temporal and spatial coverage and data completeness for trend analysis in glaciological applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-greenland-ice-sheet-velocity_uncertainty_q02.html">1.3.5. Ice sheet velocity data from satellite observations: temporal and spatial variability of velocity-related uncertainties for glaciological applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_consistency-assessment_q02.html">1.3.6. Spatio-temporal data completeness and consistency of remote sensing-derived ice sheet surface elevation changes over Antarctica</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.7. Uncertainty of ice sheet surface elevation change¬†data over Greenland for volume and mass change trend assessments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-mass-balance_trend-assessment_q02.html">1.3.8. Gravimetric mass balance data from satellite observations: utility analysis for mass change monitoring of the ice sheets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-mass-balance_uncertainty_q01.html">1.3.9. Gravimetric mass changes from satellite data: assessment of resolution and uncertainty of Greenland ice sheet mass changes for glaciological applications</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Land_Hydrology/satellite_satellite-lake-water-level_climate-and-weather-extremes_q01.html">1.5.1. Lake Victoria‚Äôs 2020 Flood Event Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Land_Hydrology/satellite_satellite-lake-water-level_completeness_q02.html">1.5.2. Assessing Lake Titicaca‚Äôs water levels in support of water management</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-ocean-colour_completeness_q01.html">1.6.1. Completeness of ocean colour observations for biogeochemical models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.2. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.3. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.4. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.5. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.6. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.7. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_resolution_q06.html">4.3. Assessing the impact of spatial scale and temporal trends on seasonal forecast quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.4. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2¬∞C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2¬∞C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 experiment [climate (projections)]-[model-performance]-[scientific-study]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q12.html">5.1.12. Biases in temperature trends at different pressure levels using CMIP6 across latitudinal bands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q13.html">5.1.13. CMIP6 biases in the SPEI6 drought index over the Mediterranean region</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q06.html">5.2.6. CORDEX temperature biases over the Alpine region ‚Äî assessment using E-OBS and CERRA</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Derived_Datasets/derived_multi-origin-c3s-atlas_consistency_q01.html">7.1. Consistency between the C3S Atlas dataset and its origins: Case study</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Derived_Datasets/derived_multi-origin-c3s-atlas_consistency_q02.html">7.2. Consistency between the C3S Atlas dataset and its origins: Multiple indicators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Derived_Datasets/derived_multi-origin-c3s-atlas_consistency_q03.html">7.3. Consistency between the C3S Atlas dataset and its origins: Multiple origin datasets</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Applications/application_gttm_uncertainty_q01.html">8.1. Assessing global warming with the C3S Global Temperature Trend Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Applications/application_pulse_extreme-events_q01.html">8.2. Visualisation of temperature during extreme weather events with Climate Pulse</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_consistency_q04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_consistency_q04.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Consistency of carbon dioxide satellite observations for the evaluation of Earth system models.</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-for-evaluating-carbon-dioxide-growth-rates-and-seasonal-cycles-provided-by-earth-system-models">üåç Use case: Using satellite observations for evaluating carbon dioxide growth rates and seasonal cycles provided by Earth System Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-variable-of-interest">Define the variable of interest</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cache-needed-functions">Cache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data">2. Retrieve data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#obs4mips">2.1 Obs4MIPs</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis">3. Data analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-monthly-xco-2-data-coverage">Global maps of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xco-2-data-coverage-for-different-periods">Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage for different periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-growth-rate-and-seasonal-cycles">Calculation of growth rate and seasonal cycles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-the-seasonal-cycle-amplitude-sca">Calculation of the Seasonal Cycle Amplitude (SCA)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="consistency-of-carbon-dioxide-satellite-observations-for-the-evaluation-of-earth-system-models">
<h1><span class="section-number">1.2.2. </span>Consistency of carbon dioxide satellite observations for the evaluation of Earth system models.<a class="headerlink" href="#consistency-of-carbon-dioxide-satellite-observations-for-the-evaluation-of-earth-system-models" title="Link to this heading">#</a></h1>
<p>Production date: 20-01-2026</p>
<p>Produced by: Paolo Cristofanelli, Davide Putero (CNR)</p>
<section id="use-case-using-satellite-observations-for-evaluating-carbon-dioxide-growth-rates-and-seasonal-cycles-provided-by-earth-system-models">
<h2>üåç Use case: Using satellite observations for evaluating carbon dioxide growth rates and seasonal cycles provided by Earth System Models<a class="headerlink" href="#use-case-using-satellite-observations-for-evaluating-carbon-dioxide-growth-rates-and-seasonal-cycles-provided-by-earth-system-models" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Is the temporal consistency of the Level-3 Obs4MIPs merged dataset suitable for calculating changes in the annual growth rates of XCO‚ÇÇ and the amplitude of the seasonal cycles?</strong></p></li>
</ul>
<p>The most important anthropogenic greenhouse gas is carbon dioxide (CO<span class="math notranslate nohighlight">\(_2\)</span>), with CO<span class="math notranslate nohighlight">\(_2\)</span> emissions contributing 66% of the total radiative forcing by long-lived greenhouse gases <a class="reference external" href="https://library.wmo.int/idurl/4/69057" rel="noreferrer" target="_blank">[1]</a>. It is therefore important to monitor the long-term changes in atmospheric CO<span class="math notranslate nohighlight">\(_2\)</span> concentrations, to understand the sources and sinks of the atmospheric carbon content and to provide reliable projections of future CO<span class="math notranslate nohighlight">\(_2\)</span> concentrations under various scenarios.</p>
<p>Earth System Models (ESMs) are computer simulations that couple the physical climate (i.e. the atmosphere, the oceans and sea ice) with other components of the Earth, such as the land surface, vegetation, biogeochemistry (i.e. the carbon and nitrogen cycles), the cryosphere and, in some cases, human systems, in order to simulate how the entire Earth behaves now and in the future <a class="reference external" href="https://doi.org/10.5194/gmd-9-1937-2016" rel="noreferrer" target="_blank">[2]</a>. They are widely used, among other aims, to provide climate projections under different greenhouse gas and land use scenarios, to determine the contribution of human activities to observed changes or specific extreme events, to investigate biogeochemical cycles, and to inform mitigation pathways and climate risk analysis for policymakers.</p>
<p>In this assessment, we show how the column-averaged mixing ratios of CO<span class="math notranslate nohighlight">\(_2\)</span> (XCO<span class="math notranslate nohighlight">\(_2\)</span>) provided by the Obs4MIPs Level 3 data product of <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview" rel="noreferrer" target="_blank">[3]</a> can be used to evaluate the annual growth rates and seasonal cycles of CO<span class="math notranslate nohighlight">\(_2\)</span> provided by ESMs. Previous versions of this dataset have been already used to calculate global annual growth rates of CO<span class="math notranslate nohighlight">\(_2\)</span> (<a class="reference external" href="https://doi.org/10.5194/acp-18-17355-2018" rel="noreferrer" target="_blank">[4]</a>, <a class="reference external" href="https://doi.org/10.5194/amt-13-789-2020" rel="noreferrer" target="_blank">[5]</a>). These studies reported good agreement between growth rates derived from satellite data and those derived from surface observations by the National Oceanic and Atmospheric Administration (NOAA).</p>
<p>The Obs4MIPs Level 3 data product results from integrating XCO‚ÇÇ data from different combinations of satellite sensors and algorithms over time and space. Based on the results of references <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a> and independent analyses, we investigate the impact of changes in the sampling characteristics of the Obs4MIPs dataset on the ability to use it to evaluate the capacity of ESMs to reproduce CO‚ÇÇ seasonal cycle amplitudes and related trends/inter-annual variability, across its entire temporal coverage.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The Obs4MIPs Lev3 merged dataset is suitable for assessing the capacity of Earth System Models to reproduce CO‚ÇÇ growth rates and seasonal cycle variability, however the dataset features related to the spatial and temporal data coverage must be carefully considered (see points below).</p></li>
<li><p>For annual aggregation, high-latitude regions (i.e.. latitudes higher than 60¬∞N and 60¬∞S) should not be considered due to non-uniform data coverage across the different seasons.</p></li>
<li><p>The introduction of new satellite data (e.g., GOSAT in 2009 and OCO-2 in 2015) affects the data coverage at global scale with changing coverage of high latitude regions and oceans.</p></li>
<li><p>The months characterised by changes in the contributing satellite data can show inconsistent CO‚ÇÇ growth rates; however, this feature is averaged out when computing the annual growth.</p></li>
<li><p>Changes in data coverage over the period covered by the Obs4MIPs Level 3 dataset affect the calculation of the seasonal cycle amplitude.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>To assess if the temporal consistency of the Level-3 Obs4MIPs merged dataset from the Climate Data Store ‚ÄúCarbon dioxide data from 2002 to present derived from satellite observations‚Äù <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview" rel="noreferrer" target="_blank">[3]</a> is suitable for calculating changes in the annual growth rates of XCO<span class="math notranslate nohighlight">\(_2\)</span> and the amplitude of the seasonal cycles, we inspected a specific case study available from scientific literature  <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a> and we performed independent analyses. In particular, we analysed the changes of data coverage as a function of months and years, we calculated the monthly resolved CO<span class="math notranslate nohighlight">\(_2\)</span> annual growth rates and the annual seasonal cycles. To do that we used a methodology consistent with <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a>. However, we perform our analyses over the period 2003 - 2023 by using the most recent version (4.6) of the Level-3 Obs4MIPs merged dataset <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=567160605" rel="noreferrer" target="_blank">[7]</a>. This dataset is obtained by gridding the merged level-2 product generated with the ensemble median algorithm (XCO2_EMMA). EMMA combines several different XCO2 level-2 satellite data products: SCIAMACHY/Envisat (2003‚Äì2012), TANSO-FTS/GOSAT (2009‚Äì2022), OCO-2 (2014-2022), TANSO-FTS-2/GOSAT2 (2019-2023).</p>
<p><a class="reference external" href="https://doi.org/10.5194/acp-18-17355-2018" rel="noreferrer" target="_blank">[4]</a> used a previous version (O4Mv3) of the Level-3 Obs4MIPs merged data product available by the Climate Data Store to calulate the global atmospheric CO<span class="math notranslate nohighlight">\(_2\)</span> annual mean growth rates during 2003‚Äì2016 and to analyse the relative contributions of anthropogenic emissions and El Ni√±o Southern Oscillation (ENSO) to the observed growth rates. This study reported a  good agreement (mean difference‚Äâ¬±‚Äâstandard deviation: 0.0 ¬± 0.3‚Äâppm/year; R: 0.82)</p>
<p>More specifically, this notebook aims to:</p>
<ul class="simple">
<li><p>Generate global maps of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage, to show that the spatial coverage of data is not uniform across the different regions of the world for the different seasons.</p></li>
<li><p>Generate global maps of  XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage as a function of the different temporal periods covered by different satellite/sensors, i.e. SCIAMACHY/Envisat (2003‚Äì2012), TANSO-FTS/GOSAT (2009‚Äì2023), OCO-2 (2014-2023), TANSO-FTS-2/GOSAT2 (2019-2023).</p></li>
<li><p>To calculate the global annual growth rates of XCO<span class="math notranslate nohighlight">\(_2\)</span> and the seasonal cycle amplitudes for the entire measurement period 2003-2022.</p></li>
</ul>
<p>The analysis and results are organized in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-carbon-dioxide-consistency-q04-template-section-1"><span class="std std-ref">1. Choose the data to use and set-up the code</span></a></strong></p>
<ul class="simple">
<li><p>Import all relevant packages.</p></li>
<li><p>Select the variable of interest</p></li>
<li><p>Cache needed functions.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-carbon-dioxide-consistency-q04-template-section-2"><span class="std std-ref">2. Retrieve data</span></a></strong></p>
<ul class="simple">
<li><p>Define the data request to CDS.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-carbon-dioxide-consistency-q04-template-section-3"><span class="std std-ref">3. Data analysis</span></a></strong></p>
<p>This section presents several results for the XCO<span class="math notranslate nohighlight">\(_2\)</span> products, i.e.:</p>
<ul class="simple">
<li><p>The monthtly mean data coverage of XCO<span class="math notranslate nohighlight">\(_2\)</span> over the period 2002-2022.</p></li>
<li><p>The mean data coverage of XCO<span class="math notranslate nohighlight">\(_2\)</span> over specific time periods characterised by the use of observations from different satellites.</p></li>
<li><p>The calculation of the XCO<span class="math notranslate nohighlight">\(_2\)</span> growth rates and annual seasonal cycles by using an approach similar to that adopted by <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a>. Specifically, we computed monthly resolved annual growth rates by subtracting the XCO<span class="math notranslate nohighlight">\(_2\)</span> value 6 months in the future from the one 6 months in the past. Then these monthly resolved growth rates are averaged to a yearly GR for a calendar year. We calculated the annual seasonal cycled of global XCO<span class="math notranslate nohighlight">\(_2\)</span> by detrending the monthly time series with the cumulative sum of monthly growth rates, using the annual mean growth rates as substitution for missing values where necessary. Finally, we normalised the time series of detrended monthly values by subtracting the average seasonal cycle over the whole period 2003 - 2023. Spatial averages are calculated by taking the arithmetic averages over all grid cells weighted by their area.</p></li>
<li><p>Similarly to <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a>, we calculated of the annual seasonal cycle amplitudes (SCAs) as the peak-to-trough amplitude in a calendar year of the detrended time series. The SCA was calculated for a shorter time period (2004 ‚Äì 2022) with respect to the full available dataset (2003 - 2023), to avoid artefacts related to the fact that monthly growth rates were only available for six months in 2003 and 2023.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-carbon-dioxide-consistency-q04-template-section-1"></span><h3>1. Choose the data to use and set-up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-all-relevant-packages">
<h4>Import all relevant packages<a class="headerlink" href="#import-all-relevant-packages" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages needed for running the notebook and we define the style for plot appearance (‚Äúseaborn-v0_8-notebook‚Äù) as well as the style of hatches used in the maps.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span> <span class="c1">#to suppress warning</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="n">MaxNLocator</span><span class="p">,</span> <span class="n">FuncFormatter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/putero_davide/.cdsapirc&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;hatch.linewidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">download</span><span class="o">.</span><span class="n">INVALIDATE_CACHE</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#Set True to invalidate the caching</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span> <span class="c1">#To filter out warnings</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-the-variable-of-interest">
<h4>Define the variable of interest<a class="headerlink" href="#define-the-variable-of-interest" title="Link to this heading">#</a></h4>
<p>In this section, we define the parameters to be ingested by the code (that can be customized by the user), i.e.:</p>
<ul class="simple">
<li><p>the variable of interest.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose variable (xch4 or xco2)</span>
<span class="n">variable</span> <span class="o">=</span> <span class="s2">&quot;xco2&quot;</span>
<span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;xch4&quot;</span><span class="p">,</span> <span class="s2">&quot;xco2&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_nobs&quot;</span><span class="p">,</span> <span class="s2">&quot;_stderr&quot;</span><span class="p">,</span> <span class="s2">&quot;_stddev&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="cache-needed-functions">
<h4>Cache needed functions<a class="headerlink" href="#cache-needed-functions" title="Link to this heading">#</a></h4>
<p>In this section, we cached a list of functions used in the analyses.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">convert_units</span></code> function rescales XCO<span class="math notranslate nohighlight">\(_2\)</span> mole fraction to parts per million (ppm).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">compute_coverage</span></code> function calculates the spatial fractional coverage of the available data and creates associated maps.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">area_weighted_series</span></code> function calculates the spatial averages over all grid cells in a region. It uses spatial weighting to account for the latitudinal dependence of the grid size in the lon/lat grids.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">compute_GR_and_seasonal</span></code> funtion calculates the monthly resolved annual growth rates of XCO<span class="math notranslate nohighlight">\(_2\)</span> and the annual seasonal cycles.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_da</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">min_land_fraction</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span>
<span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)))</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_land_fraction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_fraction&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_land_fraction</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">da</span>

<span class="k">def</span><span class="w"> </span><span class="nf">convert_units</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_nobs&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">da</span>

    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xch4&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;ppb&quot;</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">*=</span> <span class="mf">1.0e9</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ppb&quot;</span>
        <span class="k">elif</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xco2&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;ppm&quot;</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">*=</span> <span class="mf">1.0e6</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ppm&quot;</span>
    <span class="k">return</span> <span class="n">da</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_coverage</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">missing_values</span><span class="o">=</span><span class="mf">1.0e20</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">da</span> <span class="o">!=</span> <span class="n">missing_values</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">/</span> <span class="n">da</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">area_weighted_series</span><span class="p">(</span><span class="n">xda</span><span class="p">,</span> <span class="n">weights2d</span><span class="p">):</span>
    <span class="c1"># numerator: sum over lat,lon of x * weight (ignore NaNs in x)</span>
    <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">xda</span> <span class="o">*</span> <span class="n">weights2d</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">xda</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">))</span>
    <span class="n">den</span> <span class="o">=</span> <span class="n">weights2d</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">xda</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">))</span>
    <span class="c1"># avoid division by zero</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">num</span> <span class="o">/</span> <span class="n">den</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ts</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_GR_and_seasonal</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    series: pandas.Series indexed by Timestamp (monthly)</span>
<span class="sd">    returns: monthly_GR (ppm/yr, pandas.Series), seasonal (ppm, pandas.Series)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># convert to xarray DataArray with time coords</span>
    <span class="n">s_xr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,))</span>
    <span class="c1"># compute GR: GR(m) = x(t+6) - x(t-6)</span>
    <span class="n">xco2_future</span> <span class="o">=</span> <span class="n">s_xr</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">xco2_past</span>   <span class="o">=</span> <span class="n">s_xr</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">time</span><span class="o">=+</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">monthly_GR</span> <span class="o">=</span> <span class="p">(</span><span class="n">xco2_future</span> <span class="o">-</span> <span class="n">xco2_past</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span>

    <span class="c1"># annual mean GR (used to substitute missing monthly GR)</span>
    <span class="n">yearly_GR</span> <span class="o">=</span> <span class="n">monthly_GR</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">monthly_GR</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># fill monthly GR missing with annual mean where possible</span>
    <span class="n">monthly_GR_filled</span> <span class="o">=</span> <span class="n">monthly_GR</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">yearly_GR</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">monthly_GR_filled</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">year</span>
            <span class="n">monthly_GR_filled</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly_GR_filled</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="c1"># monthly increment (ppm/month) from yearly GR</span>
    <span class="n">monthly_trend</span> <span class="o">=</span> <span class="n">monthly_GR</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">yearly_GR</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">monthly_trend</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">year</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">monthly_trend</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="mf">12.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">monthly_trend</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># cumulative trend (ppm)</span>
    <span class="n">trend</span> <span class="o">=</span> <span class="n">monthly_trend</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

    <span class="c1"># seasonal cycle: xco2 - cumulative trend ; center to zero mean</span>
    <span class="n">seasonal</span> <span class="o">=</span> <span class="n">series</span> <span class="o">-</span> <span class="n">trend</span>
    <span class="n">seasonal</span> <span class="o">=</span> <span class="n">seasonal</span> <span class="o">-</span> <span class="n">seasonal</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">monthly_GR</span><span class="p">,</span> <span class="n">seasonal</span>    
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="retrieve-data">
<span id="satellite-satellite-carbon-dioxide-consistency-q04-template-section-2"></span><h3>2. Retrieve data<a class="headerlink" href="#retrieve-data" title="Link to this heading">#</a></h3>
<section id="obs4mips">
<h4>2.1 Obs4MIPs<a class="headerlink" href="#obs4mips" title="Link to this heading">#</a></h4>
<p>In this section, we define the data request to CDS (data product Obs4MIPs, Level 3, version 4.5, XCO<span class="math notranslate nohighlight">\(_2\)</span>) and download the full dataset.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;satellite-carbon-dioxide&quot;</span> <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xco2&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;satellite-methane&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;processing_level&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;level_3&quot;</span><span class="p">],</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">variable</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;sensor_and_algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;merged_obs4mips&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;4_6&quot;</span><span class="p">],</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;zip&quot;</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="data-analysis">
<span id="satellite-satellite-carbon-dioxide-consistency-q04-template-section-3"></span><h3>3. Data analysis<a class="headerlink" href="#data-analysis" title="Link to this heading">#</a></h3>
<section id="global-maps-of-monthly-xco-2-data-coverage">
<h4>Global maps of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage<a class="headerlink" href="#global-maps-of-monthly-xco-2-data-coverage" title="Link to this heading">#</a></h4>
<p>In this section, we calculate and plot the mean monthly fractional coverage of data over the period 2003 - 2023. In agreement with the results by <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a>, the number of available observations depends significantly on the location with low data coverage values over locations typically affected by high cloud coverage (like tropics) and low Sun elevation (like high latitude in winter months). Coverage over ocean is sparse as ocean retrievals are included from GOSAT, OCO-2 and GOSAT2 Sun-glint mode observations. <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a> demonstrated that taking into account this sampling coverage feature is essential for a proper comparison with outputs from ESMs.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="o">*</span><span class="n">request</span><span class="p">)</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">compute_coverage</span><span class="p">)</span>
<span class="n">da</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="n">month</span><span class="p">]</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;XCO$_2$ Data Coverage&quot;</span><span class="p">}</span>
<span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
    <span class="n">da</span><span class="p">,</span>
    <span class="n">plot_func</span><span class="o">=</span><span class="s2">&quot;contourf&quot;</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span>
    <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greens&quot;</span><span class="p">,</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">},</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00,  3.36it/s]
</pre></div>
</div>
<img alt="../../_images/ba36bb1e2d38ee6a0487937fef80ba4113eada3be0334ad5331f57ebd6c0d414.png" src="../../_images/ba36bb1e2d38ee6a0487937fef80ba4113eada3be0334ad5331f57ebd6c0d414.png" />
</div>
</div>
<p><em>The figure shows the monthly fractional XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage from 2003 to 2023 derived from the XCO2_OBS4MIPS dataset (version 4.6).</em></p>
</section>
<section id="global-maps-of-xco-2-data-coverage-for-different-periods">
<h4>Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage for different periods<a class="headerlink" href="#global-maps-of-xco-2-data-coverage-for-different-periods" title="Link to this heading">#</a></h4>
<p>In this section, to assess the temporal consistency of spatial data coverage over the whole period covered by the Level-3 Obs4MIPs merged dataset, we calculate and plot the mean fractional coverage of CO<span class="math notranslate nohighlight">\(_2\)</span> data for time periods characterised by the contribution of different satellite observations: i.e., 2003 - 2008 (only SCIAMACHY observations), 2009 - 2011 (combination of SCIAMACHY and GOSAT), 2012 - 2014 (GOSAT), 2015 - 2018 (combination of GOSAT and OCO-2), 2019 - 2023 (combination of GOSAT, OCO-2 and GOSAT2). A comprehensive analysis of the number of soundings contained within the EMMA database on a monthly basis, along with the comparative contribution of each individual Level 2 algorithm to the EMMA database, can be found in <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=567160577" rel="noreferrer" target="_blank">[8]</a>.</p>
<p>Besides not including data over oceans, with respect to subsequent periods in which GOSAT measurements were used (2009 - 2011 and 2012 - 2014), for the period 2003 - 2008 more data are available for regions higher than 50¬∞N as well as over tropical regions in South America and Africa. The introduction of OCO-2 and GOSAT2 observations (2015 ‚Äì 2018 and 2019 ‚Äì 2023, respectively) resulted in an increase of the data coverage over Europe and the oceans. A substantial proportion of these regions exhibited data coverage levels exceeding 0.5, with the data extending to higher latitudes.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To define temporal coverage</span>
<span class="n">bins</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2003-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2009-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2015-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2019-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SCHIAMACHY (2003-2008)&quot;</span><span class="p">,</span> <span class="s2">&quot;SCHIAMACHY+GOSAT (2009-2011)&quot;</span><span class="p">,</span> <span class="s2">&quot;GOSAT (2012-2014)&quot;</span><span class="p">,</span> <span class="s2">&quot;GOSAT+OCO-2  (2015-2018)&quot;</span><span class="p">,</span><span class="s2">&quot;GOSAT+OCO-2+GOSAT2 (2019-2023)&quot;</span><span class="p">]</span>

<span class="n">interval_coord</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_index</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ds_1</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">interval_coord</span><span class="p">))</span>

<span class="c1"># To categorise data coverage as a function of time periods</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">ds_1</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">compute_coverage</span><span class="p">)</span>
<span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;XCO$_2$ Data Coverage&quot;</span><span class="p">}</span>

<span class="c1"># Plotting</span>
<span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
    <span class="n">da</span><span class="p">,</span>
    <span class="n">plot_func</span><span class="o">=</span><span class="s2">&quot;contourf&quot;</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">,</span>
    <span class="n">col_wrap</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greens&quot;</span><span class="p">,</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">},</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
    <span class="c1"># add custom labels</span>
    <span class="n">col_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">facet</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span> 

<span class="c1"># Add hatched pattern where coverage &gt; 0.5</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">subda</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;interval&quot;</span><span class="p">)):</span>
    <span class="c1"># convert to 2D array (lat, lon)</span>
    <span class="n">sub2d</span> <span class="o">=</span> <span class="n">subda</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="c1"># mask values &lt;=0.5</span>
    <span class="n">hatched</span> <span class="o">=</span> <span class="n">sub2d</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sub2d</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
        <span class="n">hatched</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">],</span>
        <span class="n">hatched</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">],</span>
        <span class="n">hatched</span><span class="p">,</span>
        <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">hatches</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;///&quot;</span><span class="p">],</span>
        <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
    
<span class="c1"># Adjust layout and move colorbar below all maps</span>
<span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.78</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">facet</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/5497558d064f7291847cbf8098218e6ad07ec0cc9e99729128e3246272f2c8c7.png" src="../../_images/5497558d064f7291847cbf8098218e6ad07ec0cc9e99729128e3246272f2c8c7.png" />
</div>
</div>
<p><em>The figure shows the monthly fractional XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage for different time periods characterised by the use of different satellites/sensors to obtain obervations. The hatched areas denote regions with data coverage higher than 0.5</em></p>
</section>
<section id="calculation-of-growth-rate-and-seasonal-cycles">
<h4>Calculation of growth rate and seasonal cycles<a class="headerlink" href="#calculation-of-growth-rate-and-seasonal-cycles" title="Link to this heading">#</a></h4>
<p>In this section, we calculate and report the time series of monthly global CO‚ÇÇ values, the resolved annual growth rate, and the seasonal cycles.
Over the period 2003‚Äì2014, our average growth rate of 2.02 ppm/year (with a standard deviation of 0.49 ppm/year) is in very good agreement with the values provided in <a class="reference external" href="https://doi.org/10.5194/acp-18-17355-2018" rel="noreferrer" target="_blank">[4]</a>. The calculated seasonal cycles also completely agree with those calculated in <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a> (1.9‚Äâ¬±‚Äâ0.4‚Äâppm/year), which report a clear change in shape and amplitude when GOSAT observations began contributing to the calculation of global CO‚ÇÇ in 2009. The low growth rate observed in 2009 is due to the introduction of GOSAT data, which altered the shape of the seasonal cycle. When considering only land-based data (orange lines), the low growth rate in 2009 disappears, and the seasonal cycles appear more consistent throughout the measurement period with an higher amplitude due to the higher carbon fluxes occurring over land regions than over oceans. This clearly shows that any changes to the sampling features that occur during the period covered by the dataset must be taken into account, particularly when evaluating uniform, gap-free datasets such as those provided by ESMs.
The high growth rate values observed in 2010, 2012, 2016, 2019 and 2023 are consistent with those reported by the in situ global network coordinated by <a class="reference external" href="https://library.wmo.int/idurl/4/69057" rel="noreferrer" target="_blank">[1]</a>, and are related to El Ni√±o conditions which favour net carbon emissions into the atmosphere on a global scale (see <a class="reference external" href="https://doi.org/10.5194/acp-25-13053-2025" rel="noreferrer" target="_blank">[9]</a> for a focus on the large growth rate on 2023).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Load dataset and basic preprocess</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="c1">#ds = download.download_and_transform(*request)</span>

<span class="c1"># Replace missing value 1.0e20 with NaN</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">1.0e20</span><span class="p">)</span>

<span class="c1"># Convert xco2 to ppm</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Prepare area weights (cos(lat)) as 2D DataArray (lat, lon)</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="n">lat_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">lat_weights_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_rad</span><span class="p">)</span>
<span class="n">weights_lat</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">lat_weights_1d</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]},</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,))</span>
<span class="n">ones_2d</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># shape (latitude, longitude)</span>
<span class="n">weights_2d_raw</span> <span class="o">=</span> <span class="n">weights_lat</span> <span class="o">*</span> <span class="n">ones_2d</span>            <span class="c1"># broadcast to (latitude, longitude)</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># land mask: keep only cells with land_fraction &gt; 0.5</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="n">land_mask</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_fraction&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span>  <span class="c1"># dims (latitude, longitude)</span>
<span class="c1"># weights masked</span>
<span class="n">weights_2d_masked</span> <span class="o">=</span> <span class="n">weights_2d_raw</span> <span class="o">*</span> <span class="n">land_mask</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Compute series for both cases: all gridcells and masked (land_fraction&gt;0.5)</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="n">x_all</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span>                     <span class="c1"># all points</span>
<span class="n">x_masked</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">land_mask</span><span class="p">)</span>  <span class="c1"># masked xco2 (NaN outside mask)</span>

<span class="c1"># area-weighted global series</span>
<span class="n">global_all_series</span> <span class="o">=</span> <span class="n">area_weighted_series</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span> <span class="n">weights_2d_raw</span><span class="p">)</span>
<span class="n">global_masked_series</span> <span class="o">=</span> <span class="n">area_weighted_series</span><span class="p">(</span><span class="n">x_masked</span><span class="p">,</span> <span class="n">weights_2d_masked</span><span class="p">)</span>

<span class="c1"># compute monthly GR and seasonal cycle for both</span>
<span class="n">monthly_GR_all</span><span class="p">,</span> <span class="n">seasonal_all</span> <span class="o">=</span> <span class="n">compute_GR_and_seasonal</span><span class="p">(</span><span class="n">global_all_series</span><span class="p">)</span>
<span class="n">monthly_GR_masked</span><span class="p">,</span> <span class="n">seasonal_masked</span> <span class="o">=</span> <span class="n">compute_GR_and_seasonal</span><span class="p">(</span><span class="n">global_masked_series</span><span class="p">)</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Quick diagnostics (optional prints)</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="c1">#print(&quot;Global (all) series length:&quot;, len(global_all_series.dropna()))</span>
<span class="c1">#print(&quot;Global (masked) series length:&quot;, len(global_masked_series.dropna()))</span>
<span class="c1">#print(&quot;Fraction positive GR (all):&quot;, (monthly_GR_all.dropna() &gt; 0).mean())</span>
<span class="c1">#print(&quot;Fraction positive GR (masked):&quot;, (monthly_GR_masked.dropna() &gt; 0).mean())</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Plotting: three vertical plots with both lines</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>
<span class="n">color_all</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">color_mask</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># (1) Global monthly mean XCO2</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">global_all_series</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">global_all_series</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">global_masked_series</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">global_masked_series</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Land_fraction &gt; 0.5&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;xco2 (ppm)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Global Monthly Mean XCO‚ÇÇ&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>

<span class="c1"># (2) Monthly Growth Rate (ppm/yr)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">monthly_GR_all</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">monthly_GR_all</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">monthly_GR_masked</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">monthly_GR_masked</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Land_fraction &gt; 0.5&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;GR (ppm/yr)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Monthly Growth Rate (GR)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>

<span class="c1"># add stats box for both series (means and stds)</span>
<span class="n">mean_all</span> <span class="o">=</span> <span class="n">monthly_GR_all</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_all</span> <span class="o">=</span> <span class="n">monthly_GR_all</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">mean_mask</span> <span class="o">=</span> <span class="n">monthly_GR_masked</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_mask</span> <span class="o">=</span> <span class="n">monthly_GR_masked</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">textstr</span> <span class="o">=</span> <span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;All: mean=</span><span class="si">{</span><span class="n">mean_all</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, std=</span><span class="si">{</span><span class="n">std_all</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;Mask: mean=</span><span class="si">{</span><span class="n">mean_mask</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, std=</span><span class="si">{</span><span class="n">std_mask</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
             <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">))</span>

<span class="c1"># (3) Seasonal Cycle (detrended)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seasonal_all</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">seasonal_all</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seasonal_masked</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">seasonal_masked</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Land_fraction &gt; 0.5&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Seasonal cycle (ppm)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Detrended Seasonal Cycle&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>

<span class="c1"># center y-axis of seasonal cycle around zero (symmetric limits) using both series combined</span>
<span class="n">combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">seasonal_all</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">seasonal_masked</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="k">if</span> <span class="n">combined</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># -------------------------</span>
<span class="c1"># Format x-axis to show integer years</span>
<span class="c1"># -------------------------</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>   <span class="c1"># one tick per year</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/8443b41ca1065ce930083f3c5e88df4c351a11eac6d9e2090ceaf4722388737b.png" src="../../_images/8443b41ca1065ce930083f3c5e88df4c351a11eac6d9e2090ceaf4722388737b.png" />
</div>
</div>
<p><em>The figure shows the global time series of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> mean values (upper panel), monthly resolved annual growth rate (middle panel) and detrended seasonal cycles (bottom panel) from 2003 to 2023. Blue lines indicate results for the whole dataset, orange lines indicate results for land-masked data.</em></p>
</section>
<section id="calculation-of-the-seasonal-cycle-amplitude-sca">
<h4>Calculation of the Seasonal Cycle Amplitude (SCA)<a class="headerlink" href="#calculation-of-the-seasonal-cycle-amplitude-sca" title="Link to this heading">#</a></h4>
<p>In this section, we show the time series of the annual global SCA calculated for the XCO<span class="math notranslate nohighlight">\(_2\)</span> variables for the whole dataset (blue) as well as for the land data (orange). Overall, the global SCA shows a decreasing trend over the period 2004 - 2022, however it should be pointed out that discontinuities exist at the time when new satellite observations were added to retrieve XCO<span class="math notranslate nohighlight">\(_2\)</span>: especially GOSAT in 2009 and OCO-2 in 2015. When the land data only are considered, the negative tendency diappeared from 2008 onward in agreement with the ESM simulations reported by <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------------------------------------------------------------</span>
<span class="c1"># Compute the SCA (peak-to-trough amplitude in each year, min 7 months of data)</span>
<span class="c1"># ---------------------------------------------------------------------</span>
<span class="n">sca_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dt_df</span> <span class="o">=</span> <span class="n">seasonal_all</span>

<span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">dt_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">dt_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">):</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">sca_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;SCA&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">valid</span><span class="o">.</span><span class="n">min</span><span class="p">()})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sca_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;SCA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">})</span>

<span class="n">sca_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sca_list</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>

<span class="n">sca_list_masked</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dt_df</span> <span class="o">=</span> <span class="n">seasonal_masked</span>

<span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">dt_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">dt_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">):</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">sca_list_masked</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;SCA&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">valid</span><span class="o">.</span><span class="n">min</span><span class="p">()})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sca_list_masked</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;SCA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">})</span>

<span class="n">sca_masked</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sca_list_masked</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>

<span class="c1">#------------------------------------------------------------------------------</span>
<span class="c1"># Plotting</span>
<span class="c1">#------------------------------------------------------------------------------</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># (1) SCA plot</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sca_all</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sca_all</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sca_all</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sca_all</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sca_masked</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sca_masked</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Land fraction &gt; 0.5&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sca_masked</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sca_masked</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Seasonal Cycle Amplitude (ppm)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Years&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2004</span><span class="p">,</span> <span class="mi">2022</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Global Monthly Mean XCO‚ÇÇ&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/8648baeaf496e367701a31704ac9b0bbd72624fca86a7b4d6d65036e205e4b9b.png" src="../../_images/8648baeaf496e367701a31704ac9b0bbd72624fca86a7b4d6d65036e205e4b9b.png" />
</div>
</div>
<p><em>The figure shows the annual time series of SCA from 2004 to 2022 for the whole dataset (blue) and for land-masked data (orange).</em></p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Carbon dioxide data from 2002 to present derived from satellite observations: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
<p>Users interested in accessing official C3S products about long term trends of greenhouse gases from satellite observations are encouraged to access specifically designed Copernicus resources like the <a class="reference external" href="https://climate.copernicus.eu/esotc/2024/trends-climate-indicators" rel="noreferrer" target="_blank">European State of Climate</a> or the <a class="reference external" href="https://climate.copernicus.eu/global-climate-highlights-2024" rel="noreferrer" target="_blank">Global Climate Highlights</a>.</p>
<p>Users interested in the investigation of CO<span class="math notranslate nohighlight">\(_2\)</span> fluxes can consider to use specifically designed Copernicus resources like <a class="reference external" href="https://ads.atmosphere.copernicus.eu/datasets/cams-global-greenhouse-gas-inversion?tab=overview" rel="noreferrer" target="_blank">CAMS global inversion-optimised greenhouse gas fluxes and concentrations</a>.</p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://library.wmo.int/idurl/4/69057" rel="noreferrer" target="_blank">[1]</a> World Meteorological Organization. (2024). WMO Greenhouse Gas Bulletin, 20, ISSN 2078-0796.</p>
<p><a class="reference external" href="https://doi.org/10.5194/gmd-9-1937-2016" rel="noreferrer" target="_blank">[2]</a> Eyring, V., Bony, S., Meehl, G. A., Senior, C. A., Stevens, B., Stouffer, R. J., and Taylor, K. E. (2016). Overview of the Coupled Model Intercomparison Project Phase 6 (CMIP6) experimental design and organization, Geoscience Model Development, 9, 1937‚Äì1958.</p>
<p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview" rel="noreferrer" target="_blank">[3]</a> Copernicus Climate Change Service, Climate Data Store. (2018). Carbon dioxide data from 2002 to present derived from satellite observations. Copernicus Climate Change Service (C3S) Climate Data Store (CDS) (Accessed on 30-Oct-2025).</p>
<p><a class="reference external" href="https://doi.org/10.5194/acp-18-17355-2018" rel="noreferrer" target="_blank">[4]</a> Buchwitz, M., Reuter, M., Schneising, O., No√´l, S., Gier, B., Bovensmann, H., Burrows, J. P., Boesch, H., Anand, J., Parker, R. J., Somkuti, P., Detmers, R. G., Hasekamp, O. P., Aben, I., Butz, A., Kuze, A., Suto, H., Yoshida, Y., Crisp, D., and O‚ÄôDell, C. (2018). Computation and analysis of atmospheric carbon dioxide annual mean growth rates from satellite observations during 2003‚Äì2016, Atmospheric Chemistry and Physics, 18, 17355‚Äì17370.</p>
<p><a class="reference external" href="https://doi.org/10.5194/amt-13-789-2020" rel="noreferrer" target="_blank">[5]</a> Reuter, M., Buchwitz, M., Schneising, O., No√´l, S., Bovensmann, H., Burrows, J. P., Boesch, H., Di Noia, A., Anand, J., Parker, R. J., Somkuti, P., Wu, L., Hasekamp, O. P., Aben, I., Kuze, A., Suto, H., Shiomi, K., Yoshida, Y., Morino, I., Crisp, D., O‚ÄôDell, C. W., Notholt, J., Petri, C., Warneke, T., Velazco, V. A., Deutscher, N. M., Griffith, D. W. T., Kivi, R., Pollard, D. F., Hase, F., Sussmann, R., T√©, Y. V., Strong, K., Roche, S., Sha, M. K., De Mazi√®re, M., Feist, D. G., Iraci, L. T., Roehl, C. M., Retscher, C., and Schepers, D. (2020). Ensemble-based satellite-derived carbon dioxide and methane column-averaged dry-air mole fraction data sets (2003‚Äì2018) for carbon and climate applications, Atmospheric Measurement Techniques, 13, 789‚Äì819.</p>
<p><a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[6]</a> Gier, B. K., Buchwitz, M., Reuter, M., Cox, P. M., Friedlingstein, P., and Eyring, V. (2020). Spatially resolved evaluation of Earth system models with satellite column-averaged CO2, Biogeosciences, 17, 6115‚Äì6144.</p>
<p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=567160605" rel="noreferrer" target="_blank">[7]</a> Reuter, M., Fuentes Andrade, B., Buchwitz, M. (2025). C3S Greenhouse Gas (GHG:CO2 &amp; CH4) v4.6: Product User Guide and Specification (PUGS), C3S2_313a_DLR_WP1-DDP-GHG-v1_PUGS_XGHG_v4.6.</p>
<p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=567160577" rel="noreferrer" target="_blank">[8]</a> Reuter, M., Fuentes Andrade, B., Buchwitz, M. (2025). C3S Greenhouse Gas (GHG: CO2 &amp; CH4) v4.6: Algorithm Theoretical Basis Document (ATBD), C3S2_313a_DLR_WP1-DDP-GHG-v1_ATBD_XGHG_v4.6.</p>
<p><a class="reference external" href="https://doi.org/10.5194/acp-25-13053-2025" rel="noreferrer" target="_blank">[9]</a> Feng, L., Palmer, P. I., Smallman, L., Xiao, J., Cristofanelli, P., Hermansen, O., Lee, J., Labuschagne, C., Montaguti, S., Noe, S. M., Platt, S. M., Ren, X., Steinbacher, M., and Xueref-Remy, I. (2025). The role of the tropical carbon balance in determining the large atmospheric CO2 growth rate in 2023, Atmospheric Chemistry and Physics, 25, 13053‚Äì13076.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="satellite_satellite-aerosol-properties_consistency_q01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2.1. </span>Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)</p>
      </div>
    </a>
    <a class="right-next"
       href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.2.3. </span>Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-for-evaluating-carbon-dioxide-growth-rates-and-seasonal-cycles-provided-by-earth-system-models">üåç Use case: Using satellite observations for evaluating carbon dioxide growth rates and seasonal cycles provided by Earth System Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-variable-of-interest">Define the variable of interest</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cache-needed-functions">Cache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data">2. Retrieve data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#obs4mips">2.1 Obs4MIPs</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis">3. Data analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-monthly-xco-2-data-coverage">Global maps of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xco-2-data-coverage-for-different-periods">Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage for different periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-growth-rate-and-seasonal-cycles">Calculation of growth rate and seasonal cycles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-the-seasonal-cycle-amplitude-sca">Calculation of the Seasonal Cycle Amplitude (SCA)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>