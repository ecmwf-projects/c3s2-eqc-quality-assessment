
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.1. Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023) &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-aerosol-properties_consistency_q01';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.2.2. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring" href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html" />
    <link rel="prev" title="1.2. Atmospheric Composition" href="Atmospheric_Composition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.1. Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.2. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-carbon-dioxide_uncertainty-quality-flags_q02.html">1.2.3. Spatial and temporal completeness and uncertainties of carbon dioxide satellite observations for quantifying atmospheric greenhouse gas variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-methane_uncertainty_q01.html">1.2.4. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.5. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_derived-gridded-glacier-mass-change_data-completeness_q01.html">1.3.1. Glacier mass change data from satellite and in-situ observations: uncertainty analysis for glaciological and climate change monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_consistency-assessment_q02.html">1.3.2. Spatio-temporal data completeness and consistency of remote sensing-derived ice sheet surface elevation changes over Antarctica</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.3. Uncertainty of ice sheet surface elevation change data over Greenland for volume and mass change trend assessments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-mass-balance_trend-assessment_q02.html">1.3.4. Gravimetric mass balance data from satellite observations: utility analysis for mass change monitoring of the ice sheets</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.2. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.3. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.5. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.6. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.3. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2°C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2°C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q12.html">5.1.12. Biases in temperature trends at different pressure levels using CMIP6 across latitudinal bands</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q06.html">5.2.6. CORDEX temperature biases over the Alpine region — assessment using E-OBS and CERRA</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-aerosol-properties_consistency_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-aerosol-properties_consistency_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-seasonal-variability-of-aod-from-satellite-observations">🌍 Use case: Seasonal Variability of AOD from Satellite Observations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">❓ Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-required-libraries">Import all required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-and-temporal-definitions">Spatial and temporal definitions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval-and-preparation">Data Retrieval and Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-aod-data">Download AOD data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#computation-of-time-series">Computation of time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-required-functions">Define required functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-the-results">Plot and describe the results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-map-plots-mean-aod-and-fm-aod">Global map plots: mean AOD and FM-AOD</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-of-subregions">Mapping of subregions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-aod-and-fm-aod-time-series-plots">Regional AOD and FM-AOD time series plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#observation-count-plot-for-aod550-averages">Observation count plot for AOD550 averages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plot-of-fine-mode-aod-vs-total-aod">Scatter plot of Fine Mode AOD vs total AOD</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-home-messages">Take-Home Messages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="assessment-of-seasonal-variability-and-completeness-of-aerosol-optical-depth-from-slstr-satellite-data-2017-2023">
<h1><span class="section-number">1.2.1. </span>Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)<a class="headerlink" href="#assessment-of-seasonal-variability-and-completeness-of-aerosol-optical-depth-from-slstr-satellite-data-2017-2023" title="Link to this heading">#</a></h1>
<p> </p>
<p>Production date: 30-09-2024</p>
<p>Produced by: Consiglio Nazionale delle Ricerche (<a class="reference external" href="https://www.cnr.it/en" rel="noreferrer" target="_blank">CNR</a>- Fabio Madonna and Faezeh Karimian.)</p>
<section id="use-case-seasonal-variability-of-aod-from-satellite-observations">
<h2>🌍 Use case: Seasonal Variability of AOD from Satellite Observations<a class="headerlink" href="#use-case-seasonal-variability-of-aod-from-satellite-observations" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-questions">
<h2>❓ Quality assessment questions<a class="headerlink" href="#quality-assessment-questions" title="Link to this heading">#</a></h2>
<p><strong>• Can satellite data consistently and homogeneously capture the seasonal variability of AOD in different parts of the world?</strong></p>
<p><strong>• Is the temporal coverage of aerosol satellite data sufficient to characterize the aerosol global distribution in the period 2017-2023?</strong></p>
<p>In the context of climate change and natural atmospheric variability, understanding the spatial and temporal distribution of aerosols is crucial for analyzing phenomena such as air quality, global warming, and public health. Seasonal variations in aerosols are influenced by numerous factors, including biological cycles, seasonal fires, desert dust, and industrial activities [1, 2, 3]. However, uncertainties in satellite data, stemming from limitations in temporal coverage and spatial resolution, could affect our ability to draw reliable conclusions [1].</p>
<p>This assessment uses the SLSTR aerosol ensemble product at Level-2 super-pixel resolution (10 × 10 km²), an uncertainty-weighted average of the SDVV, ORAC and Swansea retrievals, to evaluate its ability to consistently and homogeneously capture the seasonal variability of Aerosol Optical Depth (AOD) across different global regions. The central question we aim to answer is whether satellite data, despite their limitations and uncertainties, can accurately capture the atmospheric dynamics that influence the distribution of aerosols over the years [2, 4].</p>
<p>The dataset used in this study is the CDS (Climate Data Store) AOD product derived from SLSTR onboard Sentinel-3, providing monthly gridded AOD values at 550 nm at approximately 1° spatial resolution in NetCDF format, covering the period 2017–2023.</p>
<p>In summary, this study investigates whether SLSTR data can be reliably used to monitor the seasonal variability of AOD by comparing different geographic regions and assessing whether the spatial coverage is sufficient to characterize AOD distribution globally.</p>
<p>The results show that the satellite-derived AOD estimates are consistent with other findings reported in the literature [1, 4, 5] and are supported by a thorough scientific analysis. This consistency suggests that SLSTR data can be a robust tool for monitoring global aerosol distribution.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<p>• The SLSTR aerosol data exhibits consistency with other satellite-derived datasets, particularly in regions like Southern Africa and Southeast Asia [3, 6].</p>
<p>• Coarse-mode AOD trends over North Africa and the Mediterranean Basin align with findings from previous studies, such as Cuevas-Agulló et al. (2024), highlighting an increase in dust intrusions during 2020–2022 [2].</p>
<p>• The absence of data for several months in East Asia and Siberia restricts a full understanding of regional aerosol dynamics.</p>
<p>• A weaker correlation between Fine Mode AOD and Total AOD in regions like North Africa and India suggests the presence of varying aerosol types and the influence of mineral dust transport.</p>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This assessment aims to assess the consistency and completeness of SLSTR-derived satellite data in capturing the seasonal variability of Aerosol Optical Depth (AOD) over different global regions from 2017 to 2023.</p>
<p>The methodology adopted for the analysis is split into the following steps:</p>
<p><a class="reference internal" href="#satellite-satellite-aerosol-properties-consistency-q01-section-1"><span class="std std-ref">Choose the data to use and set up the code</span></a></p>
<ul class="simple">
<li><p>Import all required libraries</p></li>
<li><p>Spatial and temporal definitions</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-aerosol-properties-consistency-q01-section-2"><span class="std std-ref">Data Retrieval and Preparation</span></a></p>
<ul class="simple">
<li><p>Download AOD data</p></li>
<li><p>Computation of time series</p></li>
<li><p>Define required functions</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-aerosol-properties-consistency-q01-section-3"><span class="std std-ref">Plot and describe the results</span></a></p>
<ul class="simple">
<li><p>Prepare the dataframe</p></li>
<li><p>Global map plots: mean AOD and FM-AOD</p></li>
<li><p>Mapping of subregions</p></li>
<li><p>Regional AOD and FM-AOD time series plots</p></li>
<li><p>Observation count plot for AOD550 averages</p></li>
<li><p>Scatter plot of fine-mode AOD vs. total AOD</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-aerosol-properties-consistency-q01-section-4"><span class="std std-ref">Take-Home Messages</span></a></p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-aerosol-properties-consistency-q01-section-1"></span><h3>Choose the data to use and set up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-all-required-libraries">
<h4>Import all required libraries<a class="headerlink" href="#import-all-required-libraries" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages needed for running the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.cm</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">patches</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>  
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.mpl.gridliner</span><span class="w"> </span><span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="spatial-and-temporal-definitions">
<h4>Spatial and temporal definitions<a class="headerlink" href="#spatial-and-temporal-definitions" title="Link to this heading">#</a></h4>
<p>The analysis performed in this assessment focuses on data from July 2017 to June 2023, using monthly averages from the SLSTR sensor on Sentinel-3A. The regions are grouped into meaningful areas like North America, Europe, Africa, and Asia, each defined by specific latitude and longitude ranges. These subregions are color-coded for easy comparison in plots.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-07&quot;</span><span class="p">,</span>
    <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-06&quot;</span>
<span class="p">}</span>

<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_average&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;aerosol_optical_depth&quot;</span><span class="p">],</span>
    <span class="s2">&quot;sensor_on_satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;slstr_on_sentinel_3a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;ens&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2_3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span>
<span class="p">}</span>

<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-aerosol-properties&quot;</span>
<span class="n">requests</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
    <span class="n">request</span><span class="p">,</span>
    <span class="o">**</span><span class="n">time_dict</span><span class="p">,</span>
    <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Assign time dimension and compute means</span>

<span class="n">time_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2017-07-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2023-06-30&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span>

<span class="c1"># Optional color palette for consistency</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Western North America&quot;</span><span class="p">:</span> <span class="s2">&quot;#1f77b4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Eastern North America&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff7f0e&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Continental Europe&quot;</span><span class="p">:</span> <span class="s2">&quot;#2ca02c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Mediterranean Basin&quot;</span><span class="p">:</span> <span class="s2">&quot;#d62728&quot;</span><span class="p">,</span>
    <span class="s2">&quot;South America&quot;</span><span class="p">:</span> <span class="s2">&quot;#9467bd&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Southern Africa&quot;</span><span class="p">:</span> <span class="s2">&quot;#8c564b&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Indonesia&quot;</span><span class="p">:</span> <span class="s2">&quot;#e377c2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;North Africa (Sahara)&quot;</span><span class="p">:</span> <span class="s2">&quot;#7f7f7f&quot;</span><span class="p">,</span>
    <span class="s2">&quot;India&quot;</span><span class="p">:</span> <span class="s2">&quot;#bcbd22&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Siberia&quot;</span><span class="p">:</span> <span class="s2">&quot;#17becf&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Southeast Asia&quot;</span><span class="p">:</span> <span class="s2">&quot;#aec7e8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;East Asia&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffbb78&quot;</span><span class="p">,</span>
    <span class="s2">&quot;China&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff0000&quot;</span>
<span class="p">}</span>

<span class="c1"># Define subregions</span>
<span class="n">subregions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Northern Industrial Economies&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Western North America&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">100</span><span class="p">},</span>
        <span class="s2">&quot;Eastern North America&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">85</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">60</span><span class="p">},</span>
        <span class="s2">&quot;Continental Europe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">},</span>
        <span class="s2">&quot;Mediterranean Basin&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;Southern Biomass Burning&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;South America&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">56</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">35</span><span class="p">},</span>
        <span class="s2">&quot;Southern Africa&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">},</span>
        <span class="s2">&quot;Indonesia&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mi">95</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">140</span><span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;Dust Dominated Regions&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;North Africa (Sahara)&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">},</span>
        <span class="s2">&quot;India&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">90</span><span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;Asia&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Siberia&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">130</span><span class="p">},</span>
        <span class="s2">&quot;Southeast Asia&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mi">95</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">110</span><span class="p">},</span>
        <span class="s2">&quot;East Asia&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mi">110</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">135</span><span class="p">},</span>
        <span class="s2">&quot;China&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mi">125</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="data-retrieval-and-preparation">
<span id="satellite-satellite-aerosol-properties-consistency-q01-section-2"></span><h3>Data Retrieval and Preparation<a class="headerlink" href="#data-retrieval-and-preparation" title="Link to this heading">#</a></h3>
<p>In this step, the selected satellite data is downloaded using predefined time and variable settings. The data is then formatted to include a clear time coordinate, and average maps of key variables like AOD550 and FM_AOD550 are calculated over the full time period to prepare for analysis and visualization.</p>
<section id="download-aod-data">
<h4>Download AOD data<a class="headerlink" href="#download-aod-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="o">=</span><span class="n">collection_id</span><span class="p">,</span>
    <span class="n">requests</span><span class="o">=</span><span class="n">requests</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 72/72 [00:07&lt;00:00,  9.06it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt; Size: 75MB
Dimensions:                      (source: 72, latitude: 180, longitude: 360)
Coordinates:
  * source                       (source) object 576B &#39;148c29e9a49fd1261d149a...
  * latitude                     (latitude) float32 720B -89.5 -88.5 ... 89.5
  * longitude                    (longitude) float32 1kB -179.5 -178.5 ... 179.5
Data variables:
    AOD550                       (source, latitude, longitude) float32 19MB dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;
    FM_AOD550                    (source, latitude, longitude) float32 19MB dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;
    AOD550_UNCERTAINTY_ENSEMBLE  (source, latitude, longitude) float32 19MB dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;
    NMEAS                        (source, latitude, longitude) float32 19MB dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;
Attributes: (12/18)
    Conventions:               CF-1.6
    creator_email:             thomas.popp@dlr.de
    creator_name:              German Aerospace Center, DFD
    geospatial_lat_max:        90.0
    geospatial_lat_min:        -90.0
    geospatial_lon_max:        180.0
    ...                        ...
    sensor:                    SLSTR
    standard_name_vocabulary:  NetCDF Climate and Forecast (CF) Metadata Conv...
    summary:                   Level 3 aerosol properties retreived using sat...
    title:                     Ensemble aerosol product level 3
    tracking_id:               d79c7d5c-a788-11ee-9e43-0050569370b0
    version:                   v2.3
</pre></div>
</div>
</div>
</div>
</section>
<section id="computation-of-time-series">
<h4>Computation of time series<a class="headerlink" href="#computation-of-time-series" title="Link to this heading">#</a></h4>
<p>To analyze changes over time, a monthly time coordinate was created and assigned to the dataset. The data’s internal “source” dimension was replaced with this new time axis, allowing for clear temporal analysis. Then, the mean values of AOD550 and FM_AOD550 were calculated across the full time period, producing overall average maps for these key aerosol indicators.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assign time dimension and compute means</span>

<span class="n">time_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2017-07-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2023-06-30&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span>

<span class="c1"># Add time as a coordinate based on the &#39;source&#39; dimension</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="n">time_values</span><span class="p">))</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">})</span>


<span class="n">mean_aod</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;AOD550&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">mean_fm_aod</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;FM_AOD550&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[[</span><span class="s1">&#39;AOD550&#39;</span><span class="p">,</span> <span class="s1">&#39;FM_AOD550&#39;</span><span class="p">,</span> <span class="s1">&#39;AOD550_UNCERTAINTY_ENSEMBLE&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mf">999.0</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">NA</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AOD550&#39;</span><span class="p">,</span> <span class="s1">&#39;FM_AOD550&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[[</span><span class="s1">&#39;AOD550&#39;</span><span class="p">,</span> <span class="s1">&#39;FM_AOD550&#39;</span><span class="p">,</span><span class="s1">&#39;AOD550_UNCERTAINTY_ENSEMBLE&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-required-functions">
<h4>Define required functions<a class="headerlink" href="#define-required-functions" title="Link to this heading">#</a></h4>
<p>The following functions were defined to support the analysis of aerosol data:</p>
<p>The function “plot_global_map” creates a global map of AOD values, adding coastlines, borders, and gridlines for geographic context.</p>
<p>“plot_multi_series_aod” generates seasonal time series for each subregion, showing trends in AOD or fine-mode AOD, with uncertainty as a shading.</p>
<p>“plot_observation_counts_with_stats_on_plot” shows how many data points were used in each region per month, helping assess data coverage.</p>
<p>“scatter_fine_vs_total” creates scatter plots comparing total AOD with fine-mode AOD, including regression lines and R² values to reveal correlations across regions.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_global_map</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
        <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_subregion_domains</span><span class="p">(</span><span class="n">subregions</span><span class="p">):</span>
    <span class="n">all_regions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">bounds</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">subregions</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">bounds</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
 
    <span class="k">for</span> <span class="n">region_name</span><span class="p">,</span> <span class="n">bounds</span> <span class="ow">in</span> <span class="n">all_regions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_min&#39;</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_max&#39;</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_max&#39;</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_min&#39;</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_min&#39;</span><span class="p">]],</span>
            <span class="p">[</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">]],</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span>
        <span class="p">)</span>

        <span class="n">label_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_max&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">label_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">region_name</span> <span class="o">==</span> <span class="s2">&quot;Western North America&quot;</span><span class="p">:</span>
            <span class="n">label_x</span> <span class="o">-=</span> <span class="mi">7</span> 
            <span class="n">label_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># center vertically</span>
        <span class="k">elif</span> <span class="n">region_name</span> <span class="o">==</span> <span class="s2">&quot;Eastern North America&quot;</span><span class="p">:</span>
             <span class="n">label_x</span> <span class="o">+=</span> <span class="mi">7</span>  
             <span class="n">label_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># center vertically</span>

        <span class="k">elif</span> <span class="n">region_name</span> <span class="o">==</span> <span class="s2">&quot;China&quot;</span><span class="p">:</span>
            <span class="n">label_y</span> <span class="o">-=</span> <span class="mi">5</span>  

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">label_x</span><span class="p">,</span>
            <span class="n">label_y</span><span class="p">,</span>
            <span class="n">region_name</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_multi_series_aod</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">uncertainty_var</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="c1"># Collect all monthly means to find global y-limits</span>
    <span class="n">all_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">panel_title</span><span class="p">,</span> <span class="n">subregion_dict</span> <span class="ow">in</span> <span class="n">subregions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">region_name</span><span class="p">,</span> <span class="n">bounds</span> <span class="ow">in</span> <span class="n">subregion_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">region_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_min&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_max&#39;</span><span class="p">])</span>
            <span class="p">]</span>
            <span class="n">monthly_mean</span> <span class="o">=</span> <span class="n">region_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">all_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">monthly_mean</span><span class="p">)</span>

    <span class="c1"># Concatenate all monthly mean series and find min/max ignoring NaNs</span>
    <span class="n">all_concat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_values</span><span class="p">)</span>
    <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">all_concat</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">all_concat</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

    <span class="c1"># Optionally, add a small margin for visual comfort</span>
    <span class="n">y_margin</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span>
    <span class="n">ymin</span> <span class="o">-=</span> <span class="n">y_margin</span>
    <span class="n">ymax</span> <span class="o">+=</span> <span class="n">y_margin</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">panel_title</span><span class="p">,</span> <span class="n">subregion_dict</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subregions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">region_name</span><span class="p">,</span> <span class="n">bounds</span> <span class="ow">in</span> <span class="n">subregion_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">region_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_min&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_max&#39;</span><span class="p">])</span>
            <span class="p">]</span>
            <span class="n">monthly_mean</span> <span class="o">=</span> <span class="n">region_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">uncertainty_var</span><span class="p">:</span>
                <span class="n">monthly_uncertainty</span> <span class="o">=</span> <span class="n">region_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="n">uncertainty_var</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                    <span class="n">monthly_mean</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                    <span class="n">monthly_mean</span> <span class="o">-</span> <span class="n">monthly_uncertainty</span><span class="p">,</span>
                    <span class="n">monthly_mean</span> <span class="o">+</span> <span class="n">monthly_uncertainty</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">region_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">monthly_mean</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">monthly_mean</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">region_name</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">region_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">panel_title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>  <span class="c1"># Set consistent y-limits here</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">())</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_observation_counts_with_stats_on_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s1">&#39;AOD550&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mf">1e6</span><span class="p">):</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    
    <span class="n">all_regions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">bounds</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">subregions</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">bounds</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;tab20&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_regions</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">region_name</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_regions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">region_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_min&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_max&#39;</span><span class="p">])</span>
        <span class="p">]</span>
        <span class="n">obs_counts</span> <span class="o">=</span> <span class="n">region_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">obs_counts</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="n">obs_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Calculate area in km² and normalize</span>
        <span class="n">lat_span</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">]</span>
        <span class="n">lon_span</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_max&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_min&#39;</span><span class="p">]</span>
        <span class="n">region_area_km2</span> <span class="o">=</span> <span class="n">lat_span</span> <span class="o">*</span> <span class="n">lon_span</span> <span class="o">*</span> <span class="mi">111</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># approximate conversion</span>
        <span class="n">normalized_counts</span> <span class="o">=</span> <span class="n">obs_counts</span> <span class="o">/</span> <span class="n">region_area_km2</span> <span class="o">*</span> <span class="n">scale_factor</span>


        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs_counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">normalized_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">region_name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>


    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Normalized Observation Density (counts / </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">scale_factor</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> km²)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Optionally set upper limit to 100 if values exceed it</span>
    <span class="n">current_ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Y-axis limits before setting:&quot;</span><span class="p">,</span> <span class="n">current_ylim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">current_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Y-axis limits after setting:&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

       
<span class="k">def</span><span class="w"> </span><span class="nf">scatter_fine_vs_total</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">subregions</span><span class="p">,</span> <span class="n">variable_x</span><span class="o">=</span><span class="s1">&#39;AOD550&#39;</span><span class="p">,</span> <span class="n">variable_y</span><span class="o">=</span><span class="s1">&#39;FM_AOD550&#39;</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

    <span class="n">total_regions</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">subregions</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">total_regions</span> <span class="o">//</span> <span class="n">cols</span><span class="p">)</span>  <span class="c1"># Ceiling division</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">cols</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">rows</span><span class="p">))</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">panel</span><span class="p">,</span> <span class="n">region_set</span> <span class="ow">in</span> <span class="n">subregions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">region_name</span><span class="p">,</span> <span class="n">bounds</span> <span class="ow">in</span> <span class="n">region_set</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">region_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_min&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lat_max&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_min&#39;</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;lon_max&#39;</span><span class="p">])</span>
            <span class="p">]</span>
            <span class="n">grouped</span> <span class="o">=</span> <span class="n">region_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[[</span><span class="n">variable_x</span><span class="p">,</span> <span class="n">variable_y</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">grouped</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="n">variable_x</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="n">variable_y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">intercept_</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Monthly Mean&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;y = </span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">x + </span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s1">R² = </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Plot 1:1 line and set axis limits</span>
            <span class="n">min_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            <span class="n">max_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">],</span> <span class="p">[</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>  <span class="c1"># 1:1 line</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">region_name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;AOD550&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;FM_AOD550&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Remove any empty axes</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="plot-and-describe-the-results">
<span id="satellite-satellite-aerosol-properties-consistency-q01-section-3"></span><h3>Plot and describe the results<a class="headerlink" href="#plot-and-describe-the-results" title="Link to this heading">#</a></h3>
<section id="global-map-plots-mean-aod-and-fm-aod">
<h4>Global map plots: mean AOD and FM-AOD<a class="headerlink" href="#global-map-plots-mean-aod-and-fm-aod" title="Link to this heading">#</a></h4>
<p>The first map shows the mean Aerosol Optical Depth (AOD550) over the globe. Higher AOD values, shown in darker orange, are observed over regions with frequent dust storms (e.g. the Sahara), biomass burning (e.g. central Africa), and industrial pollution (e.g. parts of India and China).</p>
<p>The second map displays the mean Fine-mode AOD550, which focuses on smaller particles like smoke, urban pollution, and secondary aerosols, dominating aerosol loading over central Africa, Southeast Asia, and parts of South America. These areas associated with biomass burning and anthropogenic emissions.</p>
<p>Together, these plots help distinguish between regions dominated by coarse-mode aerosols (e.g. dust) and those with higher concentrations of fine-mode particles.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_global_map</span><span class="p">(</span><span class="n">mean_aod</span><span class="p">,</span> <span class="s2">&quot;Mean AOD550 (2017/07-2023/06)&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Oranges&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot_global_map</span><span class="p">(</span><span class="n">mean_fm_aod</span><span class="p">,</span> <span class="s2">&quot;Mean Fine-mode AOD550 (2017/07-2023/06)&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Purples&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/1f100930597a7aad45c33687de4e4a4b2fee2e20afe43b9fb04082d66749be38.png" src="../../_images/1f100930597a7aad45c33687de4e4a4b2fee2e20afe43b9fb04082d66749be38.png" />
<img alt="../../_images/517f1c6b5242bca9855b1f9875759629eb1834c9d6584a0966cd2a52100b81da.png" src="../../_images/517f1c6b5242bca9855b1f9875759629eb1834c9d6584a0966cd2a52100b81da.png" />
</div>
</div>
<p><em>Figure 1.</em> Global distribution of mean Aerosol Optical Depth (AOD550) and Fine-mode AOD550 from the SLSTR sensor onboard Sentinel-3A, averaged over the period July 2017 to June 2023.</p>
</section>
<section id="mapping-of-subregions">
<h4>Mapping of subregions<a class="headerlink" href="#mapping-of-subregions" title="Link to this heading">#</a></h4>
<p>This section defines the geographic boundaries of the subregions used for regional aerosol analysis. Each domain is represented as a simple rectangular box defined by latitude and longitude limits, enabling consistent spatial aggregation of Aerosol Optical Depth (AOD) data across different parts of the globe. The map visualizes these subregions to aid interpretation of subsequent regional time series and correlation analyses.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_subregion_domains</span><span class="p">(</span><span class="n">subregions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/b2142a0118470b9b7225f2263f0c598427d703e96eb04c2f8428cb42fe5a1ebf.png" src="../../_images/b2142a0118470b9b7225f2263f0c598427d703e96eb04c2f8428cb42fe5a1ebf.png" />
</div>
</div>
<p><em>Figure 2.</em> The spatial domains of the subregions used in the aerosol analysis. Each red rectangle represents the geographic boundaries defined by latitude and longitude for a specific subregion.</p>
</section>
<section id="regional-aod-and-fm-aod-time-series-plots">
<h4>Regional AOD and FM-AOD time series plots<a class="headerlink" href="#regional-aod-and-fm-aod-time-series-plots" title="Link to this heading">#</a></h4>
<p>The time series of 550 nm AOD monthly means from SLSTR satellite data refer to subregions selected because of the similarity in the observed aerosol types: Northern Industrial Economies, Southern Biomass Burning, Dust-Dominated Regions, and Asia. Each subplot includes shaded uncertainty areas (±1σ) quantifying AOD variability.
In the AOD550 plot, Northern industrial regions display often have AOD peaks in summertime, while, since 2020 the Mediterranean Basin shows high AOD levels throughout the year, strongly influenced by the mineral dust intrusion consistently with a documented enhancement of dust emissions in Northern Africa [4].
The FM_AOD550 is also reported showing that biomass burning regions, like Southern Africa, have peaks during dry periods typically dominated by forest fires [2, 3].</p>
<p>The observed data gaps in regions such as Siberia primarily arise from the inherent limitations of satellite aerosol retrievals in polar and subpolar areas. According to the Product User Guide (PUG), the SLSTR aerosol product has reduced temporal coverage in these high-latitude regions due to the absence of sunlight during extended winter periods, which prevents reliable satellite observations (Table 6, footnote 1). This sunlight dependency means that aerosol data cannot be retrieved when there is no solar illumination, resulting in missing data during polar night [7].</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_multi_series_aod</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;AOD550&quot;</span><span class="p">,</span>
    <span class="n">uncertainty_var</span><span class="o">=</span><span class="s2">&quot;AOD550_UNCERTAINTY_ENSEMBLE&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;AOD at 550 nm&quot;</span><span class="p">,</span>   
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c3d4cdadf8915ee98bd53de24c9d26b54bd60bda508d675e8a59d3bcf0118432.png" src="../../_images/c3d4cdadf8915ee98bd53de24c9d26b54bd60bda508d675e8a59d3bcf0118432.png" />
</div>
</div>
<p><em>Figure 3.</em> Monthly mean time series of total AOD at 550 nm from SLSTR for different sub-regions. Each panel shows regional time series with uncertainty as a shaded area (±1σ). Northern industrial regions show peaks in summer. The Mediterranean Basin maintains high AOD values year-round, especially in the period 2020-2022.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_multi_series_aod</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;FM_AOD550&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;FM_AOD at 550 nm&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/120dfb43f3a2ba5419e267b8edfb798f36c93239954c2f0cf6edbc166cee94e5.png" src="../../_images/120dfb43f3a2ba5419e267b8edfb798f36c93239954c2f0cf6edbc166cee94e5.png" />
</div>
</div>
<p><em>Figure 4.</em> Monthly mean time series of fine-mode AOD550 from SLSTR for selected global sub-regions. Fine mode aerosols include smoke, urban pollution, and secondary particles. Biomass burning regions like South America and Southern Africa show peaks during dry periods.</p>
</section>
<section id="observation-count-plot-for-aod550-averages">
<h4>Observation count plot for AOD550 averages<a class="headerlink" href="#observation-count-plot-for-aod550-averages" title="Link to this heading">#</a></h4>
<p>For assessing the spatial completeness of the data used in the time series analysis, this plot displays the normalized observation density, i.e., the number of valid AOD550 observations per 1,000,000 km², used each month to compute regional averages. Each line represents a distinct subregion, allowing visual comparison of data coverage over time, normalized by region size.</p>
<p>Most regions, such as South America, exhibit consistently high normalized observation densities, typically ranging from 60 to 80 counts per 1,000,000 km². In contrast, areas like Siberia show larger variability and lower density, implying a higher uncertainty for the derived monthly statistics and trend assessments.
The lower number of aerosol observations in Siberia is mainly due to its high-latitude location and harsh environmental conditions. As highlighted in the Product User Guide (PUG), satellite retrievals rely on sunlight, which is limited or absent during the extended polar night in winter months, reducing the temporal coverage in this region [7].</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_observation_counts_with_stats_on_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;AOD550&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/data/wp5/.tmp/ipykernel_1257448/4247846240.py:144: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed in 3.11. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap()`` or ``pyplot.get_cmap()`` instead.
  colors = cm.get_cmap(&#39;tab20&#39;, len(all_regions))
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Y-axis limits before setting: (np.float64(-4.058112166220274), np.float64(85.22035549062575))
Y-axis limits after setting: (np.float64(-4.058112166220274), np.float64(85.22035549062575))
</pre></div>
</div>
<img alt="../../_images/0c97408497f726bcd621e8dafc1c6cf7240fa9a03e46b5e0607f3ac17f0526b9.png" src="../../_images/0c97408497f726bcd621e8dafc1c6cf7240fa9a03e46b5e0607f3ac17f0526b9.png" />
</div>
</div>
<p><em>Figure 5.</em> Normalized observation density for each sub-region, showing the number of valid observations per 1,000,000 km² over time. The maximum normalized observation density reached approximately 85 counts / 1,000,000 km².</p>
</section>
<section id="scatter-plot-of-fine-mode-aod-vs-total-aod">
<h4>Scatter plot of Fine Mode AOD vs total AOD<a class="headerlink" href="#scatter-plot-of-fine-mode-aod-vs-total-aod" title="Link to this heading">#</a></h4>
<p>This figure shows a series of scatter plots comparing Fine Mode Aerosol Optical Depth (FM_AOD550) with Total AOD (AOD550) for each subregion, based on monthly averages. Each subplot includes a red regression line with its corresponding equation and R² value, indicating the strength of the linear relationship.
All regions display a high correlation, suggesting that fine-mode particles—such as smoke, continental aerosols, and anthropogenic pollution—contribute significantly to total aerosol loading.
Regions with smaller R² values, such as North Africa and India, indicate a greater contribution from coarse and giant particles to the total AOD.
These plots are useful for understanding regional differences in aerosol size and type, the latter known the local aerosol climatology.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scatter_fine_vs_total</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">subregions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f95b151390be0af5ed7eff236981b1dfae111778566d9bc96760524da682b506.png" src="../../_images/f95b151390be0af5ed7eff236981b1dfae111778566d9bc96760524da682b506.png" />
</div>
</div>
<p><em>Figure 6.</em>  Scatter plots of monthly mean Fine Mode Aerosol Optical Depth (FM_AOD550) versus Total Aerosol Optical Depth (AOD550) for selected global subregions. Each panel includes a linear regression line (in red) with the equation and coefficient of determination (R²) indicated. The black dashed line represents the 1:1 line, highlighting perfect agreement between the two variables.</p>
</section>
</section>
<section id="take-home-messages">
<span id="satellite-satellite-aerosol-properties-consistency-q01-section-4"></span><h3>Take-Home Messages<a class="headerlink" href="#take-home-messages" title="Link to this heading">#</a></h3>
<p>The current aerosol climatology shows substantial deviations from earlier studies [1]. Over North Africa and the Mediterranean Basin, a significant increase in mineral dust intrusions was observed during 2020–2022, as reported by Cuevas-Agulló et al. (2024). This increase is associated with enhanced activity of high-pressure systems over the Euro-Atlantic sector, which favour the obstruction of the westerlies and the occurrence of cut-off lows at subtropical latitudes.
During the same period, the coarse-mode AOD fraction increased over the Mediterranean, further confirming the influence of mineral dust transport due to the atmospheric circulation in the Mediterranean Basin.
The weaker correlation between fine-mode and total AOD reflects the greater contribution of coarse-mode particles, particularly dust, rather than inconsistencies in retrieval.
In the Northern Hemisphere, seasonal variability remains generally consistent across the selected regions, dominated by continental aerosols and anthropogenic pollution.
Strong seasonal peaks are also observed in:</p>
<ul class="simple">
<li><p>Southern Africa, where higher AOD values in the Southern hemisphere are consistent with the occurrence of forest fires during the dry austral season (Aug-Sep-Oct) [2, 3].</p></li>
<li><p>Southeast Asia, where AOD is influenced by local fires and aerosol transport from northern Australia [5].
In Siberia, several months of data are missing from the ensemble retrieval, making it difficult to assess seasonal variability.</p></li>
</ul>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key Resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>• Aerosol properties gridded data from 1995 to present derived from satellite observations:</p>
<p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-aerosol-properties?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-aerosol-properties?tab=overview</a></p>
<p>Code libraries used:</p>
<p>• C3S EQC custom function, c3s_eqc_automatic_quality_control, prepared by B-Open</p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p>[1] Remer, L. A., et al. (2008). Global aerosol climatology from the MODIS satellite sensors. Journal of Geophysical Research: Atmospheres, 113(D14S07). <a class="reference external" href="https://doi.org/10.1029/2007JD009661" rel="noreferrer" target="_blank">https://doi.org/10.1029/2007JD009661</a></p>
<p>[2] Nyasulu, M., Haque, M.M., Musonda, B. et al. The long-term spatial and temporal distribution of aerosol optical depth and its associated atmospheric circulation over Southeast Africa. Environ Sci Pollut Res 29, 30073–30089 (2022). <a class="reference external" href="https://doi.org/10.1007/s11356-021-18446-7" rel="noreferrer" target="_blank">https://doi.org/10.1007/s11356-021-18446-7</a></p>
<p>[3] Flamant, C., Chaboureau, J.-P., Gaetani, M., Schepanski, K., and Formenti, P.: The radiative impact of biomass burning aerosols on dust emissions over Namibia and the long-range transport of smoke observed during the Aerosols, Radiation and Clouds in southern Africa (AEROCLO-sA) campaign, Atmos. Chem. Phys., 24, 4265–4288, <a class="reference external" href="https://doi.org/10.5194/acp-24-4265-2024" rel="noreferrer" target="_blank">https://doi.org/10.5194/acp-24-4265-2024</a>, 2024.</p>
<p>[4] Cuevas-Agulló, E. et al. (2024). Sharp increase in Saharan dust intrusions over the western Euro-Mediterranean… <a class="reference external" href="https://doi.org/10.5194/acp-24-4083-2024" rel="noreferrer" target="_blank">https://doi.org/10.5194/acp-24-4083-2024</a></p>
<p>[5] Jin, S. et al. (2023). A comprehensive reappraisal of long-term aerosol characteristics… <a class="reference external" href="https://doi.org/10.5194/acp-23-8187-2023" rel="noreferrer" target="_blank">https://doi.org/10.5194/acp-23-8187-2023</a></p>
<p>[6] Garrigues, S., Remy, S., Chimot, J., Ades, M., Inness, A., Flemming, J., Kipling, Z., Laszlo, I., Benedetti, A., Ribas, R. and Jafariserajehlou, S., 2022. Monitoring multiple satellite aerosol optical depth (AOD) products within the Copernicus Atmosphere Monitoring Service (CAMS) data assimilation system. Atmospheric Chemistry and Physics Discussions, 2022, pp.1-80.</p>
<p>[7] Copernicus Climate Change Service (2021). Product User Guide and Specifications for Satellite Aerosol Properties (C3S2_312a_Lot2_DLR_2021SC1). Copernicus Climate Change Service. <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-aerosol-properties/C3S2_312a_Lot2_FDDP-AER/C3S2_312a_Lot2_D-WP2-FDDP-AER_202311_PUGS_AER_v2.0_final2.pdf" rel="noreferrer" target="_blank">https://dast.copernicus-climate.eu/documents/satellite-aerosol-properties/C3S2_312a_Lot2_FDDP-AER/C3S2_312a_Lot2_D-WP2-FDDP-AER_202311_PUGS_AER_v2.0_final2.pdf</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmospheric_Composition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
    </a>
    <a class="right-next"
       href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.2.2. </span>Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-seasonal-variability-of-aod-from-satellite-observations">🌍 Use case: Seasonal Variability of AOD from Satellite Observations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">❓ Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-required-libraries">Import all required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-and-temporal-definitions">Spatial and temporal definitions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval-and-preparation">Data Retrieval and Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-aod-data">Download AOD data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#computation-of-time-series">Computation of time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-required-functions">Define required functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-the-results">Plot and describe the results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-map-plots-mean-aod-and-fm-aod">Global map plots: mean AOD and FM-AOD</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-of-subregions">Mapping of subregions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-aod-and-fm-aod-time-series-plots">Regional AOD and FM-AOD time series plots</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#observation-count-plot-for-aod550-averages">Observation count plot for AOD550 averages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plot-of-fine-mode-aod-vs-total-aod">Scatter plot of Fine Mode AOD vs total AOD</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-home-messages">Take-Home Messages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>