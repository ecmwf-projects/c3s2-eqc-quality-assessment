
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.3. Spatial and temporal completeness and uncertainties of carbon dioxide satellite observations for quantifying atmospheric greenhouse gas variability &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_uncertainty-quality-flags_q02';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.2.4. Methane satellite observations uncertainty and completeness assessment for carbon cycle" href="satellite_satellite-methane_uncertainty_q01.html" />
    <link rel="prev" title="1.2.2. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring" href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-aerosol-properties_consistency_q01.html">1.2.1. Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.2. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.3. Spatial and temporal completeness and uncertainties of carbon dioxide satellite observations for quantifying atmospheric greenhouse gas variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-methane_uncertainty_q01.html">1.2.4. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.5. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_derived-gridded-glacier-mass-change_data-completeness_q01.html">1.3.1. Glacier mass change data from satellite and in-situ observations: uncertainty analysis for glaciological and climate change monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_consistency-assessment_q02.html">1.3.2. Spatio-temporal data completeness and consistency of remote sensing-derived ice sheet surface elevation changes over Antarctica</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.3. Uncertainty of ice sheet surface elevation change data over Greenland for volume and mass change trend assessments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-mass-balance_trend-assessment_q02.html">1.3.4. Gravimetric mass balance data from satellite observations: utility analysis for mass change monitoring of the ice sheets</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.2. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.3. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.5. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.6. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.3. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2°C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2°C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q12.html">5.1.12. Biases in temperature trends at different pressure levels using CMIP6 across latitudinal bands</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q06.html">5.2.6. CORDEX temperature biases over the Alpine region — assessment using E-OBS and CERRA</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_uncertainty-quality-flags_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_uncertainty-quality-flags_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Spatial and temporal completeness and uncertainties of carbon dioxide satellite observations for quantifying atmospheric greenhouse gas variability</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-for-quantifying-spatial-and-temporal-variability-in-carbon-dioxide-concentrations">🌍 Use case: Using satellite observations for quantifying spatial and temporal variability in carbon dioxide concentrations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-temporal-and-spatial-coverage-land-mask-and-spatial-regions-for-the-analysis">Define temporal and spatial coverage, land mask, and spatial regions for the analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cache-needed-functions">Cache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data">2. Retrieve data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#obs4mips">2.1 Obs4MIPs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zhang-et-al-2023-dataset">2.2 Zhang et al. (2023) dataset</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis-for-the-different-variables">3. Data analysis for the different variables</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xco-2-anomalies">Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xco-2-uncertainties">Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> uncertainties</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-maps-of-xco-2">Regional maps of XCO<span class="math notranslate nohighlight">\(_2\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-analysis-for-the-different-variables">Time series analysis for the different variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="spatial-and-temporal-completeness-and-uncertainties-of-carbon-dioxide-satellite-observations-for-quantifying-atmospheric-greenhouse-gas-variability">
<h1><span class="section-number">1.2.3. </span>Spatial and temporal completeness and uncertainties of carbon dioxide satellite observations for quantifying atmospheric greenhouse gas variability<a class="headerlink" href="#spatial-and-temporal-completeness-and-uncertainties-of-carbon-dioxide-satellite-observations-for-quantifying-atmospheric-greenhouse-gas-variability" title="Link to this heading">#</a></h1>
<p>Production date: 09-07-2025</p>
<p>Produced by: National Research Council of Italy - Institute of Atmospheric Sciences and Climate, Paolo Cristofanelli and Davide Putero</p>
<section id="use-case-using-satellite-observations-for-quantifying-spatial-and-temporal-variability-in-carbon-dioxide-concentrations">
<h2>🌍 Use case: Using satellite observations for quantifying spatial and temporal variability in carbon dioxide concentrations<a class="headerlink" href="#use-case-using-satellite-observations-for-quantifying-spatial-and-temporal-variability-in-carbon-dioxide-concentrations" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Are the XCO<span class="math notranslate nohighlight">\(_2\)</span> Level 3 data suitable for identifying regions characterized by high XCO<span class="math notranslate nohighlight">\(_2\)</span> values?</strong></p></li>
<li><p><strong>What are the uncertainties related to the XCO<span class="math notranslate nohighlight">\(_2\)</span> satellite observations?</strong></p></li>
</ul>
<p>Carbon dioxide (CO<span class="math notranslate nohighlight">\(_2\)</span>) is the most important anthropogenic greenhouse gas, accounting for nearly 64% of the total radiative forcing by long-lived greenhouse gases <a class="reference external" href="https://library.wmo.int/idurl/4/69057" rel="noreferrer" target="_blank">[1]</a>. The concentration of CO<span class="math notranslate nohighlight">\(_2\)</span> in the atmosphere in 2023 was 420.0<span class="math notranslate nohighlight">\(\,\pm\,\)</span>0.1 ppm <a class="reference external" href="https://library.wmo.int/idurl/4/69057" rel="noreferrer" target="_blank">[1]</a>. Monitoring the long-term CO<span class="math notranslate nohighlight">\(_2\)</span> variability is crucial for understanding the global carbon sources and sinks, improving <a class="reference external" href="https://doi.org/10.5194/essd-17-965-2025" rel="noreferrer" target="_blank">[2]</a> our knowledge of the carbon cycle, supporting the development of effective climate policies, and providing more reliable projections for future climate change.</p>
<p>In this assessment, we analyze the spatial variability of atmospheric column-averaged mixing ratios of CO<span class="math notranslate nohighlight">\(_2\)</span> (XCO<span class="math notranslate nohighlight">\(_2\)</span>) over different regions using the Level 3 XCO<span class="math notranslate nohighlight">\(_2\)</span> gridded data products (Obs4MIPs, version 4.5 <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[3]</a>), whose main application is related to the comparison and validation of global climate models (e.g., <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a>).</p>
<p>In particular, by comparison with an independent study based on a gap-free and fine-scale CO<span class="math notranslate nohighlight">\(_2\)</span> dataset <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a>, we assess the ability of this dataset to reproduce temporal and spatial anomalies in XCO<span class="math notranslate nohighlight">\(_2\)</span>, also quantifying the uncertainty provided with the dataset.</p>
<p>The code is included for transparency and to allow users to adapt it to their needs.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The XCO<span class="math notranslate nohighlight">\(_2\)</span> satellite observations (Level 3, Obs4MIPs, version 4.5) provide a  consistent global description of the spatial XCO<span class="math notranslate nohighlight">\(_2\)</span> pattern and can be used to detect areas characterized by elevated XCO<span class="math notranslate nohighlight">\(_2\)</span> values. Care should be excercised when considering data from regions affected by high uncertainties. The highest uncertainty values were found over high latitudes, the Himalayas and the tropical rainforest zone due to the occurrence of large solar zenith angles or frequent cloud cover.</p></li>
<li><p>The sampling characteristics of the dataset must be carefully considered when computing annual averages or anomalies, given the low or non-available data over high latitudes, especially during winter months.</p></li>
<li><p>As data availability and uncertainty are not constant over space and time, users are advised to consider the evolution of their values over the spatial regions and time periods of interest.</p></li>
<li><p>Users must be aware that the 5<span class="math notranslate nohighlight">\(^\circ\)</span>x5<span class="math notranslate nohighlight">\(^\circ\)</span> averaging can introduce a smoothing effect in the spatial XCO<span class="math notranslate nohighlight">\(_2\)</span> field with respect to the Level 2 datasets.</p></li>
<li><p>The main use of this data product is for comparison with climate models. Users interested in investigating the CO<span class="math notranslate nohighlight">\(_2\)</span> fluxes occurring at the Earth’s surface are advised to use products specifically designed for this purpose.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This notebook aims to provide users with information on the availability of XCO<span class="math notranslate nohighlight">\(_2\)</span> Level 3 products, both globally and for specific user-defined regions. Additionally, it offers insights into the uncertainties associated with XCO<span class="math notranslate nohighlight">\(_2\)</span> measurements and how these variables vary over time.</p>
<p>More specifically, this notebook aims to:</p>
<ul class="simple">
<li><p>Produce global maps of yearly XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies for comparison with an external dataset <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a>. Please note that, in order to minimise the impact of non-uniform spatial coverage over the different seasons of the Obs4MIPs data product <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[3]</a>, only data from 60°N to 60°S was considered in global spatial analyses. This approach is similar to that in <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a>.</p></li>
<li><p>Generate global maps for the corresponding XCO<span class="math notranslate nohighlight">\(_2\)</span> uncertainty (“xco2_stderr”).</p></li>
<li><p>Produce maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> for specific regions over land <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a>.</p></li>
<li><p>Create time series of selected XCO<span class="math notranslate nohighlight">\(_2\)</span> variables (“xco2”, “xco2_stderr” and “xco2_nobs”), for specific regions. Please note that this analysis can be customized by the user to include one additional variable (not shown here): “xco2_stddev”, which represents the standard deviation of the XCO<span class="math notranslate nohighlight">\(_2\)</span> Level 2 observations within each grid box.</p></li>
</ul>
<p>The analysis and results are organized in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-carbon-dioxide-uncertainty-quality-flags-q02-template-section-1"><span class="std std-ref">1. Choose the data to use and set-up the code</span></a></strong></p>
<ul class="simple">
<li><p>Import all relevant packages.</p></li>
<li><p>Define the temporal and spatial coverage, land mask, and spatial regions for the analysis.</p></li>
<li><p>Cache needed functions.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-carbon-dioxide-uncertainty-quality-flags-q02-template-section-2"><span class="std std-ref">2. Retrieve data</span></a></strong></p>
<ul class="simple">
<li><p>Define the data request to CDS.</p></li>
<li><p>Define the data request for the external dataset.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-carbon-dioxide-uncertainty-quality-flags-q02-template-section-3"><span class="std std-ref">3. Data analysis for the different variables</span></a></strong></p>
<p>This section presents several results for the XCO<span class="math notranslate nohighlight">\(_2\)</span> products, i.e.:</p>
<ul class="simple">
<li><p>Annual global maps of the XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies for 2015-2020 and comparison between CDS and the external dataset</p></li>
<li><p>Annual global maps of the XCO<span class="math notranslate nohighlight">\(_2\)</span> uncertainties for 2015-2020</p></li>
<li><p>A focus of the XCO<span class="math notranslate nohighlight">\(_2\)</span> maps over specific regions, and considering a single month (January 2016)</p></li>
<li><p>Global and regional time series of XCO<span class="math notranslate nohighlight">\(_2\)</span>, related uncertainties and data availability over the entire data period (2003-2022)</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-carbon-dioxide-uncertainty-quality-flags-q02-template-section-1"></span><h3>1. Choose the data to use and set-up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-all-relevant-packages">
<h4>Import all relevant packages<a class="headerlink" href="#import-all-relevant-packages" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages needed for running the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cacholote</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pooch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-paper&quot;</span><span class="p">)</span>

<span class="n">download</span><span class="o">.</span><span class="n">INVALIDATE_CACHE</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#Set True to invalidate the caching</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-temporal-and-spatial-coverage-land-mask-and-spatial-regions-for-the-analysis">
<h4>Define temporal and spatial coverage, land mask, and spatial regions for the analysis<a class="headerlink" href="#define-temporal-and-spatial-coverage-land-mask-and-spatial-regions-for-the-analysis" title="Link to this heading">#</a></h4>
<p>In this section, we define the parameters to be ingested by the code (that can be customized by the user), i.e.:</p>
<ul class="simple">
<li><p>the temporal period of analysis;</p></li>
<li><p>the activation/deactivation of the land masking;</p></li>
<li><p>the regions of interest;</p></li>
<li><p>the link to the external dataset.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single time to display</span>
<span class="n">time</span> <span class="o">=</span> <span class="s2">&quot;2016-01&quot;</span>

<span class="c1"># Range for 2015-2020</span>
<span class="n">time_range</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2015&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">)</span>

<span class="c1"># Mask</span>
<span class="n">min_land_fraction</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Use None to switch off</span>

<span class="c1"># Regions</span>
<span class="n">regions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;global&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)},</span>
    <span class="s2">&quot;global_subset&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">)},</span>
    <span class="s2">&quot;north_america&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">160</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">)},</span>
    <span class="s2">&quot;europe_africa&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">60</span><span class="p">)},</span>
    <span class="s2">&quot;east_asia&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mi">165</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">80</span><span class="p">)},</span>
<span class="p">}</span>

<span class="c1"># External data</span>
<span class="n">zhang_url</span> <span class="o">=</span> <span class="s2">&quot;https://zenodo.org/records/7721945/files/XCO2.zip?download=1&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="cache-needed-functions">
<h4>Cache needed functions<a class="headerlink" href="#cache-needed-functions" title="Link to this heading">#</a></h4>
<p>In this section, we cached a list of functions used in the analyses.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">convert_units</span></code> function rescales XCO<span class="math notranslate nohighlight">\(_2\)</span> mole fraction (and related variables, except “xco2_nobs”) to parts per million (ppm).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">mask_scale_and_regionalise</span></code> function extracts the XCO<span class="math notranslate nohighlight">\(_2\)</span> data over the selected spatial region. It uses spatial weighting to account for the latitudinal dependence of the grid size in the lon/lat grids used for the reanalysis and for the forecast models. It uses the <code class="docutils literal notranslate"><span class="pre">convert_units</span></code> function for rescaling the values to ppm, and it applies the threshold (if any) on the minimum land fraction.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_units</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_nobs&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">da</span>

    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xch4&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;ppb&quot;</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">=</span> <span class="n">da</span> <span class="o">*</span> <span class="mf">1.0e9</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ppb&quot;</span>
        <span class="k">elif</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xco2&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;ppm&quot;</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">=</span> <span class="n">da</span> <span class="o">*</span> <span class="mf">1.0e6</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ppm&quot;</span>
    <span class="k">return</span> <span class="n">da</span>


<span class="k">def</span><span class="w"> </span><span class="nf">mask_scale_and_regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">min_land_fraction</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">min_land_fraction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_fraction&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_land_fraction</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fill_value</span> <span class="o">:=</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;fill_value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">da</span> <span class="o">!=</span> <span class="n">fill_value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert_units</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="retrieve-data">
<span id="satellite-satellite-carbon-dioxide-uncertainty-quality-flags-q02-template-section-2"></span><h3>2. Retrieve data<a class="headerlink" href="#retrieve-data" title="Link to this heading">#</a></h3>
<section id="obs4mips">
<h4>2.1 Obs4MIPs<a class="headerlink" href="#obs4mips" title="Link to this heading">#</a></h4>
<p>In this section, we define the data request to CDS (data product Obs4MIPs, Level 3, version 4.5, XCO<span class="math notranslate nohighlight">\(_2\)</span>) and download the datasets (i.e., the 2015-2020 period, and the whole dataset).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-carbon-dioxide&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;processing_level&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;level_3&quot;</span><span class="p">],</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;xco2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sensor_and_algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;merged_obs4mips&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;4_5&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve the 2015-2020 dataset</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">regions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">mask_scale_and_regionalise</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;min_land_fraction&quot;</span><span class="p">:</span> <span class="n">min_land_fraction</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_range</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">)</span>
    <span class="n">datasets</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span>

<span class="c1"># Retrieve the whole dataset, for plotting the time series</span>
<span class="n">datasets_ts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">regions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">mask_scale_and_regionalise</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;min_land_fraction&quot;</span><span class="p">:</span> <span class="n">min_land_fraction</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">)</span>
    <span class="n">datasets_ts</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;global&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 27.82it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;global_subset&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 12.37it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;north_america&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 31.65it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;europe_africa&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 11.27it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;east_asia&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 43.42it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;global&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 34.60it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;global_subset&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 38.29it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;north_america&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00,  6.98it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;europe_africa&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 23.72it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;east_asia&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 44.67it/s]
</pre></div>
</div>
</div>
</div>
</section>
<section id="zhang-et-al-2023-dataset">
<h4>2.2 Zhang et al. (2023) dataset<a class="headerlink" href="#zhang-et-al-2023-dataset" title="Link to this heading">#</a></h4>
<p>In this section, we define the data request to the external dataset used for the comparison excercise.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">preprocess</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">band_data</span><span class="o">=</span><span class="s2">&quot;xco2&quot;</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%m&quot;</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">middle</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="n">middle</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dim</span>
    <span class="k">return</span> <span class="n">ds</span>


<span class="nd">@cacholote</span><span class="o">.</span><span class="n">cacheable</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_zhang_et_al</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">known_hash</span><span class="o">=</span><span class="s2">&quot;md5:22b4ac997247df9104fefefb3444926a&quot;</span><span class="p">):</span>
    <span class="n">fnames</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
        <span class="n">known_hash</span><span class="o">=</span><span class="n">known_hash</span><span class="p">,</span>
        <span class="n">processor</span><span class="o">=</span><span class="n">pooch</span><span class="o">.</span><span class="n">Unzip</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">fnames</span><span class="p">,</span> <span class="n">preprocess</span><span class="o">=</span><span class="n">preprocess</span><span class="p">)</span>
    <span class="p">(</span><span class="n">da</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">]:</span>
        <span class="n">da</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;xco2&quot;</span><span class="p">)</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">get_zhang_et_al</span><span class="p">(</span><span class="n">zhang_url</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_range</span><span class="p">)</span>
<span class="n">zhang_datasets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">regions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">zhang_datasets</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;global&#39;
region=&#39;global_subset&#39;
region=&#39;north_america&#39;
region=&#39;europe_africa&#39;
region=&#39;east_asia&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-analysis-for-the-different-variables">
<span id="satellite-satellite-carbon-dioxide-uncertainty-quality-flags-q02-template-section-3"></span><h3>3. Data analysis for the different variables<a class="headerlink" href="#data-analysis-for-the-different-variables" title="Link to this heading">#</a></h3>
<section id="global-maps-of-xco-2-anomalies">
<h4>Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies<a class="headerlink" href="#global-maps-of-xco-2-anomalies" title="Link to this heading">#</a></h4>
<p>In this section, global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies for the years 2015–2020 are presented for the latitudes spanning from 60°N to 60°S. The calculation of anomalies is achieved by the subtraction of the annual global average from the global XCO<span class="math notranslate nohighlight">\(_2\)</span> concentrations, in accordance with the approach outlined in <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a>. Prior to the execution of the calculations, a land mask was implemented. A comparison was made between the XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies from the Obs4MIPs (version 4.5) dataset and the results from the gap-free and fine-scale XCO<span class="math notranslate nohighlight">\(_2\)</span> dataset created by <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a>. Prior to the comparison, the external dataset was regridded to a 5° x 5° regular grid by means of an arithmetic unweighted averaging process.</p>
<p>Throughout all the considered years, regions within the 10<span class="math notranslate nohighlight">\(^\circ\,\)</span>S–40<span class="math notranslate nohighlight">\(^\circ\,\)</span>N latitude band exhibit positive XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies, consistent with the dataset produced by <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a>. Both datasets reported similar features in the interannual variability of XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies, like the higher values over China in 2020 compared to 2019, positive anomalies over Southeast Asia in 2016, and over tropical Africa in 2016, 2017 and 2018.</p>
<p>Focusing on the yearly bias (obtained by subtracting the Zhang et al. <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a> anomalies from the Obs4MIPs anomalies), the absolute differences in the yearly anomalies were mostly related to the high latitudes and the tropical regions. Please note that the horizontal coverage of the XCO2_OBS4MIPS dataset (version 4.5) extends approximately from 60<span class="math notranslate nohighlight">\(^\circ\,\)</span>S to 70<span class="math notranslate nohighlight">\(^\circ\,\)</span>N <a class="reference external" href="https://amt.copernicus.org/articles/13/789/2020/" rel="noreferrer" target="_blank">[6]</a>. Even though the XCO2_OBS4MIPS dataset was subsetted in this exercise to exclude high latitudes (i.e., higher than 60°N and 60°S), comparisons with the gap-free external dataset by Zhang et al. <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a> should be treated with extreme caution at latitudes above 50°N. This is due to non-uniform data coverage across different seasons for Obs4MIPs (version 4.5) at high latitudes, which can lead to sampling bias when data is aggregated on a yearly timescale. During the investigated period, the external dataset <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a> provided XCO<span class="math notranslate nohighlight">\(_2\)</span> also for Greenland, a region over which Obs4MIPs (version 4.5) did not provide data. This is due to the high surface albedo, which hinders the reliability of satellite retrievals, even during periods of illumination.</p>
<p>Moreover, the dataset <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a> appears to provide a smoother spatial field of XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies with respect to Obs4MIPs (version 4.5), probably due to the use of a learning machine algorithm to produce this gap filled dataset.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span> <span class="o">=</span> <span class="s2">&quot;xco2&quot;</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;global_subset&quot;</span><span class="p">]:</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">datasets</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Obs4MIPs&quot;</span><span class="p">]),</span>
            <span class="n">zhang_datasets</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Zhang et al.&quot;</span><span class="p">]),</span>
        <span class="p">],</span>
        <span class="s2">&quot;product&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">min_land_fraction</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s2">&quot;land_fraction&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_land_fraction</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">annual_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
    <span class="n">da_year</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span> <span class="o">-</span> <span class="n">da_year</span>
        <span class="n">bias</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;Obs4MIPs&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;Zhang et al.&quot;</span><span class="p">)</span>
        <span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bias&quot;</span><span class="p">])</span>
   
    <span class="c1"># Unisci tutti e 3 i set</span>
    <span class="n">da_all</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">da</span><span class="p">,</span> <span class="n">bias</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">)</span>

    <span class="c1"># Stack delle dimensioni (year, product) in &quot;panel&quot;</span>
    <span class="n">da_all</span> <span class="o">=</span> <span class="n">da_all</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">panel</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">))</span>

    <span class="c1"># Assegna etichette leggibili ai pannelli</span>
    <span class="n">panel_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">da_all</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">da_all</span> <span class="o">=</span> <span class="n">da_all</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">panel</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;panel&quot;</span><span class="p">,</span> <span class="n">panel_labels</span><span class="p">))</span>

    <span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">da_all</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;panel&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/44d7e28596d3aac4ad577984c2bde499e5bb60e56c1b81961f614d7796deb833.png" src="../../_images/44d7e28596d3aac4ad577984c2bde499e5bb60e56c1b81961f614d7796deb833.png" />
</div>
</div>
<p><em>The figure shows the multi-year global distribution of XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies (from 2015 to 2020) derived from the XCO2_OBS4MIPS dataset (version 4.5) as well as for the gap-filled dataset produced by Zhang et al. (2023) and the bias (Obs4MIPs - Zhang et al.) between the two datasets. Please be aware that the data displayed here includes only locations with latitudes below 60°N and 60°S.</em></p>
</section>
<section id="global-maps-of-xco-2-uncertainties">
<h4>Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> uncertainties<a class="headerlink" href="#global-maps-of-xco-2-uncertainties" title="Link to this heading">#</a></h4>
<p>In this section, we show the multi-year global maps of the XCO<span class="math notranslate nohighlight">\(_2\)</span> reported uncertainties, i.e., the “xco2_stderr” variable. This parameter is defined as the standard error of the average including single sounding noise and potential seasonal and regional biases <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[3]</a>. The yearly averages are calculated by averaging the monthly values provided by the considered dataset. Throughout all the considered years some features emerge, with higher uncertainties over high latitudes, the Himalayas, and the tropical rainforest zone, which are the regions where we observed larger deviations between Obs4MIPs (version 4.5) and the external dataset <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a>. This is mainly due to the sparseness in sampling because of frequent cloud cover, as well as large solar zenith angles in high latitudes, which is a challenge for accurate XCO<span class="math notranslate nohighlight">\(_2\)</span> retrievals <a class="reference external" href="https://amt.copernicus.org/articles/13/789/2020/" rel="noreferrer" target="_blank">[6]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;global&quot;</span><span class="p">]:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">region</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;xco2_stderr&quot;</span><span class="p">]:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">annual_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">])</span>
        <span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/246b8b08d7c1197c34373fc119d0791bb3f864277617f3b93b57f5aa1bb47df3.png" src="../../_images/246b8b08d7c1197c34373fc119d0791bb3f864277617f3b93b57f5aa1bb47df3.png" />
</div>
</div>
<p><em>The figure shows the multi-year global distribution of XCO<span class="math notranslate nohighlight">\(_2\)</span> standard error (from 2015 to 2020), derived from the XCO2_OBS4MIPS dataset (version 4.5).</em></p>
</section>
<section id="regional-maps-of-xco-2">
<h4>Regional maps of XCO<span class="math notranslate nohighlight">\(_2\)</span><a class="headerlink" href="#regional-maps-of-xco-2" title="Link to this heading">#</a></h4>
<p>In this section, we show the maps of the XCO<span class="math notranslate nohighlight">\(_2\)</span> values for January 2016, both globally and over specific regions. The selected regions (i.e., North America, Europe/Africa, and East Asia) were chosen according to <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a>. A direct comparison for January 2015 was not possible, as the Level 3 XCO<span class="math notranslate nohighlight">\(_2\)</span> data are missing for that month in the XCO2_OBS4MIPS dataset (version 4.5). The XCO<span class="math notranslate nohighlight">\(_2\)</span> patterns are similar and comparable, especially for Europe/Africa and East Asia. However, the Level 3 data cover lesser areas than the product in <a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a>, with missing data especially at latitudes above 50<span class="math notranslate nohighlight">\(^\circ\,\)</span>N.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To select specific regions</span>
<span class="n">selected_regions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;global_subset&quot;</span><span class="p">,</span> <span class="s2">&quot;north_america&quot;</span><span class="p">,</span> <span class="s2">&quot;europe_africa&quot;</span><span class="p">,</span><span class="s2">&quot;east_asia&quot;</span><span class="p">]</span>
<span class="n">filtered_datasets</span> <span class="o">=</span> <span class="p">{</span><span class="n">region</span><span class="p">:</span> <span class="n">ds</span> <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">selected_regions</span><span class="p">}</span>

<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]:</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
        <span class="mi">2</span><span class="p">,</span>
        <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_regions</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">filtered_datasets</span> <span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
    <span class="c1">#fig.suptitle(f&quot;{variable =} {time = }&quot;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/e22bc4fc693ca4e14c74f5f702391706feb944b2ccb88ebb389969c76664fc08.png" src="../../_images/e22bc4fc693ca4e14c74f5f702391706feb944b2ccb88ebb389969c76664fc08.png" />
</div>
</div>
<p><em>The figure shows the spatial distribution of XCO<span class="math notranslate nohighlight">\(_2\)</span> values over the globe and selected regions, derived from the XCO2_OBS4MIPS dataset (version 4.5), for January 2016.</em></p>
</section>
<section id="time-series-analysis-for-the-different-variables">
<h4>Time series analysis for the different variables<a class="headerlink" href="#time-series-analysis-for-the-different-variables" title="Link to this heading">#</a></h4>
<p>In this section, we show the time series for two XCO<span class="math notranslate nohighlight">\(_2\)</span> variables (i.e., “xco2” and “xco2_stderr”), considering both the entire dataset and specific regions of interest. For each variable, each plot displays the monthly spatial average for each region, along with the corresponding monthly standard deviation.
This analysis would provide the user with:</p>
<ul class="simple">
<li><p>the time series of XCO<span class="math notranslate nohighlight">\(_2\)</span> values (“xco2”) for each region, highlighting the positive trends;</p></li>
<li><p>the regional change over time of the uncertainties associated to the XCO<span class="math notranslate nohighlight">\(_2\)</span> values (“xco2_stderr”).</p></li>
<li><p>the time series of “xco2_nobs”, which denotes the number of individual XCO<span class="math notranslate nohighlight">\(_2\)</span> Level 2 observations used to compute the monthly Level 3 data.</p></li>
</ul>
<p>In particular, an increase in the uncertainties (“xco2_stderr”) is observed after 2009, likely due to the increase in the number of algorithms used to calculate the median XCO<span class="math notranslate nohighlight">\(_2\)</span> data <a class="reference external" href="http://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[7]</a>. A further increase in the uncertainties is observed from 2020 onwards, and this is probably linked to both the increase in the number of algorithms and the change in the minimum number of algorithms required to calculate the median XCO<span class="math notranslate nohighlight">\(_2\)</span> <a class="reference external" href="http://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[7]</a>. In addition, regions with more difficult retrieval conditions due to frequent cloud cover (e.g., East Asia) show larger uncertainties due to larger inter-algorithm spreads <a class="reference external" href="https://amt.copernicus.org/articles/13/789/2020/" rel="noreferrer" target="_blank">[6]</a>.</p>
<p>The temporal variability of “xco2_nobs” traces the changes over time of the input data availability, and the number of used algorithms to obtain the merged Level 2 data products (XCO2_EMMA), from which the Obs4MIPs data product is derived (please note that the standard deviations have not been reported for “xco2_nobs” in order to increase the plot’s readability.).
The first time period (up to April 2009) is characterised by a significant number of soundings by the SCIAMACHY sensor. The subsequent period (2009-September 2014) reflects the reduced number of single soundings provided by SCIAMACHY with the contribution from GOSAT. The following period, which extends up to 2019, reflects the contributions from both GOSAT and OCO-2. In contrast, the final period of the dataset reflects the contributions from GOSAT, OCO-2, and GOSAT-2. A comprehensive analysis of the number of soundings contained within the EMMA database on a monthly basis, along with the comparative contribution of each individual Level 2 algorithm to the EMMA database, can be found in <a class="reference external" href="http://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[7]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To select specific regions</span>
<span class="n">selected_regions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="s2">&quot;north_america&quot;</span><span class="p">,</span> <span class="s2">&quot;europe_africa&quot;</span><span class="p">,</span><span class="s2">&quot;east_asia&quot;</span><span class="p">]</span>
<span class="n">datasets_ts_filtered</span> <span class="o">=</span> <span class="p">{</span><span class="n">region</span><span class="p">:</span> <span class="n">ds</span> <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets_ts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">selected_regions</span><span class="p">}</span>

<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">,</span> <span class="s2">&quot;xco2_stderr&quot;</span><span class="p">,</span><span class="s2">&quot;xco2_nobs&quot;</span><span class="p">]:</span>
    <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">stds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets_ts_filtered</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
        <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">]))</span>
        <span class="n">stds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_std</span><span class="p">(</span><span class="n">da</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">]))</span>
    <span class="n">da_mean</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
    <span class="n">da_std</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">stds</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>

    <span class="n">facet</span> <span class="o">=</span> <span class="n">da_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">sel_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">facet</span><span class="o">.</span><span class="n">name_dicts</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;xco2_nobs&quot;</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="n">da_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span> <span class="o">-</span> <span class="n">da_std</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
            <span class="n">da</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
            <span class="n">lower</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">lower</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">da_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span> <span class="o">+</span> <span class="n">da_std</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="c1"># If variaable is xco2_nobs, use log scale for y-axis</span>
        <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;xco2_nobs&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
            <span class="c1">#ax.set_ylabel(&quot;n observations&quot;)</span>
            <span class="c1"># Imposta tick logaritmici automatici</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogLocator</span><span class="p">,</span> <span class="n">NullFormatter</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/05bba4e3648e78d11e74c01f2d54cb8271bc91d67133286e0b209dd93ffa9ead.png" src="../../_images/05bba4e3648e78d11e74c01f2d54cb8271bc91d67133286e0b209dd93ffa9ead.png" />
<img alt="../../_images/0bc5dacc6faf1152737e248d41a6145135d7597a22004a1ed4bc985720b8dc3f.png" src="../../_images/0bc5dacc6faf1152737e248d41a6145135d7597a22004a1ed4bc985720b8dc3f.png" />
<img alt="../../_images/94e3052acfd236aa568f0919294ce4c54af9badbc806667231b81522af360f97.png" src="../../_images/94e3052acfd236aa568f0919294ce4c54af9badbc806667231b81522af360f97.png" />
</div>
</div>
<p><em>The figure shows the monthly time series of XCO<span class="math notranslate nohighlight">\(_2\)</span> (top panels) and their associated uncertainties (middle panels) for the entire dataset, including global and regional analyses. The blue lines represent the monthly spatial average, while the shaded areas indicate <span class="math notranslate nohighlight">\(\pm\)</span>1 standard deviation. The bottom panels shows the time series of monthly spatial average of the  number of individual XCO<span class="math notranslate nohighlight">\(_2\)</span> Level 2 observations used to compute Obs4MIPs (Level 3) data. The main titles indicate the variable shown, while the subtitles specify the corresponding regions.</em></p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Carbon dioxide data from 2002 to present derived from satellite observations: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
<p>Users interested in the investigation of CO<span class="math notranslate nohighlight">\(_2\)</span> fluxes can consider to use specifically designed Copernicus resources like <a class="reference external" href="https://ads.atmosphere.copernicus.eu/datasets/cams-global-greenhouse-gas-inversion?tab=overview" rel="noreferrer" target="_blank">CAMS global inversion-optimised greenhouse gas fluxes and concentrations</a>.</p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://library.wmo.int/idurl/4/69057" rel="noreferrer" target="_blank">[1]</a> World Meteorological Organization. (2024). WMO Greenhouse Gas Bulletin, 20, ISSN 2078-0796.</p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-17-965-2025" rel="noreferrer" target="_blank">[2]</a> Friedlingstein, P., O’Sullivan, M., Jones, M. W., Andrew, R. M., Hauck, J., Landschützer, P., Le Quéré, C., Li, H., Luijkx, I. T., Olsen, A., Peters, G. P., Peters, W., Pongratz, J., Schwingshackl, C., Sitch, S., Canadell, J. G., Ciais, P., Jackson, R. B., Alin, S. R., Arneth, A., Arora, V., Bates, N. R., Becker, M., Bellouin, N., Berghoff, C. F., Bittig, H. C., Bopp, L., Cadule, P., Campbell, K., Chamberlain, M. A., Chandra, N., Chevallier, F., Chini, L. P., Colligan, T., Decayeux, J., Djeutchouang, L. M., Dou, X., Duran Rojas, C., Enyo, K., Evans, W., Fay, A. R., Feely, R. A., Ford, D. J., Foster, A., Gasser, T., Gehlen, M., Gkritzalis, T., Grassi, G., Gregor, L., Gruber, N., Gürses, Ö., Harris, I., Hefner, M., Heinke, J., Hurtt, G. C., Iida, Y., Ilyina, T., Jacobson, A. R., Jain, A. K., Jarníková, T., Jersild, A., Jiang, F., Jin, Z., Kato, E., Keeling, R. F., Klein Goldewijk, K., Knauer, J., Korsbakken, J. I., Lan, X., Lauvset, S. K., Lefèvre, N., Liu, Z., Liu, J., Ma, L., Maksyutov, S., Marland, G., Mayot, N., McGuire, P. C., Metzl, N., Monacci, N. M., Morgan, E. J., Nakaoka, S.-I., Neill, C., Niwa, Y., Nützel, T., Olivier, L., Ono, T., Palmer, P. I., Pierrot, D., Qin, Z., Resplandy, L., Roobaert, A., Rosan, T. M., Rödenbeck, C., Schwinger, J., Smallman, T. L., Smith, S. M., Sospedra-Alfonso, R., Steinhoff, T., Sun, Q., Sutton, A. J., Séférian, R., Takao, S., Tatebe, H., Tian, H., Tilbrook, B., Torres, O., Tourigny, E., Tsujino, H., Tubiello, F., van der Werf, G., Wanninkhof, R., Wang, X., Yang, D., Yang, X., Yu, Z., Yuan, W., Yue, X., Zaehle, S., Zeng, N., and Zeng, J. (2025). Global Carbon Budget 2024, Earth System Science Data, 17, 965-1039.</p>
<p><a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[3]</a> Buchwitz, M. (2024). Product User Guide and Specification (PUGS) – Main document for Greenhouse Gas (GHG: CO<span class="math notranslate nohighlight">\(_2\)</span> &amp; CH<span class="math notranslate nohighlight">\(_4\)</span>) data set CDR7 (01.2003-12.2022), C3S project 2021/C3S2_312a_Lot2_DLR/SC1, v7.3.</p>
<p><a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a> Gier, B. K., Buchwitz, M., Reuter, M., Cox, P. M., Friedlingstein, P., and Eyring, V. (2020). Spatially resolved evaluation of Earth system models with satellite column-averaged CO<span class="math notranslate nohighlight">\(_2\)</span>, Biogeosciences, 17, 6115–6144.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.envint.2023.108057" rel="noreferrer" target="_blank">[5]</a> Zhang, L., Li, T., Wu, J., and Yang, H. (2023). Global estimates of gap-free and fine-scale CO<span class="math notranslate nohighlight">\(_2\)</span> concentrations during 2014-2020 from satellite and reanalysis data, Environment International, 178, 108057.</p>
<p><a class="reference external" href="https://amt.copernicus.org/articles/13/789/2020/" rel="noreferrer" target="_blank">[6]</a> Reuter, M., Buchwitz, M., Schneising, O., Noël, S., Bovensmann, H., Burrows, J. P., Boesch, H., Di Noia, A., Anand, J., Parker, R. J., Somkuti, P., Wu, L., Hasekamp, O. P., Aben, I., Kuze, A., Suto, H., Shiomi, K., Yoshida, Y., Morino, I., Crisp, D., O’Dell, C. W., Notholt, J., Petri, C., Warneke, T., Velazco, V. A., Deutscher, N. M., Griffith, D. W. T., Kivi, R., Pollard, D. F., Hase, F., Sussmann, R., Té, Y. V., Strong, K., Roche, S., Sha, M. K., De Mazière, M., Feist, D. G., Iraci, L. T., Roehl, C. M., Retscher, C., and Schepers, D. (2020). Ensemble-based satellite-derived carbon dioxide and methane column-averaged dry-air mole fraction data sets (2003–2018) for carbon and climate applications, Atmospheric Measurement Techniques, 13, 789–819.</p>
<p><a class="reference external" href="http://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[7]</a> Reuter, M., and Buchwitz, M. (2024). Algorithm Theoretical Basis Document (ATBD) – ANNEX D for products XCO2_EMMA, XCH4_EMMA, XCO2_OBS4MIPS, XCH4_OBS4MIPS (v4.5, CDR7, 2003-2022), C3S project 2021/C3S2_312a_Lot2_DLR/SC1, v7.1b.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2.2. </span>Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</p>
      </div>
    </a>
    <a class="right-next"
       href="satellite_satellite-methane_uncertainty_q01.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.2.4. </span>Methane satellite observations uncertainty and completeness assessment for carbon cycle</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-for-quantifying-spatial-and-temporal-variability-in-carbon-dioxide-concentrations">🌍 Use case: Using satellite observations for quantifying spatial and temporal variability in carbon dioxide concentrations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-temporal-and-spatial-coverage-land-mask-and-spatial-regions-for-the-analysis">Define temporal and spatial coverage, land mask, and spatial regions for the analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cache-needed-functions">Cache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data">2. Retrieve data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#obs4mips">2.1 Obs4MIPs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zhang-et-al-2023-dataset">2.2 Zhang et al. (2023) dataset</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis-for-the-different-variables">3. Data analysis for the different variables</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xco-2-anomalies">Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> anomalies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xco-2-uncertainties">Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> uncertainties</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-maps-of-xco-2">Regional maps of XCO<span class="math notranslate nohighlight">\(_2\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-analysis-for-the-different-variables">Time series analysis for the different variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>